---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by zzl.
--- DateTime: 
---
local WorldTrendDataInfo = BaseClass("WorldTrendDataInfo")

function WorldTrendDataInfo:__init()
    self.id = ""
    self.finishTime = 0         --达成时间
    self.taskNeedNum = 0        --任务目标
    self.startTime = 0          --开始时间
    self.endTime = 0            --结束时间
    self.taskNum= 0             --当前进度
    self.rewardStatus = 0       --条目奖励状态
    self.status = 0             --条目状态
    self.rewardList = {}        --奖励的道具
    self.functionIds = {}       --解锁功能ID
    self.type = 0
    self.levelLimit = 0        --领取该任务奖励奖励大本等级限制
    
    self.show_type = ""
end

function WorldTrendDataInfo:__delete()
    self.id= nil
    self.finishTime = nil
    self.taskNeedNum = nil
    self.startTime = nil
    self.endTime = nil
    self.taskNum= nil
    self.rewardStatus = nil
    self.status = nil
    self.rewardList = nil
    self.functionIds = {}
    self.type = nil
    self.levelLimit = nil
    self.groupType = ""
end

function WorldTrendDataInfo:UpdateDataInfo(message)
    if message==nil then
        return
    end

    if message["id"]~=nil then
        self.id = message["id"]
    end
    if message["finishTime"]~=nil then
        self.finishTime = message["finishTime"]
    end
    if message["taskNeedNum"]~=nil then
        self.taskNeedNum = message["taskNeedNum"]
    end
    if message["startTime"] then
        self.startTime = message["startTime"]
    end
    if message["endTime"]~=nil then
        self.endTime = message["endTime"]
    end
    if message["taskNum"]~=nil then
        self.taskNum = message["taskNum"]
    end

    if message["rewardStatus"]~=nil then
        self.rewardStatus = message["rewardStatus"]
    end

    if message["status"]~=nil then
        self.status = message["status"]
    end

    if message["functionIds"] ~= nil then
        if next(message["functionIds"]) then
            self.functionIds = message["functionIds"]
        end
    end

    if message["type"] then
        self.type = message["type"]
    end

    if message["levelLimit"] then
        self.levelLimit = tonumber(message["levelLimit"])
    end
    
    --解析奖励
    local sortTab = DataCenter.RewardManager:ReturnRewardParamForMessage(message["reward"])
    if sortTab then
        for i = 1, #sortTab do
            if sortTab[i].rewardType == RewardType.GOODS then
                table.insert(self.rewardList,sortTab[i])
            else
                table.insert(self.rewardList,1,sortTab[i])
            end
        end
    end

    local template = DataCenter.WorldTrendTemplateManager:GetTemplateById(self.id)
    if template then
        self.show_type = template.show_type
    end
end

--领奖后更新状态
function WorldTrendDataInfo:UpdateRewardStatus()
    self.rewardStatus = DataCenter.WorldTrendManager.ServerTrendsRewardStatus.Received
end

function WorldTrendDataInfo:GetGroupInfo()
    if self.show_type ~= "" then
        local str = string.split(self.show_type,";")
        return tonumber(str[1]),tonumber(str[4])
    end
    return 0,0
end

function WorldTrendDataInfo:IsFirstGroup(index)
    if index == 1 then
        return true
    end
    return false
end


return WorldTrendDataInfo