---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Imaginaerum.
--- DateTime: 2023/2/14 19:10
---
local Localization = CS.GameEntry.Localization
local MailArmyResultBase = require "DataCenter.MailData.BattleReport.MailArmyResultBase"
local MailArmyResult_AllianceBuild = BaseClass("MailArmyResult_AllianceBuild", MailArmyResultBase)

function MailArmyResult_AllianceBuild:InitData(armyResult)
    MailArmyResultBase.InitData(self, armyResult)

    self._isDefeat = armyResult["isDefeat"]
    local armyResultByType = self:GetArmyResultByType(armyResult)
    self._cityLevel = armyResultByType["level"] or 0
    self._buildId = armyResultByType["buildId"] or 0

    local _armyResultBase = armyResultByType["base"]
    if (_armyResultBase == nil) then
        return
    end

    local armyObj = _armyResultBase["armyObj"] or {}
    self._armyObj = self:InitCombatUnitData(armyObj)

    local afterArmyObj = _armyResultBase["afterArmyObj"] or {}
    self._afterArmyObj = self:InitCombatUnitData(afterArmyObj)

    self:CheckArmyObj()

    self:InitDestroyValue(_armyResultBase)
    self:InitDamagePercentInfo(_armyResultBase)
end

function MailArmyResult_AllianceBuild:GetName()
    if self._unitType == BattleType.ALLIANCE_BUILD_GUARD then
        return Localization:GetString("121551")
    elseif self._unitType == BattleType.CITY_GUARD then
        return Localization:GetString("121552")
    elseif self._unitType == BattleType.ALLIANCE_CITY_GUARD then
        return Localization:GetString("121550")
    end
    local template = DataCenter.AllianceMineManager:GetAllianceMineTemplate(self._buildId)
    if template~=nil then
        return Localization:GetString(template.name)
    end
end
function MailArmyResult_AllianceBuild:GetPic()
    local template = DataCenter.AllianceMineManager:GetAllianceMineTemplate(self._buildId)
    if template~=nil then
        return template:GetCircleIconPath()
    end
end

function MailArmyResult_AllianceBuild:GetBuildId()
    return self._buildId
end
function MailArmyResult_AllianceBuild:GetName_ForShare()
    local param = {["type"] = "dialog"}
    if self._unitType == BattleType.ALLIANCE_BUILD_GUARD then
        param["name"] = "121551"
    elseif self._unitType == BattleType.CITY_GUARD then
        param["name"] = "121552"
    elseif self._unitType == BattleType.ALLIANCE_CITY_GUARD then
        param["name"] = "121550"
    else
        local template = DataCenter.AllianceMineManager:GetAllianceMineTemplate(self._buildId)
        if template~=nil then
            param["name"] = template.name
        end
    end
    
    return param
end

return MailArmyResult_AllianceBuild