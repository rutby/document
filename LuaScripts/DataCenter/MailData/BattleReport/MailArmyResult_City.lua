---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by mac.
--- DateTime: 7/21/21 11:04 AM
---

local MailArmyResultBase = require "DataCenter.MailData.BattleReport.MailArmyResultBase"
local MailArmyResult_City = BaseClass("MailArmyResult_City", MailArmyResultBase)
local Localization = CS.GameEntry.Localization

function MailArmyResult_City:InitData(armyResult)
    MailArmyResultBase.InitData(self, armyResult)

    self._isDefeat = armyResult["isDefeat"]
    local armyResultByType = self:GetArmyResultByType(armyResult)
    self._cityLevel = armyResultByType["level"] or 0
    
    local _armyResultBase = armyResultByType["base"]
    if (_armyResultBase == nil) then
        return
    end
    
    local armyObj = _armyResultBase["armyObj"] or {}
    self._armyObj = self:InitCombatUnitData(armyObj)

    local afterArmyObj = _armyResultBase["afterArmyObj"] or {}
    self._afterArmyObj = self:InitCombatUnitData(afterArmyObj)

    self._isDirect = armyResultByType["isDirect"] or false

    self:CheckArmyObj()
    
    self:InitDestroyValue(_armyResultBase)
    self:InitDamagePercentInfo(_armyResultBase)
end

function MailArmyResult_City:GetPic()
    return DataCenter.BuildManager:GetBuildIconPath(BuildingTypes.FUN_BUILD_MAIN,1)
end

function MailArmyResult_City:GetName()
    if self._unitType == BattleType.ALLIANCE_BUILD_GUARD then
        return Localization:GetString("121551")
    elseif self._unitType == BattleType.CITY_GUARD then
        return Localization:GetString("121552")
    elseif self._unitType == BattleType.ALLIANCE_CITY_GUARD then
        return Localization:GetString("121550")
    end
    return Localization:GetString("300665", self._cityLevel) .. " " 
            .. Localization:GetString("100618")
end

function MailArmyResult_City:GetName_ForShare()
    local param = {["type"] = "dialog"}
    if self._unitType == BattleType.ALLIANCE_BUILD_GUARD then
        param["name"] = "121551"
    elseif self._unitType == BattleType.CITY_GUARD then
        param["name"] = "121552"
    elseif self._unitType == BattleType.ALLIANCE_CITY_GUARD then
        param["name"] = "121550"
    else
        param["level"] = self._cityLevel
        param["name"] = "100618"
    end
   
    return param
end

function MailArmyResult_City:IsDirect()
    return self._isDirect
end

return MailArmyResult_City