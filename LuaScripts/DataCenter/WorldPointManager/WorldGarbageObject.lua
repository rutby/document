---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Imaginaerum.
--- DateTime: 19/3/2024 上午11:25
---
local base = WorldDetectEventItemObject
local WorldGarbageObject = BaseClass("WorldGarbageObject",WorldDetectEventItemObject)

function WorldGarbageObject:NeedShowDetectEventIcon()
    return true
end
function WorldGarbageObject:GetPointUid()
    local info = DataCenter.WorldPointManager:GetPointInfo(self.pointIndex)
    if info~=nil and info.garbagePointInfo~=nil then
        return info.garbagePointInfo.uuid
    end
    return 0
end
function WorldGarbageObject:GetEventId()
    local info = DataCenter.WorldPointManager:GetPointInfo(self.pointIndex)
    if info~=nil and info.garbagePointInfo~=nil then
        return info.garbagePointInfo.eventId
    end
    return 0
end
function WorldGarbageObject:GetModelPath()
    local str =GetTableData(TableName.DetectEvent,toInt(self.eventId),"image")
    return "Assets/Main/Prefabs/Garbage/"..str..".prefab"
end

function WorldGarbageObject:NeedShowTime()
    local info = DataCenter.WorldPointManager:GetPointInfo(self.pointIndex)
    if info~=nil and info.garbagePointInfo~=nil then
        local showProgress = false
        self.pickupStartTime = 0
        self.pickupEndTime = 0
        local selfMarch = DataCenter.WorldMarchDataManager:GetOwnerMarches(LuaEntry.Player.uid, LuaEntry.Player.allianceId)
        local count = #selfMarch
        if count > 0 then
            for i = 1, count do
                local march = selfMarch[i]
                if march~=nil and march.targetUuid == info.garbagePointInfo.uuid and (march:GetMarchStatus() == MarchStatus.PICKING or march:GetMarchStatus() == MarchStatus.SAMPLING) then
                    showProgress = true
                    self.pickupStartTime = march.startTime
                    self.pickupEndTime = march.endTime
                    break
                end
            end
        end
        if showProgress ==false then
            local fakeData =  DataCenter.WorldMarchDataManager:GetAllSampleFakeData()
            local fCount = #fakeData
            if fCount >0 then
                for i = 1, fCount do
                    local march = fakeData[i]
                    if march~=nil and march.targetUuid == info.garbagePointInfo.uuid and march:GetMarchStatus() == MarchStatus.SAMPLING then
                        showProgress = true
                        self.pickupStartTime = march.startTime
                        self.pickupEndTime = march.endTime
                        break
                    end
                end
            end
        end
        return showProgress
    end
    return false
end
return WorldGarbageObject