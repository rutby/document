---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by guqu.
--- DateTime: 2020/11/5 14:32
---
local StrongestCommanderDataManager = BaseClass("StrongestCommanderDataManager");
local function __init(self)
    self.selfCurRank =0
    self.activityId =""
    self.eventType = ActivityEventType.NULL
    self.eventInfo = nil
    self.eventRewardInfo =nil
    self.selfTotalRank =0
    self.selfTotalScore =0
    self.todayPersonalRank = {}
    self.totalPersonalRank = {}
end
local function __delete(self)
    self.selfCurRank =0
    self.activityId =""
    self.eventType = ActivityEventType.NULL
    self.eventInfo = nil
    self.selfTotalRank =0
    self.selfTotalScore =0
    self.todayPersonalRank = nil
    self.totalPersonalRank = nil
end

local function SetActivityId(self,id)
    self.activityId = id
    self.eventType = ActivityEventType.KINGDOM_PERSONAL
end
local function ParseEventData(self,message)
    if message ==nil then
        return
    end
    if message["type"]~=nil then
        local type = message["type"]
        if type == self.eventType then
            if message["ranking"]~=nil then
                self.selfCurRank = message["ranking"]
            end
            if message["eventList"]~=nil then
                table.walk(message["eventList"],function (k,v)
                    local oneData = ActivityEventInfo.New()
                    oneData:ParseData(v)
                    if oneData.type == self.eventType then
                        self.eventInfo = oneData
                    end
                end)
            end
        end
    end
end

local function PushEventScore(self,score,eventType,actId)
    if eventType == self.eventType then
        if self.eventInfo~=nil and self.eventInfo.actId == actId then
            self.eventInfo.curScore =tonumber(score)
        end
    end
end
local function OnEventGetReward(self,message)
    if self.eventInfo~=nil then
        self.eventInfo:RefreshNewRewardFlagList(message)
    end
end
local function ParseTodayRankData(self,message)
    if message["rankList"]~=nil then
        self.todayPersonalRank ={}
        table.walk(message["rankList"],function (k,v)
            local oneData = PersonalRankData.New()
            oneData:ParseData(v)
            table.insert(self.todayPersonalRank,oneData)
        end)
    end
end
local function ParseTotalRankData(self,message)
    
    if message["selfRank"]~=nil then
        self.selfTotalRank = message["selfRank"]
    end
    if message["selfScore"]~=nil then
        self.selfTotalScore = message["selfScore"]
    end
    if message["serverRanking"]~=nil then
        self.totalPersonalRank ={}
        table.walk(message["serverRanking"],function (k,v)
            local oneData = PersonalRankData.New()
            oneData:ParseData(v)
            table.insert(self.totalPersonalRank,oneData)
        end)
    end
end
local function ParseEventRewardInfo(self,message)
    local oneData = ActivityEventRankRewardInfo.New()
    oneData:ParseData(message)
    self.eventRewardInfo = oneData
end
local function GetEventData(self)
    return self.eventInfo
end
local function GetSelfTotalRank(self)
    return self.selfTotalRank
end
local function GetSelfTotalScore(self)
    return self.selfTotalScore
end
local function GetSelfTodayRank(self)
    return self.selfCurRank
end
local function GetSelfTodayScore(self)
    local score =0
    if self.eventInfo~=nil then
        score = self.eventInfo.curScore
    end
    return score
end
local function GetTodayScoreMeth(self)
    local meth ={}
    if self.eventInfo~=nil then
        meth =self.eventInfo.getScoreMeth
    end
    return meth
end
local function GetTodayPersonalRank(self)
    return self.todayPersonalRank
end
local function GetTotalPersonalRank(self)
    return self.totalPersonalRank
end
local function GetEventRewardList(self)
    if self.eventRewardInfo~=nil then
        return self.eventRewardInfo.rankRwdMap
    end
end

local function GetEventCanRewardCount(self)
    local num =0
    if self.eventInfo~=nil then
        num = self.eventInfo:GetCanReceiveCount()
    end
    return num
end

StrongestCommanderDataManager.__init = __init
StrongestCommanderDataManager.__delete = __delete
StrongestCommanderDataManager.SetActivityId =SetActivityId
StrongestCommanderDataManager.ParseEventData =ParseEventData
StrongestCommanderDataManager.ParseTodayRankData =ParseTodayRankData
StrongestCommanderDataManager.ParseTotalRankData =ParseTotalRankData
StrongestCommanderDataManager.ParseEventRewardInfo =ParseEventRewardInfo
StrongestCommanderDataManager.GetEventData =GetEventData
StrongestCommanderDataManager.GetSelfTotalRank =GetSelfTotalRank
StrongestCommanderDataManager.GetSelfTotalScore =GetSelfTotalScore
StrongestCommanderDataManager.GetSelfTodayRank =GetSelfTodayRank
StrongestCommanderDataManager.GetSelfTodayScore =GetSelfTodayScore
StrongestCommanderDataManager.GetTodayPersonalRank =GetTodayPersonalRank
StrongestCommanderDataManager.GetTotalPersonalRank =GetTotalPersonalRank
StrongestCommanderDataManager.GetEventRewardList =GetEventRewardList
StrongestCommanderDataManager.OnEventGetReward =OnEventGetReward
StrongestCommanderDataManager.GetTodayScoreMeth =GetTodayScoreMeth
StrongestCommanderDataManager.PushEventScore = PushEventScore
StrongestCommanderDataManager.GetEventCanRewardCount = GetEventCanRewardCount
return StrongestCommanderDataManager