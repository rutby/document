---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by 1.
--- DateTime: 2023/1/31 12:05
---HeroGrowthData.lua


local HeroGrowthData = BaseClass("HeroGrowthData")

local function __init(self)
    self.taskGroupList = {}--{{id:string, point:number, confId:number}, ...}
    self.scoreRewardList = {}--{needScore:number, reward:table, rewardFlag:number, index:number}
    self.scoreMax = 0
    self.score = 0
    self.activityId = 0
end

local function __delete(self)
    self.taskGroupList = {}--{id, point}
    self.scoreRewardList = {}--{needScore, reward, rewardFlag}
    self.scoreMax = 0
    self.score = 0
    self.activityId = 0
end

local function ParseData(self, msg)
    if not msg then
        return
    end
    if msg["activityId"] then
        self.activityId = msg["activityId"]
    end
    if msg["dayActs"] then
        self.taskGroupList = {}
        for i, v in ipairs(msg["dayActs"]) do
            for m, n in ipairs(v.tasks) do
                n.confId = v.id
            end
            table.insert(self.taskGroupList, v.tasks)
        end
    end
    if msg["scoreReward"] then
        self.scoreRewardList = {}
        for i, v in ipairs(msg["scoreReward"]) do
            v.index = i
            table.insert(self.scoreRewardList, v)
        end
    end 
    if msg["activityId"] then
        self.activityId = msg["activityId"]
    end
    if msg["score"] then
        self.score = msg["score"]
    end
    if msg["scoreMax"] then
        self.scoreMax = msg["scoreMax"]
    end
end

local function UpdateGrowthScore(self, nowScore, add)
    self.score = nowScore
end

local function UpdateBoxRewardStatus(self, index, status)
    for i, v in ipairs(self.scoreRewardList) do
        if v.index == index then
            v.rewardFlag = status
            break
        end
    end
end

local function GetMaxScore(self)
    return self.scoreRewardList[#self.scoreRewardList].needScore
end

HeroGrowthData.__init = __init
HeroGrowthData.__delete = __delete
HeroGrowthData.ParseData = ParseData

HeroGrowthData.UpdateGrowthScore = UpdateGrowthScore
HeroGrowthData.UpdateBoxRewardStatus = UpdateBoxRewardStatus
HeroGrowthData.GetMaxScore = GetMaxScore

return HeroGrowthData