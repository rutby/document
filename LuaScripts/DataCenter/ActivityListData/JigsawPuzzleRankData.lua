---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by 1.
--- DateTime: 2022/8/16 15:35
---

local JigsawPuzzleData = BaseClass("JigsawPuzzleData")

local JigsawRankPerData = {
    uid = "",
    rank = 0,
    score = 0,
    name = "",
    pic = "",
    picVer = 0,
    monthCardEndTime = 0,
    
    abbr = "",
    allianceName = "",
}

local JigsawRankRewardData = {
    rankStart = 0,
    rankEnd = 0,
    rewards = {},
}

local function __init(self)
    self.activityId = ""
    self.id = 0
    self.rankList = {}
    self.rankRewardList = {}
    self.selfRank = 0
    self.selfScore = 0
end

local function __delete(self)
    self.activityId = nil
    self.id = nil
    self.rankList = nil
    self.rankRewardList = nil
    self.selfRank = nil
    self.selfScore = nil
end

local function ParseData(self, message)
    if message==nil then
        return
    end
    if message["activityId"] then
        self.activityId = message["activityId"]
    end
    if message["id"] then
        self.id = message["id"]
    end
    if message["rankList"] then
        self.rankList = {}
        for i, v in ipairs(message["rankList"]) do
            local newRankData = {}
            newRankData.uid = v.uid
            newRankData.rank = v.rank
            newRankData.score = v.score
            newRankData.name = v.name
            newRankData.pic = v.pic
            newRankData.picVer = v.picVer
            newRankData.monthCardEndTime = v.monthCardEndTime
            newRankData.abbr = v.abbr
            newRankData.allianceName = v.alliancename
            newRankData.headSkinId = v.headSkinId
            newRankData.headSkinET = v.headSkinET

            newRankData.GetHeadBgImg = function(self)
                --local headBgImg = nil
                --
                local serverTimeS = UITimeManager:GetInstance():GetServerSeconds()
                --if self.monthCardEndTime and self.monthCardEndTime > serverTimeS then
                --    headBgImg = "Common_playerbg_golloes"
                --end
                --
                --if headBgImg and headBgImg ~= "" then
                --    return string.format(LoadPath.CommonNewPath,headBgImg)
                --end
                local headBgImg = DataCenter.DecorationDataManager:GetHeadFrame(self.headSkinId, self.headSkinET, self.monthCardEndTime and self.monthCardEndTime > serverTimeS)
                return headBgImg
            end
            table.insert(self.rankList, newRankData)
        end
    end
    if message["rankRewardArr"] then
        self.rankRewardList = {}
        for i, v in ipairs(message["rankRewardArr"]) do
            local newReward = {}
            newReward.rankStart = v.start
            newReward.rankEnd = v['end']
            newReward.rewards = {}
            for m, n in ipairs(v.reward) do
                table.insert(newReward.rewards, n)
            end
            table.insert(self.rankRewardList, newReward)
        end
    end
    if message["selfRank"] then
        self.selfRank = message["selfRank"]
    end
    if message["selfScore"] then
        self.selfScore = message["selfScore"]
    end
end

JigsawPuzzleData.__init = __init
JigsawPuzzleData.__delete = __delete
JigsawPuzzleData.ParseData = ParseData
JigsawPuzzleData.GetHeadBgImg = GetHeadBgImg
return JigsawPuzzleData