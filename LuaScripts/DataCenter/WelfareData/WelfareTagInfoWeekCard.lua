---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by darcy.
--- DateTime: 2021/1/18 2:51 下午
---

require "DataCenter.WelfareData.WelfareTagInfo"

---@class WelfareTagInfoWeekCard : WelfareTagInfo 月卡页签信息
local WelfareTagInfoWeekCard = BaseClass("WelfareTagInfoWeekCard", WelfareTagInfo)
local M = WelfareTagInfoWeekCard


function M:ctor()
    WelfareTagInfo.ctor(self)
    self.packIdList = {}
end

function M:parse(data)
    WelfareTagInfo.parse(self, data)
    local _para1 = data:getValue("para1")
    if _para1 ~= nil and _para1 ~= "" then
        self.packIdList = string.split(_para1, ';')
    end
end

function M:isShow()
    local list = self:getPackList(false)
    return list ~= nil and #list > 0 and WelfareTagInfo.isShow(self)
end

---当免费礼包未领取时，页签上显示小红点
function M:hasRedPoint()
    local packs = self:getPackList(true)
    for _, v in ipairs(packs) do
        if v:isFree() and v:canGet() then
            return true
        end
    end
    return false
end

function M:getPackList(isSort)
    if #self.packIdList <= 0 then
        return {}
    end

    local list = GiftPackageData.getPacks(self.packIdList, isSort)
    for _, v in ipairs(list) do
        v:setTagID(self:getID())
    end
    return list
end

function M:isShowIcon()
    return self:isShow() and WelfareTagInfo.isShowIcon(self)
end

return M