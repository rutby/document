---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by mac.
--- DateTime: 9/24/21 11:36 AM
---

--[[
打怪
跳转到附近的怪物
]]

local ResLackItemBase = require "DataCenter.ResLackTips.ResLackItemBase"
local ResLackItem_AttackMonster = BaseClass("ResLackItem_AttackMonster", ResLackItemBase)

function ResLackItem_AttackMonster:CheckIsOk( _resType, _needCnt )
    if  CS.SceneManager.IsInPVE() then
        return false
    end
    local list_427000 = DataCenter.BuildManager:GetAllBuildingByItemIdWithoutPickUp(BuildingTypes["FUN_BUILD_TRAINFIELD_1"])
    local list_793000 = DataCenter.BuildManager:GetAllBuildingByItemIdWithoutPickUp(BuildingTypes["FUN_BUILD_TRAINFIELD_2"])
    local list_794000 = DataCenter.BuildManager:GetAllBuildingByItemIdWithoutPickUp(BuildingTypes["FUN_BUILD_TRAINFIELD_3"])
    local list_795000 = DataCenter.BuildManager:GetAllBuildingByItemIdWithoutPickUp(BuildingTypes["FUN_BUILD_TRAINFIELD_4"])
    local existTroopBuilding = false
    if (table.count(list_427000) > 0 or
            table.count(list_793000) > 0 or
            table.count(list_794000) > 0 or
            table.count(list_795000) > 0) then
        existTroopBuilding = true
    end
    --local curMaxLv = DataCenter.MonsterManager:GetCurCanAttackMaxLevel()
    local para1 = self._config:getValue("para1")
    --if (curMaxLv >= para1 and existTroopBuilding) then
    --    return true
    --end
    if not string.IsNullOrEmpty(para1) then
        if para1 == "first" and existTroopBuilding then
            if LuaEntry.Player.pveLevel + 1 <= DataCenter.MonsterManager:GetCurCanAttackMaxLevel() then
                return true
            end
        end
    elseif existTroopBuilding then
        return true
    end
    
    return false
end

function ResLackItem_AttackMonster:TodoAction()
    GoToUtil.CloseAllWindows()
    local targetLv = nil
    local para1 = self._config:getValue("para1")
    if not string.IsNullOrEmpty(para1) then
        if para1 == "first" then
            targetLv = DataCenter.MonsterManager:GetCurCanAttackMaxLevel()
        end
    end
    SceneUtils.ChangeToWorld(function()
        GoToUtil.GotoOpenView(UIWindowNames.UISearch,UISearchType.Monster,targetLv)
    end)
end

return ResLackItem_AttackMonster
