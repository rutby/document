---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by guqu.
--- DateTime: 2020/11/16 21:09
---
local AllianceDonateRankDataManager = BaseClass("AllianceDonateRankDataManager");

local function __init(self)
    self.rankDayList ={}
    self.rankWeekList = {}
    self.rankHistoryList ={}
    self.dayRefreshTime =0
    self.weekRefreshTime =0
end

local function __delete(self)
    self.rankDayList =nil
    self.rankWeekList = nil
    self.rankHistoryList =nil
    self.dayRefreshTime = nil
    self.weekRefreshTime = nil
end

local function UpdateRankDayList(self,message)
    self.rankDayList ={}
    self.dayRefreshTime = 0
    if message["donateRank"]~=nil then
        local rank = 0
        table.walk(message["donateRank"],function (k,v)
            local info = AllianceDonateRankData.New()
            info:ParseData(v)
            rank =rank+1 
            info:SetRank(rank)
            table.insert(self.rankDayList,info)
        end)
    end
    if message["refreshTime"]~=nil then
        self.dayRefreshTime = message["refreshTime"]
    end
end

local function UpdateRankWeekList(self,message)
    self.rankWeekList = {}
    self.weekRefreshTime = 0
	
    if message["donateRank"]~=nil then
        local rank = 0
        table.walk(message["donateRank"],function (k,v)
            local info = AllianceDonateRankData.New()
            info:ParseData(v)
            rank =rank+1
            info:SetRank(rank)
            table.insert(self.rankWeekList,info)
        end)
    end
    if message["refreshTime"]~=nil then
        self.weekRefreshTime = message["refreshTime"]
    end
end

local function UpdateRankHistoryList(self,message)
    self.rankHistoryList ={}
    if message["donateRank"]~=nil then
        local rank = 0
        table.walk(message["donateRank"],function (k,v)
            local info = AllianceDonateRankData.New()
            info:ParseData(v)
            rank =rank+1
            info:SetRank(rank)
            table.insert(self.rankHistoryList,info)
        end)
    end
end

local function GetSelfRankDataByType(self,type)
    local oneData = nil
    local uid = LuaEntry.Player.uid
	
    if type== AllianceDonateRankType.RankDay then
        table.walk(self.rankDayList,function (k,v)
            if v.uid ==uid then
                oneData = v
            end
        end) 
    elseif type== AllianceDonateRankType.RankWeek then
        table.walk(self.rankWeekList,function (k,v)
            if v.uid ==uid then
                oneData = v
            end
        end)
    elseif type== AllianceDonateRankType.RankHistory then
        table.walk(self.rankHistoryList,function (k,v)
            if v.uid ==uid then
                oneData = v
            end
        end)
    end
    return oneData
end

local function GetAllianceRankListByType(self,type)
    local showList ={}
    if type== AllianceDonateRankType.RankDay then
        showList = self.rankDayList
    elseif type== AllianceDonateRankType.RankWeek then
        showList = self.rankWeekList
    elseif type== AllianceDonateRankType.RankHistory then
        showList = self.rankHistoryList
    end
    return showList
end

local function GetAllianceRefreshTimeByType(self,type)
    local refreshTime =0
    if type== AllianceDonateRankType.RankDay then
        refreshTime = self.dayRefreshTime
    elseif type== AllianceDonateRankType.RankWeek then
        refreshTime = self.weekRefreshTime
        
    end
    return refreshTime
end

AllianceDonateRankDataManager.__init = __init
AllianceDonateRankDataManager.__delete = __delete
AllianceDonateRankDataManager.UpdateRankDayList =UpdateRankDayList
AllianceDonateRankDataManager.UpdateRankWeekList =UpdateRankWeekList
AllianceDonateRankDataManager.UpdateRankHistoryList =UpdateRankHistoryList
AllianceDonateRankDataManager.GetSelfRankDataByType =GetSelfRankDataByType
AllianceDonateRankDataManager.GetAllianceRankListByType =GetAllianceRankListByType
AllianceDonateRankDataManager.GetAllianceRefreshTimeByType =GetAllianceRefreshTimeByType
return AllianceDonateRankDataManager