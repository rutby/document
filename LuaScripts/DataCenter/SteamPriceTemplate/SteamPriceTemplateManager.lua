---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Imaginaerum.
--- DateTime: 2023/9/13 18:22
---
local SteamPriceTemplateManager = BaseClass("SteamPriceTemplateManager");

local function __init(self)
    self.templateDict = {}
end

local function __delete(self)
    self.templateDict = nil
end

local function Startup(self)

end

local function InitTemplateDict(self)
    self.templateDict = {}
    LocalController:instance():visitTable(TableName.SteamPrice, function(id, lineData)
        local tId = lineData:getValue("id") or 0
        local USMoney = lineData:getValue("USD") or 0
        if USMoney>0 and id>0 then
            self.templateDict[USMoney] = tId
        end
    end)
end

local function GetPriceText(self,price,currency,symbol)
    if self.templateDict[price]~=nil then
        if currency == "USD" then
            local showPrice = string.format("%.2f",price/100)
            local str = symbol..showPrice
            return str
        elseif currency~=nil and currency~="" then
            local id = self.templateDict[price]
            local num = GetTableData(TableName.SteamPrice,id, currency)
            if num~=nil and num>0 then
                local showPrice = string.format("%.2f",num/100)
                local str = symbol..showPrice
                return str
            end
            
        end
    end
    return ""
end


SteamPriceTemplateManager.__init = __init
SteamPriceTemplateManager.__delete = __delete
SteamPriceTemplateManager.Startup = Startup
SteamPriceTemplateManager.InitTemplateDict = InitTemplateDict
SteamPriceTemplateManager.GetPriceText = GetPriceText

return SteamPriceTemplateManager