---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by 1022.
--- DateTime: 2023/1/4 14:34
---PVE英雄数据
local base = require "DataCenter.Survival.Character.CharacterBaseInfo"
local PveHeroInfo = BaseClass("PvePlayerInfo", base)

function PveHeroInfo:__init(uuid)
    base.__init(self)
    self.m_uuid = uuid
    
    self:__initData()
end

function PveHeroInfo:__initData()
    local info =  DataCenter.HeroDataManager:GetHeroByUuid(self.m_uuid)
    self.m_heroId = info.heroId
    self.m_level = info.level --以后会根据等级计算攻击力等数据
    self.m_quality = info.quality
    self.m_rankId = info.curMilitaryRankId
    self.m_name = info:GetName()
    self:SetTemplate(DataCenter.PveHeroTemplateManager:GetTemplate(self.m_heroId))
    
    local levelAtk,levelDef,levelHp = self:__initLevelData()
    local qualityAddAttack,qualityAddDefence,qualityAddHp = self:__initQualityData()
    local rankAddAttack,rankAddDefence,rankAddHp = self:__initRankData()
    
    self.m_attackNum = self.m_template.attack + levelAtk + qualityAddAttack + rankAddAttack
    self.m_defenceNum = self.m_template.defence + levelDef + qualityAddDefence + rankAddDefence
    local hp = self.m_template.health + levelHp + qualityAddHp + rankAddHp
    
    self:SetMaxBlood(hp)
    self:SetCurBlood(hp)
end

function PveHeroInfo:__initLevelData()
    local levelAtk = 0
    local levelDef = 0
    local levelHp = 0
    local levelData = DataCenter.PveHeroTemplateManager:GetLevelUpTemplate(self.m_level)
    if levelData ~= nil then
        if self.m_quality == 1 then
            levelAtk = levelData.legend_atk
            levelDef = levelData.legend_def
            levelHp = levelData.legend_hp
        elseif self.m_quality == 2 then
            levelAtk = levelData.epic_atk
            levelDef = levelData.epic_def
            levelHp = levelData.epic_hp
        elseif self.m_quality == 3 then
            levelAtk = levelData.rare_atk
            levelDef = levelData.rare_def
            levelHp = levelData.rare_hp
        elseif self.m_quality == 4 then
            levelAtk = levelData.normal_atk
            levelDef = levelData.normal_def
            levelHp = levelData.normal_hp
        end
    end
    return levelAtk,levelDef,levelHp
end

function PveHeroInfo:__initQualityData()
    local quality_atk = self.m_template.quality_atk
    local quality_def = self.m_template.quality_def
    local quality_hp = self.m_template.quality_hp
    
    local qualityAddAttack = #quality_atk > 0 and quality_atk[math.min(#quality_atk,self.m_quality)] or 0
    local qualityAddDefence = #quality_def > 0 and quality_def[math.min(#quality_def,self.m_quality)] or 0
    local qualityAddHp = #quality_hp > 0 and quality_hp[math.min(#quality_hp,self.m_quality)] or 0
    
    return qualityAddAttack,qualityAddDefence,qualityAddHp
end

function PveHeroInfo:__initRankData()
    local rankData = DataCenter.PveHeroTemplateManager:GetRankTemplate(self.m_rankId)
    local rankAddAttack = 0
    local rankAddDefence = 0
    local rankAddHp = 0
    if rankData ~= nil then
        rankAddAttack = #rankData.rank_atk > 0 and rankData.rank_atk[math.min(#rankData.rank_atk,self.m_quality)] or 0
        rankAddDefence = #rankData.rank_def > 0 and rankData.rank_def[math.min(#rankData.rank_def,self.m_quality)] or 0
        rankAddHp = #rankData.rank_hp > 0 and rankData.rank_hp[math.min(#rankData.rank_hp,self.m_quality)] or 0
    end
    
    return rankAddAttack,rankAddDefence,rankAddHp
end

function PveHeroInfo:GetName()
    return self.m_name
end

function PveHeroInfo:GetUuid()
    return self.m_uuid
end

function PveHeroInfo:GetHeroId()
    return self.m_heroId
end

function PveHeroInfo:GetLevel()
    return self.m_level
end

function PveHeroInfo:GetModel()
    return self.m_template.model
end

function PveHeroInfo:GetAttack()
    return self.m_attackNum
end

function PveHeroInfo:GetDefence()
    return self.m_defenceNum
end

function PveHeroInfo:GetSkill()
    return self.m_template.skill
end

function PveHeroInfo:GetPartId()
    return self.m_template.part
end

function PveHeroInfo:GetAnimation()
    return self.m_template.animation
end

function PveHeroInfo:GetSkillOrder()
    return self.m_template.skillOrder
end

function PveHeroInfo:GetHpStage()
    return self.m_template.hpStage
end

function PveHeroInfo:GetAtkType()
    return self.m_template.atk_type
end

return PveHeroInfo