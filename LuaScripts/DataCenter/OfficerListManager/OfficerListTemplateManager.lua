---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by 1.
--- DateTime: 2023/4/24 11:51
---

local OfficerListTemplateManager = BaseClass("OfficerListTemplateManager")
local OfficerListTemplate = require "DataCenter.OfficerListManager.OfficerListTemplate"

local function __init(self)
    self.allTemplates = {}
    self.templateGroup = {}
    self:InitAllTemplate()
end

local function __delete(self)
    self.allTemplates = {}
    self.templateGroup = {}
end

local function GetTemplate(self, id)
    return self.allTemplates[tonumber(id)]
end

local function GetGroup(self, id)
    return self.templateGroup[id]
end

local function GetValidTemplateInGroup(self, id)
    local result = {}
    local group = self:GetGroup(id)
    if group then
        for _, v in ipairs(group) do
            local template = self:GetTemplate(v)
            if template and template:IsValid() then
                table.insert(result, v)
            end
        end
    end
    return result
end

local function InitAllTemplate(self)
    LocalController:instance():visitTable(TableName.OfficerList, function(_, lineData)
        local id = tonumber(lineData.id)
        local group = tonumber(lineData.group_id)
        local item = OfficerListTemplate.New()
        item:InitData(lineData)
        self.allTemplates[id] = item
        if self.templateGroup[group] == nil then
            self.templateGroup[group] = {}
        end
        table.insert(self.templateGroup[group], id)
    end)
end


OfficerListTemplateManager.__init = __init
OfficerListTemplateManager.__delete = __delete
OfficerListTemplateManager.GetTemplate = GetTemplate
OfficerListTemplateManager.InitAllTemplate = InitAllTemplate
OfficerListTemplateManager.GetGroup = GetGroup
OfficerListTemplateManager.GetValidTemplateInGroup = GetValidTemplateInGroup

return OfficerListTemplateManager