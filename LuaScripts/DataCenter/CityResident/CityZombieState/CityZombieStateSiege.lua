---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Beef.
--- DateTime: 2024/4/3 17:51
---

local CityZombieStateBase = require "DataCenter.CityResident.CityZombieState.CityZombieStateBase"
local CityZombieStateSiege = BaseClass("CityZombieStateSiege", CityZombieStateBase)

local function OnEnter(self)
    if not DataCenter.CityResidentManager:IsZombieInvade() then
        self.data:Refresh()
        return
    end
    local arg = nil
    if self.data.spawnId then
        arg = "spawnId=" .. self.data.spawnId
    end
    local mask = DataCenter.CityResidentManager:GetCurrentCityMask()
    local pos = WayPointUtil.GetRandomPos(mask, CityResidentDefines.WayPointFlag.Zombie, arg)
    self.data:PlayAnim(CityResidentDefines.AnimName.Walk1)
    self.data:SetSpeed(DataCenter.CityResidentManager:GetZombieWalkSpeed())
    self.data:GoToPosDirectly(pos)
end

local function OnFinish(self)
    self.data:SetState(CityResidentDefines.ZombieState.Invade)
end

CityZombieStateSiege.OnEnter = OnEnter
CityZombieStateSiege.OnFinish = OnFinish

return CityZombieStateSiege