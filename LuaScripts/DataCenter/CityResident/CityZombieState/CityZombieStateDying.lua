---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Beef.
--- DateTime: 2023/11/23 10:52
---

local CityZombieStateBase = require "DataCenter.CityResident.CityZombieState.CityZombieStateBase"
local CityZombieStateDying = BaseClass("CityZombieStateDying", CityZombieStateBase)

local function OnEnter(self)
    self.data:Idle()
    self.data:PlayAnim(CityResidentDefines.AnimName.Dead1)
    self.data:WaitForFinish(2)

    -- 小人说话
    for _, data in pairs(DataCenter.CityResidentManager.dataDict) do
        if data.type == CityResidentDefines.Type.Resident then
            local param = {}
            param.type = CityResidentDefines.TalkTriggerType.ZombieDie
            param.rUuid = data.uuid
            DataCenter.CityResidentManager:TryResidentTalk(param)
            break
        end
    end
end

local function OnFinish(self)
    self.data:SetState(CityResidentDefines.ZombieState.Dead)
end

CityZombieStateDying.OnEnter = OnEnter
CityZombieStateDying.OnFinish = OnFinish

return CityZombieStateDying