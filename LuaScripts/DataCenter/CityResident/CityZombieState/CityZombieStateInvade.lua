---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Beef.
--- DateTime: 2024/3/29 18:57
---

local CityZombieStateBase = require "DataCenter.CityResident.CityZombieState.CityZombieStateBase"
local CityZombieStateInvade = BaseClass("CityZombieStateInvade", CityZombieStateBase)

local function OnEnter(self)
    self.data:PlayAnim(CityResidentDefines.AnimName.Walk1)
    self.data:SetSpeed(DataCenter.CityResidentManager:GetZombieWalkSpeed())
    
    local arg = nil
    if self.data.spawnId then
        arg = "spawnId=" .. self.data.spawnId
    end
    local attackWayPoint = DataCenter.CityResidentManager:GetRandomInvadeWayPoint(arg)
    if attackWayPoint then
        local mask = DataCenter.CityResidentManager:GetCurrentCityMask()
        self.data.attackWallId = tonumber(WayPointUtil.GetWayPointArg(attackWayPoint, "wallId"))
        --self.data:GoToPos(attackWayPoint.pos, mask, CityResidentDefines.WayPointFlag.All, "isOutside=1")
        self.data:GoToPosDirectly(attackWayPoint.pos)
        return
    end
    
    self.data:SetState(CityResidentDefines.ZombieState.WanderWalk)
end

local function OnFinish(self)
    self.data:SetState(CityResidentDefines.ZombieState.AttackWall)
end

CityZombieStateInvade.OnEnter = OnEnter
CityZombieStateInvade.OnFinish = OnFinish

return CityZombieStateInvade