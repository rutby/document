---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Beef.
--- DateTime: 2024/4/2 10:44
---

local CitySpecialStateBase = require "DataCenter.CityResident.CitySpecialState.CitySpecialStateBase"
local CitySpecialStateSiegeBossRetreat = BaseClass("CitySpecialStateSiegeBossRetreat", CitySpecialStateBase)

local function OnEnter(self)
    self.data:PlayAnim("walk")
    self.data:SetSpeed(1)

    local line = LocalController:instance():getLine(TableName.CitySiegeZombie, self.data.zombieId)
    local posSpls = string.split(line.spawn_pos, ";")
    local pos = Vector3.New(tonumber(posSpls[1]), tonumber(posSpls[2]), tonumber(posSpls[3]))
    local mask = DataCenter.CityResidentManager:GetCurrentCityMask()
    self.data:GoToPos(pos, mask, CityResidentDefines.WayPointFlag.City | CityResidentDefines.WayPointFlag.Zombie)
end

local function OnFinish(self)
    self.data:SetState(CityResidentDefines.SpecialState.SiegeBossIdle)
end

CitySpecialStateSiegeBossRetreat.OnEnter = OnEnter
CitySpecialStateSiegeBossRetreat.OnFinish = OnFinish

return CitySpecialStateSiegeBossRetreat