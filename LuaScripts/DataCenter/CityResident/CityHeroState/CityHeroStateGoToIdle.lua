---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Beef.
--- DateTime: 2023/11/23 10:52
---

local CityHeroStateBase = require "DataCenter.CityResident.CityHeroState.CityHeroStateBase"
local CityHeroStateGoToIdle = BaseClass("CityHeroStateGoToIdle", CityHeroStateBase)

local function OnEnter(self)
    local pos = Vector3.New(101, 0, 101)
    local zombieData = DataCenter.CityResidentManager:GetCanBeAttackZombie(pos, DataCenter.CityResidentManager:GetHeroSearchZombieRange())
    local mask = DataCenter.CityResidentManager:GetCurrentCityMask()
    pos = zombieData and zombieData:GetPos() or WayPointUtil.GetRandomPos(mask, CityResidentDefines.WayPointFlag.Center)
    self.data:PlayAnim(CityResidentDefines.AnimName.Run)
    self.data:SetSpeed(CityResidentDefines.SpeedHeroRun)
    self.data:ShowHeroWeapon()
    self.data:GoToCityPos(pos)
end

local function OnFinish(self)
    self.data:SetState(CityResidentDefines.HeroState.Idle)
end

CityHeroStateGoToIdle.OnEnter = OnEnter
CityHeroStateGoToIdle.OnFinish = OnFinish

return CityHeroStateGoToIdle