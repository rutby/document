---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by 1.
--- DateTime: 2022/11/15 15:27
---

local HeroLackTipsItemBase = require "DataCenter.HeroLackTipManager.HeroLackTipsItemBase"
local HeroLackTipsItemPromotionGiftBag = BaseClass("HeroLackTipsItemPromotionGiftBag", HeroLackTipsItemBase)

local function CheckIsOk(self)
    local activePackage = self:GetActivePackageInfo()
    return activePackage ~= nil
end

local function TodoAction(self)
    local activePackage = self:GetActivePackageInfo()
    --GoToUtil.GotoGiftPackView(activePackage)
    if activePackage then
        local packId = activePackage:getID()
        local targetPack = GiftPackManager.get(packId)
        if targetPack then
            local rechargeLine = targetPack:getRechargeLineData()
            if rechargeLine then
                UIManager.Instance:DestroyWindow(UIWindowNames.UIHeroList)
                UIManager.Instance:DestroyWindow(UIWindowNames.UIHeroInfo)
                UIManager.Instance:DestroyWindow(UIWindowNames.UIHeroAdvanceSuccess)

                UIManager:GetInstance():OpenWindow(UIWindowNames.UIGiftPackage, {anim = true},
                        {
                            targetPackageId = packId, welfareTagType = rechargeLine.type
                        })
            end
        end
    end
end

local function GetActivePackageInfo(self)
    local template = DataCenter.HeroLackTipTemplateManager:GetTemplate(self.configId)
    local allIds = string.split(template.para1, ";")
    for _, v in ipairs(allIds) do
        local packageInfo = GiftPackageData.get(v)
        if packageInfo ~= nil then
            return packageInfo
        end
    end
    return nil
end

HeroLackTipsItemPromotionGiftBag.CheckIsOk = CheckIsOk
HeroLackTipsItemPromotionGiftBag.TodoAction = TodoAction
HeroLackTipsItemPromotionGiftBag.GetActivePackageInfo = GetActivePackageInfo

return HeroLackTipsItemPromotionGiftBag