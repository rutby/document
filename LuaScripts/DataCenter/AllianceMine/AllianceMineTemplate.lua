---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by 1.
--- DateTime: 2022/12/9 9:32
---AllianceMineTemplate.lua


local AllianceMineTemplate = BaseClass("AllianceMineTemplate")
local Localization = CS.GameEntry.Localization

local function __init(self)
    self.id = 0
    self.resSize = 0
    self.level = 0
    self.resDurable = 0
    self.res_base_durable = 0 --速度
    self.resNum = 0
    self.buildCost = 0
    self.collectType = 0
    self.param = 0
    self.collectSpeed = 0
    self.armyLimit = 0
    self.expireTime = 0
    self.limitMember = 0
    self.limitRuin = 0
    self.limitPower = 0
    self.icon = ""
    self.icon_small = ""
    self.model = ""
    self.desc = ""
    self.name = ""
    self.pre_build = 0
    self.offter_range = 0
    self.collectTypeK = ""
    self.conditions = {}
    self.place_ruin_dic = {}
    self.army_recover_time = 0
end

local function __delete(self)
    self.id = nil
    self.resSize = nil
    self.level = nil
    self.resDurable = nil
    self.resNum = nil
    self.buildCost = nil
    self.collectType = nil
    self.param = nil
    self.collectSpeed = nil
    self.armyLimit = nil
    self.expireTime = nil
    self.limitMember = nil
    self.limitRuin = nil
    self.limitPower = nil
    self.icon = nil
    self.model = nil
    self.desc = nil
    self.name = nil
    
    self.collectTypeK = nil
    self.conditions = nil
    self.army_recover_time = 0
end

local function InitData(self,row)
    if row == nil then
        return
    end

    self.id = tonumber(row:getValue("id")) or 0
    self.resSize = tonumber(row:getValue("res_size")) or 0
    self.level = tonumber(row:getValue("level")) or 0
    self.resDurable = tonumber(row:getValue("res_durable")) or 0
    self.res_base_durable = tonumber(row:getValue("res_base_durable")) or 0
    self.resNum = tonumber(row:getValue("res_num")) or 0
    self.buildCost = tonumber(row:getValue("build_cost")) or 0
    self.collectType = tonumber(row:getValue("collect_type")) or 0
    self.offter_range = tonumber(row:getValue("offter_range"))or 0
    self.param = tonumber(row:getValue("param")) or 0
    self.collectTypeK = self.collectType .. ":" .. self.param
    self.collectSpeed = tonumber(row:getValue("collect_speed")) or 0
    self.armyLimit = tonumber(row:getValue("army_limit")) or 0
    self.expireTime = tonumber(row:getValue("expire_time")) or 0
    self.conditions = {}
    self.limitMember = tonumber(row:getValue("limit_member")) or 0
    self.conditions[AlMineConditionType.MemberCount] = self.limitMember
    self.limitRuin = tonumber(row:getValue("limit_ruin")) or 0
    self.conditions[AlMineConditionType.RuinLv] = self.limitRuin
    self.limitPower = tonumber(row:getValue("limit_power")) or 0
    self.conditions[AlMineConditionType.Power] = self.limitPower
    self.pre_build = tonumber(row:getValue("pre_build")) or 0
    self.army_recover_time = tonumber(row:getValue("army_recover_time")) or 0
    self.conditions[AlMineConditionType.PreBuild] = self.pre_build
    self.name = row:getValue("name")
    self.icon = row:getValue("icon")
    self.icon_small = row:getValue("icon_small")
    self.model = row:getValue("model")
    self.desc = row:getValue("desc")
    self.place_ruin_dic = {}
    local place_ruin = row:getValue("place_ruin")
    if place_ruin~=nil and place_ruin~="" then
        local arr = string.split(place_ruin,";")
        if arr~=nil and #arr>0 then
            for k,v in pairs(arr) do
                local level = tonumber(v)
                if level ~=nil then
                    self.place_ruin_dic[level] = 1
                end
                
            end
        end
    end
end

local function GetIconPath(self)
    return "Assets/Main/Sprites/UI/UIAlliance/"..self.icon
end
local function GetCircleIconPath(self)
    return "Assets/Main/Sprites/UI/UIAlliance/"..self.icon_small
end

local function GetModelPath(self)
    local modelName = string.IsNullOrEmpty(self.model) and "allianceBuilding_1000" or self.model
    local fullPath = string.format("Assets/Main/Prefabs/AllianceBuilding/%s", modelName)
    return fullPath
end


AllianceMineTemplate.__init = __init
AllianceMineTemplate.__delete = __delete
AllianceMineTemplate.InitData = InitData
AllianceMineTemplate.GetIconPath = GetIconPath
AllianceMineTemplate.GetModelPath = GetModelPath
AllianceMineTemplate.GetCircleIconPath = GetCircleIconPath
return AllianceMineTemplate