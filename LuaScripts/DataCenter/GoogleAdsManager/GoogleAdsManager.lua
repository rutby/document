---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Imaginaerum.
--- DateTime: 2023/10/19 11:36
---
local GoogleAdsManager = BaseClass("GoogleAdsManager");
local rapidjson = require "rapidjson"
local function __init(self)
    self:AddListeners()
end

local function __delete(self)
    self:RemoveListeners()
end

local function AddListeners(self)
    EventManager:GetInstance():AddListener(EventId.GoogleAdsUserEarnedReward, self.OnGAdsUserEarnedReward)
    EventManager:GetInstance():AddListener(EventId.GoogleAdsUserExitReward, self.OnGAdsUserUserExitReward)
    EventManager:GetInstance():AddListener(EventId.GoogleAdsUserCreateRewardedAdFail, self.OnGAdsUserCreateRewardedAdFail)
    EventManager:GetInstance():AddListener(EventId.GoogleAdsUserCreateRewardedAdSuccess, self.OnGAdsUserCreateRewardedAdSuccess)
    EventManager:GetInstance():AddListener(EventId.GoogleAdsUserClickAd, self.OnGAdsUserClickAd)
end

local function RemoveListeners(self)
    EventManager:GetInstance():RemoveListener(EventId.GoogleAdsUserEarnedReward, self.OnGAdsUserEarnedReward)
    EventManager:GetInstance():RemoveListener(EventId.GoogleAdsUserExitReward, self.OnGAdsUserUserExitReward)
    EventManager:GetInstance():RemoveListener(EventId.GoogleAdsUserCreateRewardedAdFail, self.OnGAdsUserCreateRewardedAdFail)
    EventManager:GetInstance():RemoveListener(EventId.GoogleAdsUserCreateRewardedAdSuccess, self.OnGAdsUserCreateRewardedAdSuccess)
    EventManager:GetInstance():RemoveListener(EventId.GoogleAdsUserClickAd, self.OnGAdsUserClickAd)
end

local function Startup(self)

end

local function OnGAdsUserEarnedReward(data)
    print("lua OnGAdsUserEarnedReward:" .. data)
    local strArr = string.split(data,",")
    if #strArr>0 then
        local str = strArr[1].."}"
        local t = rapidjson.decode(str)
        DataCenter.WatchAdManager:WatchFinish(t.templateId)
    end
end

local function OnGAdsUserUserExitReward(data)
    print("lua OnGAdsUserUserExitReward:" .. data)
end

local function OnGAdsUserCreateRewardedAdFail(data)
    print("lua OnGAdsUserCreateRewardedAdFail:" .. data)
    local strArr = string.split(data,",")
    if #strArr>0 then
        local str = strArr[1].."}"
        local t = rapidjson.decode(str)
        DataCenter.WatchAdManager:WatchFail(t.templateId)
    end
end

local function OnGAdsUserCreateRewardedAdSuccess(data)
    print("lua OnGAdsUserCreateRewardedAdSuccess:" .. data)
end

local function OnGAdsUserClickAd(data)
    print("lua OnGAdsUserClickAd:" .. data)
end


local function ShowRewarded(self,adId,templateId)
    local tbl = {}
    tbl["adId"] = adId
    tbl["templateId"] = templateId
    tbl["playerUid"] = LuaEntry.Player.uid
    local json = rapidjson.encode(tbl)
    CS.GameEntry.Sdk:SendDataToNative("GAds_adsRewardedAd", json)
end
GoogleAdsManager.__init = __init
GoogleAdsManager.__delete = __delete
GoogleAdsManager.AddListeners = AddListeners
GoogleAdsManager.RemoveListeners =RemoveListeners
GoogleAdsManager.Startup =Startup
GoogleAdsManager.OnGAdsUserEarnedReward =OnGAdsUserEarnedReward
GoogleAdsManager.OnGAdsUserUserExitReward =OnGAdsUserUserExitReward
GoogleAdsManager.OnGAdsUserCreateRewardedAdFail = OnGAdsUserCreateRewardedAdFail
GoogleAdsManager.OnGAdsUserCreateRewardedAdSuccess = OnGAdsUserCreateRewardedAdSuccess
GoogleAdsManager.OnGAdsUserClickAd =OnGAdsUserClickAd
GoogleAdsManager.ShowRewarded =ShowRewarded
return GoogleAdsManager