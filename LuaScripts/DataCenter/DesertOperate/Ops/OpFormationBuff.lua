---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Imaginaerum.
--- DateTime: 2023/4/13 19:11
---
-- 专精技能：行军buff
local OpFormationBuff = BaseClass("OpFormationBuff", OpMasterySkillBase)
local base = OpMasterySkillBase
local Localization = CS.GameEntry.Localization
local function Init(self, uuid)
    self.skill = MasterySkill.RecoverMarch--急救
    base.Init(self, uuid)
end

local function OnClick(self, view, item)
    if self.state == MasterySkillState.Normal then
        local valueDic = self.skillTemplate:getValue("values")
        local level = self.template.lv
        if valueDic~=nil and valueDic[level]~=nil then
            local buffId = toInt(valueDic[level])
            local canUse, name1,name2 = DataCenter.FormStatusManager:CanUseMasterySkill(self.formationData.uuid,buffId)
            if canUse == true then
                DataCenter.MasteryManager:TryUseSkill(self.skill, { fUuid = self.formationData.uuid }, function()
                    view:Close()
                end)
            else
                UIUtil.ShowTips(Localization:GetString("111229",Localization:GetString(name1),Localization:GetString(name2)))
            end
        end
    elseif self.state == MasterySkillState.Locked then
        DataCenter.MasteryManager:ShowHome(self.template.home, self.template.group)
    end
end

OpFormationBuff.Init = Init
OpFormationBuff.OnClick = OnClick

return OpFormationBuff