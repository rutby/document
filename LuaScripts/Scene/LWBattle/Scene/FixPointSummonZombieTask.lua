---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by w.
--- DateTime: 2022/12/19 18:42
---


local Time = Time

local FixPointSummonZombieTask = BaseClass("FixPointSummonZombieTask")

function FixPointSummonZombieTask:__init(battleMgr,interval,pos,metaId,count,context)
    self.battleMgr = battleMgr---@type DataCenter.ZombieBattle.ZombieBattleManager
    self.interval = interval/1000
    self.lastTickTime = 0
    self.genNum = 0
    self.limit = count
    self.metaId = metaId
    self.pos = pos
    self.context = context
end

function FixPointSummonZombieTask:Update()
    local now = Time.time
    if (now - self.lastTickTime > self.interval) then
        self.lastTickTime = now
        self:DoLogic()
    end
end

function FixPointSummonZombieTask:DoLogic()
    if(self.genNum > self.limit) then
        self.battleMgr:RemoveGenZombieTask(self)
        return
    end
    
    if(self.battleMgr.squad == nil) then
        return
    end
    
    self.battleMgr:CreateMonster(self.metaId,self.pos,self.context)
    self.genNum = self.genNum + 1
end

return FixPointSummonZombieTask

