---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Imaginaerum.
--- DateTime: 2023/6/16 18:53
---
local DragonBuildProtectEffect = BaseClass("DragonBuildProtectEffect")

--创建
local function OnCreate(self,go)
    if go ~= nil then
        self.request = go
        self.gameObject = go.gameObject
        self.transform = go.gameObject.transform
    end
    self:ComponentDefine()
    self:DataDefine()
end

-- 销毁
local function OnDestroy(self)
    self:ComponentDestroy()
    self:DataDestroy()
end

local function ComponentDefine(self)
end

local function ComponentDestroy(self)
    self.gameObject = nil
    self.transform = nil
end


local function DataDefine(self)
    self.isUpdate = false
    self.param = nil
    self.curPosition = nil
end

local function DataDestroy(self)
    self.param = nil
    self.curPosition = nil
    self.timer_action = nil
    self:DeleteTimer()
end

local function DeleteTimer(self)
    self.isUpdate = false
    if self.timer ~= nil then
        self.timer:Stop()
        self.timer = nil
    end
end

local function AddTimer(self)
    self.isUpdate = true
    if self.timer == nil then
        self.timer = TimerManager:GetInstance():GetTimer(1, self.timer_action, self, false,false,false)
    end

    self.timer:Start()
end

local function CheckIsFinish(self)
    if self.isUpdate == true then
        if self.param~=nil then
            local curTime = UITimeManager:GetInstance():GetServerTime()
            if curTime > self.param.endTime then
                self.isUpdate = false
                DragonEffectManager:GetInstance():RemoveBuildProtectEffect(self.param.bUuid)
            end
        end
    end
end
local function ReInit(self,param)
    self.timer = nil
    self.timer_action = function(temp)
        self:CheckIsFinish()
    end
    self:AddTimer()
    self.param = param
    self:ShowPanel(self.param.tile)

end

local function ShowPanel(self,tile)
    self.gameObject.transform.position = SceneUtils.TileIndexToWorld(self.param.posIndex,ForceChangeScene.World)+Vector3.New(-(tile/2),0,-(tile/2))
end

local function Show(self)
    --self.simpleAnim:Play("show")
end
local function Hide(self)
    --self.simpleAnim:Play("hide")
end

DragonBuildProtectEffect.OnCreate = OnCreate
DragonBuildProtectEffect.OnDestroy = OnDestroy
DragonBuildProtectEffect.ComponentDefine = ComponentDefine
DragonBuildProtectEffect.ComponentDestroy = ComponentDestroy
DragonBuildProtectEffect.DataDefine = DataDefine
DragonBuildProtectEffect.DataDestroy = DataDestroy
DragonBuildProtectEffect.ReInit = ReInit
DragonBuildProtectEffect.ShowPanel = ShowPanel
DragonBuildProtectEffect.CheckIsFinish = CheckIsFinish
DragonBuildProtectEffect.AddTimer = AddTimer
DragonBuildProtectEffect.DeleteTimer = DeleteTimer
DragonBuildProtectEffect.Show = Show
DragonBuildProtectEffect.Hide = Hide
return DragonBuildProtectEffect