---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Imaginaerum.
--- DateTime: 2022/1/20 14:51
---
local MonsterRewardBoxEffectManager = BaseClass("MonsterRewardBoxEffectManager", Singleton)
local MonsterRewardBoxEffect = require "Scene.MonsterRewardBoxEffect.MonsterRewardBoxEffect"
local ResourceManager = CS.GameEntry.Resource

local function __init(self)
    self.allEffect = {} --所有特效
    self:AddListener()
end

local function __delete(self)
    self.allEffect = nil
    self:RemoveListener()
end

local function MonsterRewardCreateSignal(data)
    local pointId = tonumber(data)
    MonsterRewardBoxEffectManager:GetInstance():ShowOneEffect(pointId)
end

local function AddListener(self)
    EventManager:GetInstance():AddListener(EventId.MonsterRewardCreate, self.MonsterRewardCreateSignal)
end

local function RemoveListener(self)
    EventManager:GetInstance():RemoveListener(EventId.MonsterRewardCreate, self.MonsterRewardCreateSignal)
end
local function ShowOneEffect(self,pointId)
    --if self.allEffect[pointId] ~= nil then
    --    return
    --end
    --local request = ResourceManager:InstantiateAsync(UIAssets.MonsterRewardBoxEffect)
    --self.allEffect[pointId] = request
    --request:completed('+', function()
    --    if request.isError then
    --        self.allEffect[pointId] =nil
    --        return
    --    end
    --    if CS.SceneManager.World==nil then
    --        request:Destroy()
    --        self.allEffect[pointId] = nil
    --        return
    --    end
    --    request.gameObject:SetActive(true)
    --    request.gameObject.transform:SetParent(CS.SceneManager.World.BuildBubbleNode)
    --    request.gameObject.transform:Set_localScale(ResetScale.x, ResetScale.y, ResetScale.z)
    --
    --    local buildEffect = MonsterRewardBoxEffect.New()
    --    buildEffect:OnCreate(request)
    --    local param = {}
    --    param.pointId= pointId
    --    param.request = request
    --    buildEffect:ReInit(param)
    --end)
end


local function RemoveOneEffect(self,pointId)
    if self.allEffect[pointId]~=nil then
        self.allEffect[pointId]:Destroy()
    end
    self.allEffect[pointId] =nil
end

MonsterRewardBoxEffectManager.__init = __init
MonsterRewardBoxEffectManager.__delete = __delete
MonsterRewardBoxEffectManager.RemoveOneEffect = RemoveOneEffect
MonsterRewardBoxEffectManager.MonsterRewardCreateSignal = MonsterRewardCreateSignal
MonsterRewardBoxEffectManager.AddListener = AddListener
MonsterRewardBoxEffectManager.RemoveListener = RemoveListener
MonsterRewardBoxEffectManager.ShowOneEffect = ShowOneEffect
return MonsterRewardBoxEffectManager