---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- DateTime: 2021/7/30 19:31
---
local HelperDetectWorldBuildBubble = BaseClass("HelperDetectWorldBuildBubble")
local SpriteRenderer = CS.UnityEngine.SpriteRenderer
local Localization = CS.GameEntry.Localization

--创建
local function OnCreate(self,go)
    if go ~= nil then
        self.request = go
        self.gameObject = go.gameObject
        self.transform = go.gameObject.transform
    end
    self:ComponentDefine()
    self:DataDefine()
end

-- 销毁
local function OnDestroy(self)

    self.request = nil
    self.gameObject = nil
    self.transform = nil

    -- self:DeleteTimer()
    self:ComponentDestroy()
    self:DataDestroy()
end

local function ComponentDefine(self)
    self.headIcon = self.transform:Find("Transform/HeadIcon"):GetComponent(typeof(CS.UIPlayerHead))
    self.foreground = self.transform:Find("Transform/Foreground"):GetComponent(typeof(CS.UnityEngine.SpriteRenderer))
    self.text = self.transform:Find("Transform/Text"):GetComponent(typeof(CS.SuperTextMesh))
end

local function ComponentDestroy(self)

end

local function DataDefine(self)
    self.param = nil
    self.curPosition = nil
end

local function DataDestroy(self)
    self.param = nil
    self.curPosition = nil
end

local function ReInit(self,param, bUuid)
    self.param = param
    self.bUuid = bUuid
    self:ShowPanel()
end

local function ShowPanel(self)
    local data = self.param.helpInfo
    self.headIcon:SetData(data.uid, data.pic, tonumber(data.picVer), false)

    self.headIcon:SetCustomLoadCallback(function()
        if self.headIcon ~= nil and self.headIcon.transform ~= nil and not IsNull(self.headIcon.transform) then -- self.headIcon.transform
            local icon = self.headIcon.transform:GetComponent(typeof(SpriteRenderer))
            if not IsNull(icon) then
                icon:Set_size(1,1)
            end
        end
    end)

    local textList = {GameDialogDefine.DETECT_3, GameDialogDefine.DETECT_4, GameDialogDefine.DETECT_5, GameDialogDefine.DETECT_6}
    local random = math.random(1, 4)
    self.text.text = Localization:GetString(textList[random])
end

local function OnLodChange(self,lod)
    if not IsNull(self.gameObject) then
        self.gameObject:SetActive(lod<3)
    end
end

HelperDetectWorldBuildBubble.OnCreate = OnCreate
HelperDetectWorldBuildBubble.OnDestroy = OnDestroy
HelperDetectWorldBuildBubble.ComponentDefine = ComponentDefine
HelperDetectWorldBuildBubble.ComponentDestroy = ComponentDestroy
HelperDetectWorldBuildBubble.DataDefine = DataDefine
HelperDetectWorldBuildBubble.DataDestroy = DataDestroy
HelperDetectWorldBuildBubble.ReInit = ReInit
HelperDetectWorldBuildBubble.ShowPanel = ShowPanel
HelperDetectWorldBuildBubble.OnLodChange = OnLodChange
return HelperDetectWorldBuildBubble