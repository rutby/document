---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by 1022.
--- DateTime: 2023/10/11 14:51
---
local PveBuffManager = BaseClass("PveBuffManager")
local PveReportBuff = require("Scene.BattlePveModule.PveReportModule.Buff.PveReportBuff")

function PveBuffManager:__init(owner)
    self.m_owner = owner
    self.m_buffs = {}
    self.m_currentBuff = nil
end

function PveBuffManager:AddBuffs(buffs)
    table.insertto(self.m_buffs,buffs,0)
end

function PveBuffManager:OnUpdate(deltaTime)
    if self.m_currentBuff == nil then
        self:CheckDoBuff()
    else
        self:CheckBuffComplete()
    end
end

function PveBuffManager:CheckDoBuff()
    if #self.m_buffs > 0 then
        local buffSkill = self.m_buffs[1]

        table.remove(self.m_buffs,1)

        self.m_currentBuff = PveReportBuff.New(self.m_owner,buffSkill)
    end
end

function PveBuffManager:CheckBuffComplete()
    if self.m_currentBuff ~= nil and self.m_currentBuff:CheckComplete() then
        self.m_currentBuff:Destroy()
        self.m_currentBuff = nil
    end
end

function PveBuffManager:Destroy()
    self.m_owner = nil
    self.m_buffs = nil
    if self.m_currentBuff ~= nil then
        self.m_currentBuff:Destroy()
        self.m_currentBuff = nil
    end
end


return PveBuffManager