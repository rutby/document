---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by 1.
--- DateTime: 2023/7/11 14:35
---
local CharacterBaseState = require("Scene.PVEBattleLevel.Character.State.CharacterBaseState")
local CharacterAniState = BaseClass("CharacterAniState",CharacterBaseState)

function CharacterAniState:OnEnter()
    self.m_owner:PlayAnim(self.m_data.aniName)
    self:AddItemToHangPoint()
    self:__addEvent()
end

function CharacterAniState:__addEvent()
    if self.m_owner.animEvent then
        self.m_owner.animEvent.animation_playEnd = function() self:__onAnimPlayEnd()  end
    end
end

function CharacterAniState:__removeEvent()
    if self.m_owner.animEvent then
        self.m_owner.animEvent.animation_playEnd = nil
    end
end

function CharacterAniState:__onAnimPlayEnd()
    self:OnExit()
end

function CharacterAniState:OnExit()
    self:__removeEvent()
    if self.m_data ~= nil and not string.IsNullOrEmpty(self.m_data.hangItem) then
        self.m_owner:ResetWeapon()
    end
    self:OnStateComplete()
end

function CharacterAniState:Destroy()
    self:__removeEvent()
    CharacterBaseState.Destroy(self)
end

function CharacterAniState:AddItemToHangPoint()
    if self.m_data ~= nil and not string.IsNullOrEmpty(self.m_data.hangItem) then
        if self.m_owner.ShowToolByPath then
            self.m_owner:ShowToolByPath(self.m_data.hangItem)
        end
    end
end

return CharacterAniState