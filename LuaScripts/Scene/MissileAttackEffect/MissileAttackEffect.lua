---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by 1.
--- DateTime: 2023/4/19 15:11
---

local MissileAttackEffect = BaseClass("MissileAttackEffect")
--创建
local function OnCreate(self,go)
    if go ~= nil then
        self.request = go
        self.gameObject = go.gameObject
        self.transform = go.gameObject.transform
    end
    self:ComponentDefine()
end

-- 销毁
local function OnDestroy(self)
    self:RemoveTimer()
    self:ComponentDestroy()
end

local function ComponentDefine(self)
    self.isDoAnim = false
    self.__update_handle = function() self:Update() end
    UpdateManager:GetInstance():AddUpdate(self.__update_handle)
end

local function ComponentDestroy(self)
end
local function RemoveTimer(self)
    if self.__update_handle~=nil then
        UpdateManager:GetInstance():RemoveUpdate(self.__update_handle)
        self.__update_handle = nil
    end

end

local function ReInit(self,param)
    self.data = param
    self:UpdatePosition(self.data.pointId)
    self.curTime =0
    self.isDoAnim = true
    self:Update()
end


local function Update(self)
    if self.isDoAnim then
        self.curTime = self.curTime+Time.deltaTime
        if self.curTime > 3 then
            self:RemoveTimer()
            MissileAttackEffectManager:GetInstance():RemoveOneEffect(self.data.pointId)
        end
    end
end

local function UpdatePosition(self,index)
    local worldPos = SceneUtils.TileIndexToWorld(index) + Vector3.New(-2, 0, -2)
    self.transform.position = worldPos
end


MissileAttackEffect.OnCreate = OnCreate
MissileAttackEffect.OnDestroy = OnDestroy
MissileAttackEffect.ComponentDefine = ComponentDefine
MissileAttackEffect.ComponentDestroy = ComponentDestroy
MissileAttackEffect.Update = Update
MissileAttackEffect.RemoveTimer =RemoveTimer
MissileAttackEffect.ReInit = ReInit
MissileAttackEffect.UpdatePosition = UpdatePosition
return MissileAttackEffect