---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by zzl
--- DateTime: 
---
local PersonRewardCell = BaseClass("PersonRewardCell", UIBaseContainer)
local base = UIBaseContainer
local Localization = CS.GameEntry.Localization
local UIActDragonRewardCell = require "UI.UIActDragon.UIActDragonRule.Component.UIActDragonRewardCell"

-- 创建
function PersonRewardCell:OnCreate()
    base.OnCreate(self)
    self:DataDefine()
    self:ComponentDefine()
end

-- 销毁
function PersonRewardCell:OnDestroy()

    self:ComponentDestroy()
    self:DataDestroy()
    base.OnDestroy(self)
end

--控件的定义
function PersonRewardCell:ComponentDefine()
    self._personScore_txt = self:AddComponent(UIText,"Txt_PersonScore")
    self._personContent_rect = self:AddComponent(UIBaseContainer,"Rect_PersonContent")
end

--控件的销毁
function PersonRewardCell:ComponentDestroy()

end

--变量的定义
function PersonRewardCell:DataDefine()
 
end

--变量的销毁
function PersonRewardCell:DataDestroy()
 
end

--type 1:winScore  2:loseScore
function PersonRewardCell:ReInit(type,reward,index)
    local info = DataCenter.ActDragonManager:GetScoreInfo(type)
    if info then
        self._personScore_txt:SetText(info[index].s.."-"..info[index].e)
    end
    self:ClearCell()
    for i = 1 ,table.count(reward) do
        --复制基础prefab，每次循环创建一次
        self.personalRewardModel[i] = self:GameObjectInstantiateAsync(UIAssets.UIActDragonRewardCell, function(request)
            if request.isError then
                return
            end
            local go = request.gameObject;
            go.gameObject:SetActive(true)
            go.transform:SetParent(self._personContent_rect.transform)
            go.transform.localScale = Vector3.New(0.6, 0.6, 0.6)
            local nameStr = tostring(NameCount)
            go.name = nameStr
            NameCount = NameCount + 1
            local cell = self._personContent_rect:AddComponent(UIActDragonRewardCell,nameStr)
            cell:ReInit(reward[i])
        end)
    end
end

function PersonRewardCell:ClearCell()
    self._personContent_rect:RemoveComponents(UIActDragonRewardCell)
    if self.personalRewardModel then
        for k,v in pairs(self.personalRewardModel) do
            if v ~= nil then
                self:GameObjectDestroy(v)
            end
        end
    end
    self.personalRewardModel = {}
end

function PersonRewardCell:RefreshAll()
  
end


return PersonRewardCell