---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Beef.
--- DateTime: 2022/7/26 18:08
---

local UIHeroOfficialTab = BaseClass("UIHeroOfficialTab", UIBaseContainer)
local base = UIBaseContainer
local Localization = CS.GameEntry.Localization

local this_path = ""
local off_path = "Off"
local off_red_path = "Off/OffRed"
local on_path = "On"
local on_red_path = "On/OnRed"
local name_path = "On/Name"

local NameColor =
{
    [1] = Color.New(0.9215686, 0.8823529, 1.0000000, 1),
    [2] = Color.New(0.9254902, 0.9529412, 1.0000000, 1),
    [3] = Color.New(0.9607843, 0.8705882, 0.7176471, 1),
}

local NameShadowColor =
{
    [1] = Color.New(0.2274510, 0.1843137, 0.4039216, 1),
    [2] = Color.New(0.2392157, 0.2470588, 0.4588235, 1),
    [3] = Color.New(0.2039216, 0.1058824, 0.0196078, 1),
}

local function OnCreate(self)
    base.OnCreate(self)
    self:DataDefine()
    self:ComponentDefine()
end

local function OnDestroy(self)
    self:ComponentDestroy()
    self:DataDestroy()
    base.OnDestroy(self)
end

local function ComponentDefine(self)
    self.btn = self:AddComponent(UIButton, this_path)
    self.btn:SetOnClick(function()
        self:OnClick()
    end)
    self.off_go = self:AddComponent(UIBaseContainer, off_path)
    self.off_red_go = self:AddComponent(UIBaseContainer, off_red_path)
    self.on_anim = self:AddComponent(UIAnimator, on_path)
    self.on_red_go = self:AddComponent(UIBaseContainer, on_red_path)
    self.name_text = self:AddComponent(UITextMeshProUGUIEx, name_path)
end

local function ComponentDestroy(self)
    self.btn = nil
    self.off_go = nil
    self.off_red_go = nil
    self.on_anim = nil
    self.on_red_go = nil
    self.name_text = nil
end

local function DataDefine(self)
    self.camp = 0
end

local function DataDestroy(self)
    self.camp = nil
end

local function OnEnable(self)
    base.OnEnable(self)
end

local function OnDisable(self)
    base.OnDisable(self)
end

local function ReInit(self, camp)
    self.camp = camp

    local name = HeroUtils.GetCampNameAndDesc(camp)
    local shadows = self.name_text.transform:GetComponentsInChildren(typeof(CS.UnityEngine.UI.Shadow))
    for i = 0, shadows.Length - 1 do
        shadows[i].effectColor = NameShadowColor[camp]
    end
    self.name_text:SetColor(NameColor[camp])
    self.name_text:SetText(name)
    self:Refresh()
end

local function Refresh(self)
    local showRed = DataCenter.HeroOfficialManager:HaveEmptySlotAndAvailableHero(self.camp)
            or DataCenter.HeroIntensifyManager:GetRedNum(self.camp) > 0
    self.off_red_go:SetActive(showRed)
    self.on_red_go:SetActive(showRed)
end

local function SetIsOn(self, isOn)
    self.off_go:SetActive(not isOn)
    self.on_anim:SetActive(isOn)
    if isOn then
        self.on_anim:Play("CommonPopup_movein", 0, 0)
    end
end

local function SetOnClick(self, onClick)
    self.onClick = onClick
end

local function OnClick(self)
    if self.onClick then
        self.onClick()
    end
end

UIHeroOfficialTab.OnCreate= OnCreate
UIHeroOfficialTab.OnDestroy = OnDestroy
UIHeroOfficialTab.ComponentDefine = ComponentDefine
UIHeroOfficialTab.ComponentDestroy = ComponentDestroy
UIHeroOfficialTab.DataDefine = DataDefine
UIHeroOfficialTab.DataDestroy = DataDestroy
UIHeroOfficialTab.OnEnable = OnEnable
UIHeroOfficialTab.OnDisable = OnDisable

UIHeroOfficialTab.ReInit = ReInit
UIHeroOfficialTab.Refresh = Refresh
UIHeroOfficialTab.SetIsOn = SetIsOn
UIHeroOfficialTab.SetOnClick = SetOnClick
UIHeroOfficialTab.OnClick = OnClick

return UIHeroOfficialTab