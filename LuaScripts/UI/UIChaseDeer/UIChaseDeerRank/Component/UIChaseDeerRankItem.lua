---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Beef.
--- DateTime: 2023/8/3 12:03
---

local UIChaseDeerRankItem = BaseClass("UIChaseDeerRankItem", UIBaseContainer)
local base = UIBaseContainer
local AllianceFlagItem = require "UI.UIAlliance.UIAllianceFlag.Component.AllianceFlagItem"
local Localization = CS.GameEntry.Localization

local rank_path = "Rank"
local rank_icon_path = "RankIcon"
local name_path = "Name"
local leader_path = "Leader"
local country_path = "Country"
local alliance_flag_path = "AllianceFlag"
local score_path = "Score"

local function OnCreate(self)
    base.OnCreate(self)
    self:DataDefine()
    self:ComponentDefine()
end

local function OnDestroy(self)
    self:ComponentDestroy()
    self:DataDestroy()
    base.OnDestroy(self)
end

local function OnEnable(self)
    base.OnEnable(self)
end

local function OnDisable(self)
    base.OnDisable(self)
end

local function ComponentDefine(self)
    self.rank_text = self:AddComponent(UIText, rank_path)
    self.rank_icon_image = self:AddComponent(UIImage, rank_icon_path)
    self.name_text = self:AddComponent(UIText, name_path)
    self.leader_text = self:AddComponent(UIText, leader_path)
    self.country_image = self:AddComponent(UIImage, country_path)
    self.alliance_flag = self:AddComponent(AllianceFlagItem, alliance_flag_path)
    self.score_text = self:AddComponent(UIText, score_path)
end

local function ComponentDestroy(self)
    
end

local function DataDefine(self)
    self.data = nil
    self.onClick = nil
end

local function DataDestroy(self)
    
end

local function OnAddListener(self)
    base.OnAddListener(self)
end

local function OnRemoveListener(self)
    base.OnRemoveListener(self)
end

local function SetData(self, data)
    if data.rank <= 0 then
        self.rank_text:SetActive(true)
        self.rank_text:SetText("-")
        self.rank_icon_image:SetActive(false)
    elseif data.rank <= 3 then
        self.rank_text:SetActive(false)
        self.rank_icon_image:SetActive(true)
        self.rank_icon_image:LoadSprite("Assets/Main/Sprites/UI/UIAlliance/rank/UIalliance_rankingbg0" .. data.rank)
    else
        self.rank_text:SetActive(true)
        self.rank_text:SetText(data.rank)
        self.rank_icon_image:SetActive(false)
    end
    self.name_text:SetText(string.format("[%s] %s", data.abbr, data.alliancename))
    self.leader_text:SetText(Localization:GetString("390020") .. " " .. data.leader)
    if LuaEntry.Player:IsHideCountryFlag() then
        self.country_image:SetActive(false)
    else
        local flagTemplate = DataCenter.NationTemplateManager:GetNationTemplate(data.country)
        self.country_image:LoadSprite(flagTemplate:GetNationFlagPath())
        self.country_image:SetActive(true)
    end
    self.alliance_flag:SetData(data.icon)
    self.score_text:SetText(string.GetFormattedSeperatorNum(data.force))
end

local function SetOnClick(self, onClick)
    self.onClick = onClick
end

local function OnClick(self)
    if self.onClick then
        self.onClick()
    end
end

UIChaseDeerRankItem.OnCreate = OnCreate
UIChaseDeerRankItem.OnDestroy = OnDestroy
UIChaseDeerRankItem.OnEnable = OnEnable
UIChaseDeerRankItem.OnDisable = OnDisable
UIChaseDeerRankItem.ComponentDefine = ComponentDefine
UIChaseDeerRankItem.ComponentDestroy = ComponentDestroy
UIChaseDeerRankItem.DataDefine = DataDefine
UIChaseDeerRankItem.DataDestroy = DataDestroy
UIChaseDeerRankItem.OnAddListener = OnAddListener
UIChaseDeerRankItem.OnRemoveListener = OnRemoveListener

UIChaseDeerRankItem.SetData = SetData
UIChaseDeerRankItem.SetOnClick = SetOnClick
UIChaseDeerRankItem.OnClick = OnClick

return UIChaseDeerRankItem