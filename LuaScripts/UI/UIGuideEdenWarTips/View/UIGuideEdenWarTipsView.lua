---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Imaginaerum.
--- DateTime: 2023/8/9 18:42
---
local UIGuideEdenWarTipsView = BaseClass("UIGuideEdenWarTipsView",UIBaseView)
local base = UIBaseView
local Localization = CS.GameEntry.Localization
function UIGuideEdenWarTipsView:OnCreate()
    base.OnCreate(self)
    self.guideType,self.eden_point_num = self:GetUserData()
    if self.eden_point_num ==nil then
        self.eden_point_num = 100
    end
    self.close_btn = self:AddComponent(UIButton, "CloseBtn")
    self.close_btn:SetOnClick(function()
        SoundUtil.PlayEffect(SoundAssets.Music_Effect_Button)
        self.ctrl:CloseSelf()
    end)
    self.title = self:AddComponent(UIText,"title")
    self.Text_des = self:AddComponent(UIText,"desBg/Text_des")
    self.power_bg = self:AddComponent(UIBaseContainer,"powerBg")
    self.des1 = self:AddComponent(UIText,"powerBg/des1")
    self.des2 = self:AddComponent(UIText,"powerBg/des2")
    self.img = self:AddComponent(UIImage,"Image")
    self:ReInit()
end

function UIGuideEdenWarTipsView:OnDestroy()
    base.OnDestroy(self)
end

function UIGuideEdenWarTipsView:ReInit()
    local imgStr = "Assets/Main/TextureEx/UIGovernment/UIss5_zhuye_rules0"..self.guideType
    self.img:LoadSprite(imgStr)
    if self.guideType ==1 then
        self.power_bg:SetActive(false)
        self.title:SetLocalText(111073)
        self.Text_des:SetLocalText(111196)
    elseif self.guideType == 2 then
        self.power_bg:SetActive(false)
        self.title:SetLocalText(111071)
        self.Text_des:SetLocalText(111197)
    elseif self.guideType == 3 then
        self.power_bg:SetActive(true)
        self.title:SetLocalText(111138)
        self.Text_des:SetLocalText(111195)
        local curNum = toInt(self.eden_point_num)
        local decMax = LuaEntry.DataConfig:TryGetNum("eden_signal","k5")
        local decPercent = LuaEntry.DataConfig:TryGetNum("eden_signal","k3")
        local dec = math.max(100-curNum,0)
        local realDec = math.min((dec*decPercent),decMax)
        self.des1:SetText(Localization:GetString("111138")..": "..curNum)
        self.des2:SetText(Localization:GetString("111194")..": "..realDec.."%")
    end
end

function UIGuideEdenWarTipsView:OnEnable()
    base.OnEnable(self)
end

function UIGuideEdenWarTipsView:OnDisable()
    base.OnDisable(self)
end

function UIGuideEdenWarTipsView:OnAddListener()
    base.OnAddListener(self)
    self:AddUIListener(EventId.ControlSeasonIntro, self.GetCtrlSignal)
    self:AddUIListener(EventId.UIGuideEdenWarTipsUpdate, self.RefreshGuideAnimSignal)
end

function UIGuideEdenWarTipsView:OnRemoveListener()
    base.OnRemoveListener(self)
    self:RemoveUIListener(EventId.ControlSeasonIntro, self.GetCtrlSignal)
    self:RemoveUIListener(EventId.UIGuideEdenWarTipsUpdate, self.RefreshGuideAnimSignal)
end
local function GetCtrlSignal(self,data)
    if data == ControlSeasonIntroType.ShowCloseBtn then
        self.close_btn:SetActive(true)
    end
end

local function RefreshGuideAnimSignal(self,data)
    self.guideType = data
    self:ReInit()
end
UIGuideEdenWarTipsView.GetCtrlSignal = GetCtrlSignal
UIGuideEdenWarTipsView.RefreshGuideAnimSignal = RefreshGuideAnimSignal
return UIGuideEdenWarTipsView