---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by 
--- DateTime: 
---
local RankListItem = BaseClass("RankListItem",UIBaseContainer)
local base = UIBaseContainer

local power_path = "powerTxt" -- 右边那列

local Localization = CS.GameEntry.Localization
local function OnCreate(self)
    base.OnCreate(self)
    self._name_txt = self:AddComponent(UIText,"Txt_Name")
    self._allianceName_txt = self:AddComponent(UIText,"Txt_AllianceName")
   -- self.power_txt = self:AddComponent(UIText,power_path)

	self._country_img = self:AddComponent(UIImage,"Img_Country")
    self.num_txt = self:AddComponent(UIText,"numTxt")
    
    self.first_flag = self:AddComponent(UIBaseContainer,"firstImg")
    self.second_flag = self:AddComponent(UIBaseContainer,"secondImg")
    self.third_flag = self:AddComponent(UIBaseContainer,"thirdImg")
    
    self.player_flag = self:AddComponent(UIBaseContainer,"playerFlag")
	
	self.player_img =self:AddComponent(UIPlayerHead,"playerFlag/UIPlayerHead/HeadIcon")
    self.playerHeadFg = self:AddComponent(UIImage, "playerFlag/UIPlayerHead/Foreground")
	
	self._force_txt = self:AddComponent(UIText,"Txt_Force")
    
    self.btn = self:AddComponent(UIButton, "Button")
    self.btn:SetOnClick(function()  
SoundUtil.PlayEffect(SoundAssets.Music_Effect_Button)
        self:OnClick()
    end)
end

local function SetItemShow(self, data)
    self.data = data

    self.player_flag:SetActive(true)
    self.first_flag:SetActive(self.data.rank ==1)
    self.third_flag:SetActive(self.data.rank ==3)
    self.second_flag:SetActive(self.data.rank ==2)
    self.num_txt:SetText(self.data.rank)
    if self.data.rank>3 then
        self.num_txt:SetActive(true)
    else
        self.num_txt:SetActive(false)
    end
	
    self._name_txt:SetText(self.data.name)

	if self.data.abbr then
		local allianceName =  "["..self.data.abbr.."]"..self.data.allianceName
		self._allianceName_txt:SetText(Localization:GetString('372761',self.data.serverId,allianceName))
	else
		self._allianceName_txt:SetText("-")
	end
	
	self.player_img:SetData(self.data.uid, self.data.pic, self.data.picVer)
	
    if self.data.headBg then
        self.playerHeadFg:SetActive(true)
        self.playerHeadFg:LoadSprite(self.data.headBg)
    else
        self.playerHeadFg:SetActive(false)
    end
	
	self._force_txt:SetText(self.data.score)

	if LuaEntry.Player:IsHideCountryFlag() then
		self._country_img:SetActive(false)
	else
		self._country_img:SetActive(true)
		local countryConfig = DataCenter.NationTemplateManager:GetNationTemplate(DefaultNation)
		if self.data.country ~= "" then
			countryConfig = DataCenter.NationTemplateManager:GetNationTemplate(self.data.country)
		end
		self._country_img:LoadSprite(countryConfig:GetNationFlagPath())
	end
end

local function OnClick(self)
	if self.data.uid~= LuaEntry.Player.uid then
		UIManager:GetInstance():OpenWindow(UIWindowNames.UIOtherPlayerInfo,self.data.uid)
	else
		UIManager:GetInstance():OpenWindow(UIWindowNames.UIPlayerInfo,LuaEntry.Player.uid)
	end
end
local function OnDestroy(self)
	self._name_txt= nil
	self.second_txt = nil
	self.power_txt = nil
	self.num_txt = nil

	self.first_flag = nil
	self.second_flag = nil
	self.third_flag = nil

	self.player_flag = nil

	self.player_img =nil

	self.btn = nil
    base.OnDestroy(self)
end
RankListItem.OnCreate = OnCreate
RankListItem.SetItemShow = SetItemShow
RankListItem.OnClick = OnClick
RankListItem.OnDestroy =OnDestroy
return RankListItem