---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by zzl.
--- DateTime: 
---
local UILuckyRollBox = BaseClass("UILuckyRollBox",UIBaseContainer)
local base = UIBaseContainer
local Localization = CS.GameEntry.Localization
function UILuckyRollBox:OnCreate()
    base.OnCreate(self)
    
    self._needNum_txt = self:AddComponent(UITextMeshProUGUIEx,"Txt_NeedNum")
    self._box_btn = self:AddComponent(UIButton,"")
    self._box_btn:SetOnClick(function()
        self:OnClickReward()
    end)
    self.icon = self:AddComponent(UIImage,"icon")
    self._rece_img = self:AddComponent(UIImage,"ReceImg")
end

function UILuckyRollBox:OnDestroy()
    base.OnDestroy(self)
end

function UILuckyRollBox:OnEnable()
    base.OnEnable(self)
end

function UILuckyRollBox:OnDisable()

    base.OnDisable(self)
end

function UILuckyRollBox:RefreshData(data,allNum,activityId)
    self.data = data
    self.allNum = allNum
    self.activityId = activityId
    self:RefreshBox()
end

function UILuckyRollBox:RefreshBox()
    self._needNum_txt:SetText(self.data.needLotteryNum)
    if self.data.state == 0 then
        self.icon:SetActive(true)
        self._rece_img:SetActive(false)
    else
        self.icon:SetActive(false)
        self._rece_img:SetActive(true)
    end
end

function UILuckyRollBox:OnClickReward()
    local x = self.transform.position.x
    local y = self.transform.position.y
    local offset = 80
    --如果没有领奖并且总次数大于需要次数
    if self.data.state == 0 and self.allNum >= self.data.needLotteryNum then
        --领奖
        SFSNetwork.SendMessage(MsgDefines.ReceiveLuckyRollStageReward,self.activityId,self.data.stage)
    else
        UIManager:GetInstance():OpenWindow(UIWindowNames.UIActivityRewardTip,Localization:GetString("104191"),ActivityEnum.ActivityType.TurntableActivity,x,y,false,self.data.stage,offset,self.activityId)
    end

end

return UILuckyRollBox