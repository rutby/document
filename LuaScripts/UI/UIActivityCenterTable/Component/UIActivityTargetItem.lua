---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by guqu.
--- DateTime: 2020/8/10 18:05
---
local UIActivityTargetItem = BaseClass("UIActivityTargetItem",UIBaseContainer)
local base = UIBaseContainer
local Localization = CS.GameEntry.Localization
local UIHeroTipsView = require "UI.UIHeroTips.View.UIHeroTipsView"
function UIActivityTargetItem:OnCreate()
    base.OnCreate(self)
    self.bg = self:AddComponent(UIBaseContainer,"bg")
    self._require_txt = self:AddComponent(UITextMeshProUGUIEx,"Txt_Require")
    self._reward_txt  = self:AddComponent(UITextMeshProUGUIEx,"Txt_Reward")
    self.infoBtn = self:AddComponent(UIButton, "Txt_Reward/tipBtn")
    self.infoBtn:SetOnClick(function()
        self:OnClickInfoBtn()
    end)
end

function UIActivityTargetItem:OnDestroy()
    base.OnDestroy(self)
end

function UIActivityTargetItem:OnEnable()
    base.OnEnable(self)
end

function UIActivityTargetItem:OnDisable()

    base.OnDisable(self)
end

function UIActivityTargetItem:RefreshData(param)
    self.param = param
    if next(param.paramsList) then
        self._require_txt:SetLocalText(param.name,param.paramsList[1])
    else
        self._require_txt:SetLocalText(param.name) 
    end
    if string.IsNullOrEmpty(param.point) or tonumber(param.point) == 0 then
        self._reward_txt:SetLocalText(372564)
        self.infoBtn:SetActive(true)
    else
        self._reward_txt:SetText("+ "..string.GetFormattedSeperatorNum(param.point))
        self.infoBtn:SetActive(false)
    end

end

function UIActivityTargetItem:SetBg(i)
    if i % 2 == 0 then
        self.bg:SetActive(false)
    else
        self.bg:SetActive(true)
    end
end

function UIActivityTargetItem:OnClickInfoBtn()
    local scaleFactor = UIManager:GetInstance():GetScaleFactor()
    local position = self.infoBtn.transform.position + Vector3.New(0, 10, 0) * scaleFactor

    local param = UIHeroTipsView.Param.New()
    param.content = Localization:GetString(self.param.tips)
    param.dir = UIHeroTipsView.Direction.ABOVE
    param.defWidth = 400
    param.pivot = 0.85
    param.position = position
    param.bindObject = self.gameObject
    UIManager:GetInstance():OpenWindow(UIWindowNames.UIHeroTips, { anim = false }, param)
end


return UIActivityTargetItem