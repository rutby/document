---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by zzl.
--- DateTime: 
---
local WorldTrendTab = BaseClass("WorldTrendTab", UIBaseContainer)
local base = UIBaseContainer
-- 创建
function WorldTrendTab:OnCreate()
    base.OnCreate(self)
    self._tab_list = {}
    for i = 1, 5 do
        self._tab_list[i] = {}
        self._tab_list[i].btn = self:AddComponent(UIButton,"Btn_Tab"..i)
        self._tab_list[i].btn:SetOnClick(function()
            self:OnClickTab(i)
        end)
        self._tab_list[i].red = self:AddComponent(UIBaseContainer,"Btn_Tab"..i.."/RedPoint"..i)
        self._tab_list[i].txt = self:AddComponent(UIText,"Btn_Tab"..i.."/Txt_Tab"..i)
    end
end

-- 销毁
function WorldTrendTab:OnDestroy()
    base.OnDestroy(self)
end

-- 显示
function WorldTrendTab:OnEnable()
    base.OnEnable(self)
end

-- 隐藏
function WorldTrendTab:OnDisable()
    base.OnDisable(self)
end

function WorldTrendTab:SetCallBack(callBack)
    self.callBack = callBack
end

-- 全部刷新
function WorldTrendTab:ReInit(data)
    if data then
        self.data = data
        for i = 1, 5 do
            if data[i] then
                self._tab_list[i].btn:SetActive(true)
                self._tab_list[i].txt:SetLocalText(302620,i)
 
            else
                self._tab_list[i].btn:SetActive(false)
            end
        end
        self:CheckRed()
    end
end

function WorldTrendTab:CheckRed()
    if self.data then
        for k = 1, 5 do
            if self.data[k] then
                self._tab_list[k].red:SetActive(false)
                if self.data[k].rewardStatus == DataCenter.WorldTrendManager.ServerTrendsRewardStatus.Unreceived then
                    if DataCenter.BuildManager.MainLv and self.data[k].levelLimit <= DataCenter.BuildManager.MainLv then
                        self._tab_list[k].red:SetActive(true)
                    end
                end
            end
        end
    end
end

function WorldTrendTab:SetSelect(index)
    for i = 1,5 do
        if index == i then
            self._tab_list[i].txt:SetColor(WhiteColor)
            self._tab_list[i].btn:LoadSprite(string.format(LoadPath.UIWorldTrendNew, "UIchronicles_tab_current"))
        else
            self._tab_list[i].txt:SetColor(Color.New(170/255, 176/255, 252/255, 1))
            self._tab_list[i].btn:LoadSprite(string.format(LoadPath.UIWorldTrendNew, "UIchronicles_tab_unchecked"))
        end
    end
end

function WorldTrendTab:OnClickTab(i)
    if self.callBack then
        if self.data[i] then
            self.callBack(self.data[i],i)
        end
    end
end

return WorldTrendTab