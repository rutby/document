---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Imaginaerum.
--- DateTime: 2023/10/30 11:46
---
local EdenCrossRankItem = BaseClass("EdenCrossRankItem",UIBaseContainer)
local base = UIBaseContainer
local Localization = CS.GameEntry.Localization
local CampStr = {111064,111063}
local function OnCreate(self)
    base.OnCreate(self)
    self._allianceName_txt = self:AddComponent(UIText,"Txt_AllianceName")
    self._allianceLeader_txt = self:AddComponent(UIText,"Txt_AllianceLeader")
    self.num_txt = self:AddComponent(UIText,"numTxt")

    self.first_flag = self:AddComponent(UIBaseContainer,"firstImg")
    self.second_flag = self:AddComponent(UIBaseContainer,"secondImg")
    self.third_flag = self:AddComponent(UIBaseContainer,"thirdImg")

    self._seasonForce_txt = self:AddComponent(UIText,"Txt_SeasonForce")

    self._sFiveCamp_txt = self:AddComponent(UIText,"Txt_SFiveCamp")

    self.player_flag = self:AddComponent(UIBaseContainer,"playerFlag")
    self.player_img =self:AddComponent(UIPlayerHead,"playerFlag/UIPlayerHead/HeadIcon")
    self.playerHeadFg = self:AddComponent(UIImage, "playerFlag/UIPlayerHead/Foreground")

    self.btn = self:AddComponent(UIButton, "Button")
    self.btn:SetOnClick(function()
        SoundUtil.PlayEffect(SoundAssets.Music_Effect_Button)
        self:OnClick()
    end)
end

local function SetItemShow(self, data,index)
    self.data = data
    self.first_flag:SetActive(index ==1)
    self.third_flag:SetActive(index ==3)
    self.second_flag:SetActive(index ==2)
    self.num_txt:SetText(index)
    if index>3 then
        self.num_txt:SetActive(true)
    else
        self.num_txt:SetActive(false)
    end
    self.player_img:SetData(self.data.uid, self.data.pic, self.data.picVer)
    local headBgImg = DataCenter.DecorationDataManager:GetHeadFrame(self.data.headSkinId, self.data.headSkinET)
    if not string.IsNullOrEmpty(headBgImg) then
        self.playerHeadFg:SetActive(true)
        self.playerHeadFg:LoadSprite(headBgImg)
    else
        self.playerHeadFg:SetActive(false)
    end
    --if self.data.allianceId then
    --    local camp = DataCenter.GloryManager:GetCampByAllianceId(self.data.allianceId)
    --    if camp ~= 0 then
    --        self._sFiveCamp_txt:SetLocalText(CampStr[camp])
    --    else
    --        
    --    end
    --end
    self._sFiveCamp_txt:SetText("")
    self._seasonForce_txt:SetText(string.GetFormattedSeperatorNum(self.data.score or 0))
    self._allianceName_txt:SetText(self.data.name)
    local name = Localization:GetString("311026",self.data.abbr,self.data.alliancename)
    self._allianceLeader_txt:SetLocalText(372761,data.serverId,name)
end

local function OnClick(self)
    if self.data.uid ~= LuaEntry.Player.uid then
        UIManager:GetInstance():OpenWindow(UIWindowNames.UIOtherPlayerInfo,self.data.uid)
    else
        UIManager:GetInstance():OpenWindow(UIWindowNames.UIPlayerInfo,LuaEntry.Player.uid)
    end
end
local function OnDestroy(self)
    self._name_txt= nil
    self.second_txt = nil
    self.power_txt = nil
    self.num_txt = nil

    self.first_flag = nil
    self.second_flag = nil
    self.third_flag = nil

    self.btn = nil
    base.OnDestroy(self)
end
EdenCrossRankItem.OnCreate = OnCreate
EdenCrossRankItem.SetItemShow = SetItemShow
EdenCrossRankItem.OnClick = OnClick
EdenCrossRankItem.OnDestroy =OnDestroy
return EdenCrossRankItem