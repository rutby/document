---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Beef.
--- DateTime: 2023/11/6 17:11
---

local UIOpinionBoxMailItem = BaseClass("UIOpinionBoxMailItem", UIBaseContainer)
local base = UIBaseContainer
local Localization = CS.GameEntry.Localization

local this_path = ""
local state_path = "State"
local desc_path = "Desc"
local red_path = "Red"

local ColorBrown = Color.New(0.7176471, 0.4, 0.1882353)
local ColorBlue = Color.New(0.3411765, 0.4078432, 0.5019608)

local function OnCreate(self)
    base.OnCreate(self)
    self:ComponentDefine()
    self:DataDefine()
end

local function OnDestroy(self)
    self:ComponentDestroy()
    self:DataDestroy()
    base.OnDestroy(self)
end

local function OnEnable(self)
    base.OnEnable(self)
end

local function OnDisable(self)
    base.OnDisable(self)
end

local function ComponentDefine(self)
    self.btn = self:AddComponent(UIButton, this_path)
    self.btn:SetOnClick(function()
        self:OnClick()
    end)
    self.state_text = self:AddComponent(UITextMeshProUGUIEx, state_path)
    self.desc_text = self:AddComponent(UITextMeshProUGUIEx, desc_path)
    self.red_go = self:AddComponent(UIBaseContainer, red_path)
end

local function ComponentDestroy(self)
    
end

local function DataDefine(self)
    self.data = nil
end

local function DataDestroy(self)

end

local function OnAddListener(self)
    base.OnAddListener(self)
end

local function OnRemoveListener(self)
    base.OnRemoveListener(self)
end

local function SetData(self, data)
    self.data = data
    self:Refresh()
end

local function Refresh(self)
    local name = GetTableData(TableName.VitaResident, self.data.residentId, "name")
    if self.data.choose == 0 then
        self.btn:LoadSprite(string.format(LoadPath.UIOpinion, "winter_letter_00"))
        self.state_text:SetText("")
        self.desc_text:SetColor(ColorBrown)
        self.desc_text:SetLocalText(137041, Localization:GetString(name))
        self.red_go:SetActive(true)
    else
        self.btn:LoadSprite(string.format(LoadPath.UIOpinion, "winter_letter_01"))
        self.state_text:SetLocalText(137040)
        self.desc_text:SetColor(ColorBlue)
        self.desc_text:SetLocalText(137042, Localization:GetString(name))
        self.red_go:SetActive(false)
    end
end

local function OnClick(self)
    self.view:OnMailClick(self.data)
end

UIOpinionBoxMailItem.OnCreate = OnCreate
UIOpinionBoxMailItem.OnDestroy = OnDestroy
UIOpinionBoxMailItem.OnEnable = OnEnable
UIOpinionBoxMailItem.OnDisable = OnDisable
UIOpinionBoxMailItem.ComponentDefine = ComponentDefine
UIOpinionBoxMailItem.ComponentDestroy = ComponentDestroy
UIOpinionBoxMailItem.DataDefine = DataDefine
UIOpinionBoxMailItem.DataDestroy = DataDestroy
UIOpinionBoxMailItem.OnAddListener = OnAddListener
UIOpinionBoxMailItem.OnRemoveListener = OnRemoveListener

UIOpinionBoxMailItem.SetData = SetData
UIOpinionBoxMailItem.Refresh = Refresh
UIOpinionBoxMailItem.OnClick = OnClick

return UIOpinionBoxMailItem