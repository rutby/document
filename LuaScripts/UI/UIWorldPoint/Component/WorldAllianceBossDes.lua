---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Imaginaerum.
--- DateTime: 2021/9/27 20:44
---

local WorldAllianceBossDes = BaseClass("WorldAllianceBossDes", UIBaseContainer)
local base = UIBaseContainer
local Localization = CS.GameEntry.Localization
local main_obj_path = "BuildInfo"
local boss_left_time_path = "BuildInfo/bossDes"
local boss_attack_num_path = "BuildInfo/Txt_BossAttackNum"
local simple_tip_1_path = "BuildInfo/staminaObj/simple_tip/ele_icon/simple_tip_1"
local animator_path = ""
local des_obj_path = "BuildDetails"
local des_txt_path = "BuildDetails/desTxt"
-- 创建
local function OnCreate(self)
    base.OnCreate(self)
    self:ComponentDefine()
    self:DataDefine()
end

-- 销毁
local function OnDestroy(self)
    self:ComponentDestroy()
    self:DataDestroy()
    base.OnDestroy(self)
end

-- 显示
local function OnEnable(self)
    base.OnEnable(self)
end

-- 隐藏
local function OnDisable(self)
    -- self:OnReturnClick()
    -- self:DeleteTimer()
    base.OnDisable(self)
end


--控件的定义
local function ComponentDefine(self)
    self.animator = self:AddComponent(UIAnimator, animator_path)
    self.main_obj = self:AddComponent(UIBaseContainer,main_obj_path)
    self.des_obj = self:AddComponent(UIBaseContainer,des_obj_path)
    self.main_obj_canvas = self:AddComponent(UICanvasGroup,main_obj_path)
    self.des_obj_canvas = self:AddComponent(UICanvasGroup,des_obj_path)
    self.main_obj_canvas:SetAlpha(1)
    self.des_obj_canvas:SetAlpha(1)
    self.des_txt = self:AddComponent(UITextMeshProUGUIEx,des_txt_path)
    
    self.time_txt = self:AddComponent(UITextMeshProUGUIEx,boss_left_time_path)
    self.simple_tip_1 = self:AddComponent(UITextMeshProUGUIEx,simple_tip_1_path)
    local cost = MarchUtil.GetCostStaminaByTargetType(MarchTargetType.ATTACK_ALLIANCE_BOSS)
    self.simple_tip_1:SetText(tostring(cost))
    
    self.boss_attack_num = self:AddComponent(UITextMeshProUGUIEx,boss_attack_num_path)
end

--控件的销毁
local function ComponentDestroy(self)
    self.time_txt = nil
    self.simple_tip_1 = nil
end

--变量的定义
local function DataDefine(self)
    self.data = nil
    -- self.timer_action = function(temp)
    --     self:RefreshTime()
    -- end
end

--变量的销毁
local function DataDestroy(self)
    self.data = nil

end

local function RefreshData(self,param)
    self.data = param
    if self.data.isSelfAlliance then
        self.time_txt:SetLocalText(373023)
    else
        self.time_txt:SetLocalText(373024)
    end
    self.des_txt:SetLocalText(373032)
    local attackItemId = LuaEntry.DataConfig:TryGetNum("alliance_boss", "k1")
    local itemCount = DataCenter.ItemData:GetItemCount(attackItemId)
    self.boss_attack_num:SetText(Localization:GetString("373031")..":"..itemCount)
end

-- local function DeleteTimer(self)
--     if self.timer ~= nil then
--         self.timer:Stop()
--         self.timer = nil
--     end
-- end

-- local function AddTimer(self)
--     if self.timer == nil then
--         self.timer = TimerManager:GetInstance():GetTimer(1, self.timer_action , self, false,false,false)
--     end

--     self.timer:Start()
-- end

-- local function RefreshTime(self)
--     if self.data == nil then
--         return
--     end
--     local curTime = UITimeManager:GetInstance():GetServerTime()
--     local deltaTime = self.data.refreshTime - curTime
--     if self.data~=nil and deltaTime>0 then
--         self.time_txt:SetText(UITimeManager:GetInstance():MilliSecondToFmtString(deltaTime))
--     else
--         self.time_txt:SetText("")
--     end
-- end

local function OnInfoClick(self)
    self.animator:Enable(true)
    self.animator:Play("switchEnter",0,0)
end
--返回
local function OnReturnClick(self)
    self.animator:Enable(true)
    self.animator:Play("switchOut",0,0)
end

WorldAllianceBossDes.OnCreate = OnCreate
WorldAllianceBossDes.OnDestroy = OnDestroy
WorldAllianceBossDes.OnEnable = OnEnable
WorldAllianceBossDes.OnDisable = OnDisable
WorldAllianceBossDes.ComponentDefine = ComponentDefine
WorldAllianceBossDes.ComponentDestroy = ComponentDestroy
WorldAllianceBossDes.DataDefine = DataDefine
WorldAllianceBossDes.DataDestroy = DataDestroy
WorldAllianceBossDes.RefreshData = RefreshData
WorldAllianceBossDes.OnReturnClick =OnReturnClick
WorldAllianceBossDes.OnInfoClick = OnInfoClick

return WorldAllianceBossDes