---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Imaginaerum.
--- DateTime: 2021/9/28 17:50
---
local WorldPointRewardItem = BaseClass("WorldPointRewardItem", UIBaseContainer)
local base = UIBaseContainer

local item_quality_path = "obj/clickBtn/ImgQuality"
local item_icon_path = "obj/clickBtn/ItemIcon"
local num_text_path = "obj/clickBtn/NumText"
local flag_text_path = "obj/clickBtn/FlagGo/FlagText"
local flag_obj_path = "obj/clickBtn/FlagGo"
local btn_path ="obj/clickBtn"
local imgExtra_path = "obj/clickBtn/ImgExtra"
local img_firstKill = "obj/clickBtn/Img_FirstKill"
-- 创建
local function OnCreate(self)
    base.OnCreate(self)
    self.item_quality = self:AddComponent(UIImage, item_quality_path)
    self.item_icon = self:AddComponent(UIImage, item_icon_path)
    self.imgExtra = self:AddComponent(UIImage,imgExtra_path)
    self.num_text = self:AddComponent(UITextMeshProUGUIEx, num_text_path)
    self.flag_text = self:AddComponent(UITextMeshProUGUIEx, flag_text_path)
    self.flag_obj = self:AddComponent(UIBaseContainer, flag_obj_path)
    self.btn = self:AddComponent(UIButton, btn_path)
    self.btn:SetOnClick(function()  
    SoundUtil.PlayEffect(SoundAssets.Music_Effect_Button)
        self:OnBtnClick()
    end)
    self.img_firstKill = self:AddComponent(UIImage,img_firstKill)
end

-- 销毁
local function OnDestroy(self)
    self.item_quality = nil
    self.item_icon = nil
    self.num_text = nil
    self.flag_text = nil
    self.btn = nil
    self.param = nil
    self.img_firstKill = nil
    base.OnDestroy(self)
end

-- 显示
local function OnEnable(self)
    base.OnEnable(self)
end

-- 隐藏
local function OnDisable(self)
    base.OnDisable(self)
end

-- 全部刷新
local function RefreshData(self,data,isUseFormatted)
    self.param = data
    self.num_text:SetActive(true)
    if isUseFormatted then
        self.num_text:SetText(string.GetFormattedStr(toInt(self.param.count)))
    else
        self.num_text:SetText(string.GetFormattedSeperatorNum(toInt(self.param.count)))
    end
    
    self.item_quality:LoadSprite(self.param.itemColor)
    if self.param.rewardType == RewardType.GOODS and self.param.itemFlag ~= nil then
        self.flag_obj:SetActive(true)
        self.flag_text:SetText(self.param.itemFlag)
    else
        self.flag_obj:SetActive(false)
    end
    self.imgExtra:SetActive(false)
    self.item_icon:LoadSprite(self.param.iconName)
    
    self.img_firstKill:SetActive(self.param.firstKill==true)
end


local function OnBtnClick(self)
    local param = {}
    param["itemName"] = self.param.itemName
    param["itemDesc"] = self.param.itemDesc
    param["alignObject"] = self.item_icon
    param.isLocal = self.param.isLocal
    UIManager:GetInstance():OpenWindow(UIWindowNames.UIItemTips,{anim = true}, param)
end


WorldPointRewardItem.OnCreate = OnCreate
WorldPointRewardItem.OnDestroy = OnDestroy
WorldPointRewardItem.OnBtnClick = OnBtnClick
WorldPointRewardItem.OnEnable = OnEnable
WorldPointRewardItem.OnDisable = OnDisable
WorldPointRewardItem.RefreshData = RefreshData

return WorldPointRewardItem