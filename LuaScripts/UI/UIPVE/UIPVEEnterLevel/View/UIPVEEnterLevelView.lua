---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by E.
--- DateTime: 2022/4/1 18:12
---


local UIPVEEnterLevelView = BaseClass("UIPVEEnterLevelView",UIBaseView)
local base = UIBaseView
local Localization = CS.GameEntry.Localization

local use_btn_path ="ImgBg/changeBtn"
local close_btn_path = "UICommonMiniPopUpTitle/Bg_mid/CloseBtn"
local input_path = "ImgBg/InputField"
local toggle_path = "ImgBg/Toggle"
local panel_path = "UICommonMiniPopUpTitle/panel"
local Setting = CS.GameEntry.Setting

local function OnCreate(self)
    base.OnCreate(self)

    self.input = self:AddComponent(UIInput,input_path)
    self.input:SetText("")

    self.close_btn = self:AddComponent(UIButton, close_btn_path)
    self.close_btn:SetOnClick(function()
        self.ctrl:CloseSelf()
    end)
    self.panelCloseBtn = self:AddComponent(UIButton, panel_path)
    self.panelCloseBtn:SetOnClick(function()
        self.ctrl:CloseSelf()
    end)

    self.use_btn = self:AddComponent(UIButton, use_btn_path)
    self.use_btn:SetOnClick(function()
        self:OnBtnClick()
    end)
    
    self.toggle = self:AddComponent(UIToggle, toggle_path)
end


local function OnDestroy(self)
    base.OnDestroy(self)
end

local function OnEnable(self)
    base.OnEnable(self)
    self.input:SetText(Setting:GetString("ENTER_PVE_TEST_LEVEL", ""))
    self.toggle:SetIsOn(Setting:GetString("ENTER_PVE_TEST_START", "1") == "1")
end

local function OnDisable(self)
    Setting:SetString("ENTER_PVE_TEST_LEVEL", self.input:GetText())
    Setting:SetString("ENTER_PVE_TEST_START", self.toggle:GetIsOn() and "1" or "0")
    base.OnDisable(self)
end

local function OnBtnClick(self)
    local text = self.input:GetText()
    if not string.IsNullOrEmpty(text) then
        self.ctrl:CloseSelf()
        UIManager:GetInstance():DestroyWindow(UIWindowNames.UISetting, { anim = true ,isBlur = true})
        UIManager:GetInstance():DestroyWindow(UIWindowNames.UIPlayerInfo)
        local param = {}
        param.pveId = tonumber(text)
        param.pveEntrance = PveEntrance.Test
        PveUtil.EnterPve(param)
    end
end

UIPVEEnterLevelView.OnCreate = OnCreate
UIPVEEnterLevelView.OnDestroy = OnDestroy
UIPVEEnterLevelView.OnEnable = OnEnable
UIPVEEnterLevelView.OnDisable = OnDisable

UIPVEEnterLevelView.OnBtnClick = OnBtnClick

return UIPVEEnterLevelView