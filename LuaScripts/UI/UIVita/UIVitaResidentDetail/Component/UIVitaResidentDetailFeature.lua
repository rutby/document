---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Beef.
--- DateTime: 2024/3/19 11:26
---

local UIVitaResidentDetailFeature = BaseClass("UIVitaResidentDetailFeature", UIBaseContainer)
local base = UIBaseContainer

local this_path = ""
local icon_path = "Icon"
local name_path = "Name"
local new_path = "New"
local effect_path = "Effect"

local function OnCreate(self)
    base.OnCreate(self)
    self:ComponentDefine()
    self:DataDefine()
end

local function OnDestroy(self)
    self:ComponentDestroy()
    self:DataDestroy()
    base.OnDestroy(self)
end

local function OnEnable(self)
    base.OnEnable(self)
end

local function OnDisable(self)
    base.OnDisable(self)
end

local function ComponentDefine(self)
    self.anim = self:AddComponent(UIAnimator, this_path)
    self.icon_btn = self:AddComponent(UIButton, icon_path)
    self.icon_btn:SetOnClick(function()
        self:OnClick()
    end)
    self.name_text = self:AddComponent(UITextMeshProUGUIEx, name_path)
    self.new_go = self:AddComponent(UIBaseContainer, new_path)
    self.effect_particle = self.transform:Find(effect_path):GetComponent(typeof(CS.UnityEngine.ParticleSystem))
end

local function ComponentDestroy(self)

end

local function DataDefine(self)
    self.onClick = nil
end

local function DataDestroy(self)

end

local function OnAddListener(self)
    base.OnAddListener(self)
end

local function OnRemoveListener(self)
    base.OnRemoveListener(self)
end

local function SetData(self, id, isNew)
    local icon = GetTableData(TableName.VitaResidentFeature, id, "talent_icon")
    local name = GetTableData(TableName.VitaResidentFeature, id, "talent_name")
    self.icon_btn:LoadSprite(string.format(LoadPath.UIFeature, icon))
    self.name_text:SetLocalText(name)
    if isNew then
        self.new_go:SetActive(true)
        self:ShowEffect(true)
        self.anim:Play("Eff_UIVitaResidentDetailFeature_Unlock", 0, 0)
    else
        self.new_go:SetActive(false)
        self:ShowEffect(false)
        self.anim:Play("Eff_UIVitaResidentDetailFeature_Idle", 0, 0)
    end
end

local function ShowEffect(self, show)
    if show then
        self.effect_particle:Play()
    else
        self.effect_particle:Stop()
    end
end

local function SetLock(self)
    self.icon_btn:LoadSprite(string.format(LoadPath.UIFeature, "feature_0"))
    self.name_text:SetLocalText(120050)
    self.new_go:SetActive(false)
end

local function SetOnClick(self, onClick)
    self.onClick = onClick
end

local function OnClick(self)
    if self.onClick then
        self.onClick()
    end
end

UIVitaResidentDetailFeature.OnCreate = OnCreate
UIVitaResidentDetailFeature.OnDestroy = OnDestroy
UIVitaResidentDetailFeature.OnEnable = OnEnable
UIVitaResidentDetailFeature.OnDisable = OnDisable
UIVitaResidentDetailFeature.ComponentDefine = ComponentDefine
UIVitaResidentDetailFeature.ComponentDestroy = ComponentDestroy
UIVitaResidentDetailFeature.DataDefine = DataDefine
UIVitaResidentDetailFeature.DataDestroy = DataDestroy
UIVitaResidentDetailFeature.OnAddListener = OnAddListener
UIVitaResidentDetailFeature.OnRemoveListener = OnRemoveListener

UIVitaResidentDetailFeature.SetData = SetData
UIVitaResidentDetailFeature.ShowEffect = ShowEffect
UIVitaResidentDetailFeature.SetLock = SetLock
UIVitaResidentDetailFeature.SetOnClick = SetOnClick
UIVitaResidentDetailFeature.OnClick = OnClick

return UIVitaResidentDetailFeature