 ---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Beef.
--- DateTime: 2023/11/6 10:23
---

local UIVitaResidentOverviewItem = BaseClass("UIVitaResidentOverviewItem", UIBaseContainer)
local base = UIBaseContainer
local UIHeroTipsView = require "UI.UIHeroTips.View.UIHeroTipsView"
local Localization = CS.GameEntry.Localization

local this_path = ""
local icon_path = "Icon"
local face_path = "Face"
local slider_path = "Slider"
local val_path = "Val"

local function OnCreate(self)
    base.OnCreate(self)
    self:ComponentDefine()
    self:DataDefine()
end

local function OnDestroy(self)
    self:ComponentDestroy()
    self:DataDestroy()
    base.OnDestroy(self)
end

local function OnEnable(self)
    base.OnEnable(self)
end

local function OnDisable(self)
    base.OnDisable(self)
end

local function ComponentDefine(self)
    self.btn = self:AddComponent(UIButton, this_path)
    self.btn:SetOnClick(function()
        self:OnClick()
    end)
    self.icon_image = self:AddComponent(UIImage, icon_path)
    self.face_image = self:AddComponent(UIImage, face_path)
    self.slider = self:AddComponent(UISlider, slider_path)
    self.val_text = self:AddComponent(UITextMeshProUGUIEx, val_path)
end

local function ComponentDestroy(self)
    
end

local function DataDefine(self)
    self.type = 0
end

local function DataDestroy(self)

end

local function OnAddListener(self)
    base.OnAddListener(self)
end

local function OnRemoveListener(self)
    base.OnRemoveListener(self)
end

local function SetType(self, type)
    self.type = type
end

local function SetValue(self, val)
    self.face_image:LoadSprite(VitaUtil.GetAttributeFaceIcon(val))
    self.slider:SetValue(val / VitaDefines.AttributeMax)
    self.val_text:SetText(string.format("%.2f", val))
    self.val_text:SetActive(CS.CommonUtils.IsDebug() and CS.SDKManager.IS_UNITY_EDITOR())
end

local function OnClick(self)
    local scaleFactor = UIManager:GetInstance():GetScaleFactor()
    local param = UIHeroTipsView.Param.New()
    param.title = Localization:GetString(VitaDefines.AttributeName[self.type])
    param.content = Localization:GetString(VitaDefines.AttributeDesc[self.type])
    param.dir = (self.type == 4 or self.type == 5) and UIHeroTipsView.Direction.LEFT or UIHeroTipsView.Direction.RIGHT
    param.defWidth = 300
    param.pivot = 0.5
    param.position = self.icon_image.transform.position
    param.bindObject = self.icon_image.gameObject
    UIManager:GetInstance():OpenWindow(UIWindowNames.UIHeroTips, { anim = false }, param)
end

UIVitaResidentOverviewItem.OnCreate = OnCreate
UIVitaResidentOverviewItem.OnDestroy = OnDestroy
UIVitaResidentOverviewItem.OnEnable = OnEnable
UIVitaResidentOverviewItem.OnDisable = OnDisable
UIVitaResidentOverviewItem.ComponentDefine = ComponentDefine
UIVitaResidentOverviewItem.ComponentDestroy = ComponentDestroy
UIVitaResidentOverviewItem.DataDefine = DataDefine
UIVitaResidentOverviewItem.DataDestroy = DataDestroy
UIVitaResidentOverviewItem.OnAddListener = OnAddListener
UIVitaResidentOverviewItem.OnRemoveListener = OnRemoveListener

UIVitaResidentOverviewItem.SetType = SetType
UIVitaResidentOverviewItem.SetValue = SetValue
UIVitaResidentOverviewItem.OnClick = OnClick

return UIVitaResidentOverviewItem