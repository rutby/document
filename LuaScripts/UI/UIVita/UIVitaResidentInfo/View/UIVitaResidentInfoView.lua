---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Beef.
--- DateTime: 2023/11/29 17:51
---

local UIVitaResidentInfo = BaseClass("UIVitaResidentInfo", UIBaseView)
local base = UIBaseView

local close_path = "Close"
local title_path = "Bg/Top/Title"
local subtitle_path = "Bg/Center/Subtitle"
local desc_path = "Bg/Center/Desc"
local power_path = "Bg/Bottom/Power"
local hunger_path = "Bg/Bottom/Hunger"
local sleep_path = "Bg/Bottom/Sleep"

local function OnCreate(self)
    base.OnCreate(self)
    self:ComponentDefine()
    self:DataDefine()
end

local function OnDestroy(self)
    self:DataDestroy()
    self:ComponentDestroy()
    base.OnDestroy(self)
end

local function OnEnable(self)
    base.OnEnable(self)
    self:ReInit()
end

local function OnDisable(self)
    base.OnDisable(self)
end

local function ComponentDefine(self)
    self.close_btn = self:AddComponent(UIButton, close_path)
    self.close_btn:SetOnClick(function()
        self.ctrl:CloseSelf()
    end)
    self.title_text = self:AddComponent(UITextMeshProUGUIEx, title_path)
    self.title_text:SetLocalText(441001)
    self.subtitle_text = self:AddComponent(UITextMeshProUGUIEx, subtitle_path)
    self.subtitle_text:SetLocalText(441002)
    self.desc_text = self:AddComponent(UITextMeshProUGUIEx, desc_path)
    self.desc_text:SetLocalText(441003)
    self.power_slider = self:AddComponent(UISlider, power_path)
    self.hunger_slider = self:AddComponent(UISlider, hunger_path)
    self.sleep_slider = self:AddComponent(UISlider, sleep_path)
end

local function ComponentDestroy(self)
    
end

local function DataDefine(self)
    self.timer = TimerManager:GetInstance():GetTimer(VitaDefines.RefreshInterval, self.TimerAction, self, false, false, false)
    self.timer:Start()
    self:TimerAction()
end

local function DataDestroy(self)
    if self.timer then
        self.timer:Stop()
        self.timer = nil
    end
end

local function OnAddListener(self)
    base.OnAddListener(self)
end

local function OnRemoveListener(self)
    base.OnRemoveListener(self)
end

local function ReInit(self)
    self:TimerAction()
end

local function TimerAction(self)
    local curTime = UITimeManager:GetInstance():GetServerTime()
    local data = DataCenter.VitaManager:GetUpdatedData(curTime)
    self.hunger_slider:SetValue(data.hunger / VitaDefines.AttributeMax)
    self.sleep_slider:SetValue(data.sleep / VitaDefines.AttributeMax)
end

UIVitaResidentInfo.OnCreate = OnCreate
UIVitaResidentInfo.OnDestroy = OnDestroy
UIVitaResidentInfo.OnEnable = OnEnable
UIVitaResidentInfo.OnDisable = OnDisable
UIVitaResidentInfo.ComponentDefine = ComponentDefine
UIVitaResidentInfo.ComponentDestroy = ComponentDestroy
UIVitaResidentInfo.DataDefine = DataDefine
UIVitaResidentInfo.DataDestroy = DataDestroy
UIVitaResidentInfo.OnAddListener = OnAddListener
UIVitaResidentInfo.OnRemoveListener = OnRemoveListener

UIVitaResidentInfo.ReInit = ReInit
UIVitaResidentInfo.TimerAction = TimerAction

return UIVitaResidentInfo