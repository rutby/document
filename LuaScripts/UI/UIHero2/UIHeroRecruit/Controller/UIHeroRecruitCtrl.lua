---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by zhangliheng.
--- DateTime: 7/7/21 6:58 PM
---



local UIHeroRecruitCtrl = BaseClass("UIHeroRecruitCtrl", UIBaseCtrl)



local function CloseSelf(self)
    UIManager:GetInstance():DestroyWindow(UIWindowNames.UIHeroRecruit)
end

local function OnClickGoldBtn(self)
    local param = {}
    CS.UIPreAdd.OpenGiftPackage(param)
end

local function GetSortedLotteryList(self)
    local dict = DataCenter.LotteryDataManager:GetAllShowLotteryDict()
    local list = table.values(dict)
    table.sort(list, function(a, b)
        if a.order ~= b.order then
            return a.order > b.order
        end
        
        return tonumber(a.id)  < tonumber(b.id)
    end)
    
    return list
end

local function GetNewLotteryList(self)
    local dict = DataCenter.LotteryDataManager:GetAllShowLotteryDict()
    local list = table.values(dict)
    
    table.sort(list, function(a, b)
        if a == nil or b == nil then
            return false
        end
        local isOpenA = a:IsOpen()
        local isOpenB = b:IsOpen()
        if isOpenA ~= isOpenB then
            return isOpenA
        end
        if isOpenA then
            if a.order ~= b.order then
                return a.order < b.order
            end
        else
            if a.startTime ~= b.startTime then
                return a.startTime < b.startTime
            end
        end
        if tonumber(a.id)  ~= tonumber(b.id) then
            return tonumber(a.id)  < tonumber(b.id)
        end
        return false
    end)

    return list
end

local function GePackageInfo(self, itemId)
    local package = GiftPackageData.GetGivenPacks(itemId)
    if package and #package > 0 then
        return package[1]
    end
end

local function BuyGift(self,info)
    DataCenter.PayManager:CallPayment(info, UIWindowNames.UIResourceBag)
end

local function GetDataFromServer(self)
    SFSNetwork.SendMessage(MsgDefines.GetHeroLotteryInfo)
end

local function IsNotNormal(self, data)
    if data == nil then
        return false
    end
    return data.display_type ~= LotteryDisPlayType.LotteryDisPlayType_Normal_And_Expert
end

local function GetTextColor(self, data)
    if data.id == "221523" or data.id == "221524" then
        return Color.New(96/255, 210/255, 200/255, 1)
    end
    return Color.New(252/255, 214/255, 81/255, 1)
end

local function GetTextShadowColor(self, data)
    if data.id == "221523" or data.id == "221524" then
        return Color.New(26/255, 96/255, 122/255, 1)
    end
    return Color.New(46/255, 47/255, 68/255, 1)
end

UIHeroRecruitCtrl.CloseSelf = CloseSelf
UIHeroRecruitCtrl.OnClickGoldBtn = OnClickGoldBtn
UIHeroRecruitCtrl.GetSortedLotteryList = GetSortedLotteryList
UIHeroRecruitCtrl.GetNewLotteryList = GetNewLotteryList
UIHeroRecruitCtrl.GePackageInfo = GePackageInfo
UIHeroRecruitCtrl.BuyGift = BuyGift
UIHeroRecruitCtrl.GetDataFromServer = GetDataFromServer
UIHeroRecruitCtrl.IsNotNormal = IsNotNormal
UIHeroRecruitCtrl.GetTextColor = GetTextColor
UIHeroRecruitCtrl.GetTextShadowColor = GetTextShadowColor

return UIHeroRecruitCtrl