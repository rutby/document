---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by zhangliheng.
--- DateTime: 7/9/21 11:13 AM
---



local UITopItem = BaseClass("UITopItem", UIBaseContainer)
local base = UIBaseContainer

local function OnCreate(self)
    base.OnCreate(self)
    self:ComponentDefine()
    self:DataDefine()
end

local function OnDestroy(self)
    self:ComponentDestroy()
    self:DataDestroy()
    base.OnDestroy(self)
end

local function ComponentDefine(self)
    self:AddComponent(UIButton, ""):SetOnClick(BindCallback(self, self.OnBtnClick))
    self.imgIcon    = self:AddComponent(UIImage, "root/resourceIcon")
    self.textNum   = self:AddComponent(UITextMeshProUGUIEx, "root/resourceNum")
end

local function ComponentDestroy(self)
    self.imgIcon   = nil
    self.textNum    = nil
end

local function DataDefine(self)
end

local function DataDestroy(self)
end

local function SetData(self, itemId, resourceType, callBack)
    self.itemId = itemId
    self.resourceType = resourceType
    self.callBack = callBack

    local iconPath = self:GetIconName()
    self.imgIcon:LoadSprite(iconPath)
    local resNum = self:GetCurNum()
    self.textNum:SetText(string.GetFormattedSeperatorNum(resNum))
end

local function SetOnClick(self, onClick)
    self.onClick = onClick
end

local function OnBtnClick(self)
    if self.onClick then
        self.onClick()
    end
end

--获取当前道具的图标
local function GetIconName(self)
    if self.itemId ~= nil then
        return DataCenter.ItemTemplateManager:GetIconPath(self.itemId)
    elseif self.resourceType ~= nil then
        return DataCenter.ResourceManager:GetResourceIconByType(self.resourceType)
    end
    return ""
end

--获取当前道具的数量
local function GetCurNum(self)
    if self.itemId ~= nil then
        return DataCenter.ItemData:GetItemCount(self.itemId)
    elseif self.resourceType ~= nil then
        return LuaEntry.Resource:GetCntByResType(self.resourceType)
    end
    return 0
end

UITopItem.OnCreate = OnCreate
UITopItem.OnDestroy = OnDestroy
UITopItem.ComponentDefine = ComponentDefine
UITopItem.ComponentDestroy = ComponentDestroy
UITopItem.DataDefine = DataDefine
UITopItem.DataDestroy = DataDestroy
UITopItem.SetData = SetData
UITopItem.SetOnClick = SetOnClick
UITopItem.OnBtnClick = OnBtnClick
UITopItem.GetIconName = GetIconName
UITopItem.GetCurNum = GetCurNum


return UITopItem
