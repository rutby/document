---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by 1.
--- DateTime: 2023/2/1 17:24
---


local UIHeroAdvanceIntroCtrl = BaseClass("UIHeroAdvanceIntroCtrl", UIBaseCtrl)
local AdvanceReqData = require 'DataCenter.HeroData.AdvanceReqData'

local function CloseSelf(self)
    UIManager:GetInstance():DestroyWindow(UIWindowNames.UIHeroAdvanceIntro)
end

local function GetPanelData(self, heroId)
    local rarity = GetTableData(HeroUtils.GetHeroXmlName(), heroId, 'rarity')
    local camp = GetTableData(HeroUtils.GetHeroXmlName(), heroId, 'camp')
    local advanceType = tonumber(GetTableData(HeroUtils.GetHeroXmlName(), heroId, 'advanc_type'))

    local maxQuality = HeroUtils.GetMaxStarByRarity(rarity)
    local result = {}
    for i = 1, maxQuality - 1 do
        local advanceReq = AdvanceReqData.New(i + advanceType)
        local param = {}
        param.heroId = heroId
        param.quality = i
        local types = {}
        local sameHeroQuality, sameHeroNum = advanceReq:GetConditionByType(HeroAdvanceConsumeType.ConsumeType_Same_Hero)
        local sameCampQuality, sameCampNum = advanceReq:GetConditionByType(HeroAdvanceConsumeType.ConsumeType_Same_Camp)
        sameHeroNum = sameHeroNum or 0
        sameCampNum = sameCampNum or 0
        for j = 1, sameHeroNum do
            local type = {}
            type.type = HeroAdvanceConsumeType.ConsumeType_Same_Hero
            type.heroId = heroId
            type.quality = sameHeroQuality
            table.insert(types, type)
        end

        for j = 1, sameCampNum do
            local type = {}
            type.type = HeroAdvanceConsumeType.ConsumeType_Same_Camp
            type.quality = sameCampQuality
            type.camp = camp
            table.insert(types, type)
        end

        param.requireTypes = types
        table.insert(result, param)
    end
    return result
end

UIHeroAdvanceIntroCtrl.CloseSelf = CloseSelf
UIHeroAdvanceIntroCtrl.GetPanelData = GetPanelData

return UIHeroAdvanceIntroCtrl