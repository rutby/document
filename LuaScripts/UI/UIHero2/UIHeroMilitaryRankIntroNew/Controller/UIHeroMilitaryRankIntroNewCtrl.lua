---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by 1.
--- DateTime: 2023/2/1 21:43
---


local UIHeroMilitaryRankIntroNewCtrl = BaseClass("UIHeroMilitaryRankIntroNewCtrl", UIBaseCtrl)


local function CloseSelf(self)
    UIManager:GetInstance():DestroyWindow(UIWindowNames.UIHeroMilitaryRankIntroNew)
end

local function GetShowData(self, heroId, curRank)
    local heroConfig = LocalController:instance():getLine(HeroUtils.GetHeroXmlName(), heroId)
    local result = {}
    result.quality = heroConfig.quality
    result.rarity = heroConfig.rarity
    result.heroId = heroConfig.heroId
    result.currentMilitaryRankId = curRank
    local level = GetTableData(TableName.HeroMilitaryRank, result.currentMilitaryRankId, 'level')
    if level == "" then
        level = level
    end
    result.currentMilitaryRankLv = level
    result.maxMilitaryRankId = heroConfig['max_rank_level']
    local rankList = {}
    local rank = 1

    while rank <= result.maxMilitaryRankId do
        local level = GetTableData(TableName.HeroMilitaryRank, rank, 'level')
        local stage = GetTableData(TableName.HeroMilitaryRank, rank, 'stage')
        if level == ""  then
            break
        end
        if stage == 1 then
            if level > 0 then
                local tmp = {}
                tmp.rankId = rank
                tmp.rarity = result.rarity
                tmp.curRank = result.currentMilitaryRankId
                tmp.maxRank = result.maxMilitaryRankId
                table.insert(rankList, tmp)
            end
        end
        rank = rank + 1
    end
    result.rankList = rankList

    local skillArray = heroConfig['skill']
    if type(skillArray) ~= 'table' then
        skillArray = string.split(skillArray, '|')
    end
    result.skillList = skillArray
    return result
end

UIHeroMilitaryRankIntroNewCtrl.CloseSelf = CloseSelf
UIHeroMilitaryRankIntroNewCtrl.GetShowData = GetShowData

return UIHeroMilitaryRankIntroNewCtrl