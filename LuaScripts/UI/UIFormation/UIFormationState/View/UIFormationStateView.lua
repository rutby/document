---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Imaginaerum.
--- DateTime: 2021/7/27 11:48
---
local FormationCamp = require "UI.UIFormation.UIFormationState.Component.FormationCamp"
local UIFormationStateView = BaseClass("UIFormationStateView",UIBaseView)
local base = UIBaseView
local return_btn_path = "Panel"
local des_txt_path = "tips/bg/desTxt"
local empty_txt_path = "tips/bg/emptyTxt"
local camp_1_path = "tips/bg/layout/FormationCamp1"
local camp_2_path = "tips/bg/layout/FormationCamp2"
local tips_obj_path = "tips"
local Localization = CS.GameEntry.Localization
local function OnCreate(self)
    base.OnCreate(self)
    local campDataList,posX,posY = self:GetUserData()
    self.campDataList = campDataList
    self.posX = tonumber(posX)
    self.posY = tonumber(posY)
    self.tips = self:AddComponent(UIBaseContainer, tips_obj_path)
    local v3 = self.tips.transform.position
    v3.x = self.posX
    v3.y = self.posY
    self.tips.transform.position = v3
    self.des_txt = self:AddComponent(UITextMeshProUGUIEx, des_txt_path)
    self.des_txt:SetLocalText(133046)
    self.empty_txt = self:AddComponent(UITextMeshProUGUIEx, empty_txt_path)
    self.empty_txt:SetLocalText(150219)
    self.return_btn = self:AddComponent(UIButton, return_btn_path)
    self.return_btn:SetOnClick(function()  
        self.ctrl:CloseSelf()
    end)
    self.campList = {}
    self.campList[1] = self:AddComponent(FormationCamp, camp_1_path)
    self.campList[2] = self:AddComponent(FormationCamp, camp_2_path)
    if #self.campDataList>0 then
        self.empty_txt:SetActive(false)
        self.campList[1]:SetActive(#self.campDataList>=1)
        self.campList[2]:SetActive(#self.campDataList>=2)
    else
        self.campList[1]:SetActive(false)
        self.campList[2]:SetActive(false)
        self.empty_txt:SetActive(true)
    end
    
end

local function OnDestroy(self)
    base.OnDestroy(self)
end


local function OnEnable(self)
    base.OnEnable(self)
    self:RefreshData()
end

local function OnDisable(self)
    base.OnDisable(self)
end

local function RefreshData(self)
    if #self.campDataList>=1 then
        self.campList[1]:RefreshData(1,self.campDataList[1])
        if #self.campDataList>=2 then
            self.campList[2]:RefreshData(2,self.campDataList[2])
        end
    end
    --table.walk(self.campList,function(k,v)
    --    v:RefreshData(k,self.campNum)
    --end)
end

UIFormationStateView.OnCreate= OnCreate
UIFormationStateView.OnDestroy = OnDestroy
UIFormationStateView.RefreshData = RefreshData
UIFormationStateView.OnEnable= OnEnable
UIFormationStateView.OnDisable = OnDisable
return UIFormationStateView