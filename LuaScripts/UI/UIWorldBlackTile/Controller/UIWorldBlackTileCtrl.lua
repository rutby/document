---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by shimin.
--- DateTime: 2021/7/29 
---
local UIWorldBlackTileCtrl = BaseClass("UIWorldBlackTileCtrl", UIBaseCtrl)
function UIWorldBlackTileCtrl:CloseSelf(isNoDoAnim)
    if isNoDoAnim then
        UIManager:GetInstance():DestroyWindow(UIWindowNames.UIWorldBlackTile,{anim = true})
    else
        UIManager:GetInstance():DestroyWindow(UIWindowNames.UIWorldBlackTile)
    end
end

function UIWorldBlackTileCtrl:Close()
    UIManager:GetInstance():DestroyWindowByLayer(UILayer.Normal)
end

function UIWorldBlackTileCtrl:GetBlackData(pointId)
    
end

--行军
function UIWorldBlackTileCtrl:OnAttackClick(point)
    MarchUtil.OnClickStartMarch(MarchTargetType.STATE, point)
    self:CloseSelf(true)
end
--迁城
function UIWorldBlackTileCtrl:OnMoveCityClick(pointId)
    --local allianceId = LuaEntry.Player.allianceId
    --local selfMarch = CS.SceneManager.World:GetOwnerMarches(LuaEntry.Player.uid, allianceId)
    local selfMarchCount = UIUtil.GetSelfMarchCountExceptGolloes()
    --if selfMarch ~= nil and selfMarch.Count > 0 then
    if selfMarchCount > 0 then
        UIUtil.ShowMessage(CS.GameEntry.Localization:GetString(GameDialogDefine.PLEASE_BACK_MARCH), 2, GameDialogDefine.CONFIRM, GameDialogDefine.CANCEL, function()        end, function() end)
        self:CloseSelf(false)
    else
        --打开迁城界面
        UIUtil.TryMoveCity(PlaceBuildType.MoveCity, pointId)
        self:CloseSelf(true)
    end
end
--指挥官信息
function UIWorldBlackTileCtrl:OnPlayerDetailClick(uid)
    UIManager:GetInstance():OpenWindow(UIWindowNames.UIOtherPlayerInfo,{ anim = true, hideTop = true},uid)
end
--分享
function UIWorldBlackTileCtrl:OnShareClick(server,point,oname)
    local share_param = {}
    share_param.sid = server
    share_param.worldId = LuaEntry.Player:GetCurWorldId()
    share_param.pos = point
    share_param.oname = oname
    UIManager:GetInstance():OpenWindow(UIWindowNames.UIPositionShare, {anim = true}, share_param)
    self:CloseSelf(true)
end
--收藏
function UIWorldBlackTileCtrl:OnMarkClick(server,point,oname,olv)
    local share_param = {}
    share_param.sid = server
    share_param.worldId = LuaEntry.Player:GetCurWorldId()
    share_param.pos = point
    share_param.oname = oname
    share_param.olv = olv
    UIManager:GetInstance():OpenWindow(UIWindowNames.UIPositionAdd,{anim = true},share_param)
    self:CloseSelf(true)
end

return UIWorldBlackTileCtrl