---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Beef.
--- DateTime: 2023/3/8 20:56
---

local UIMasteryLine = BaseClass("UIMasteryLine", UIBaseContainer)
local base = UIBaseContainer

local this_path = ""

local function OnCreate(self)
    base.OnCreate(self)
    self:DataDefine()
    self:ComponentDefine()
end

local function OnDestroy(self)
    self:ComponentDestroy()
    self:DataDestroy()
    base.OnDestroy(self)
end

local function ComponentDefine(self)
    self.image = self:AddComponent(UIImage, this_path)
end

local function ComponentDestroy(self)
    self.image = nil
end

local function DataDefine(self)
    self.groupA = 0
    self.groupB = 0
    self.state = MasteryNodeState.Hide
end

local function DataDestroy(self)
    self.groupA = nil
    self.groupB = nil
    self.state = nil
end

local function OnEnable(self)
    base.OnEnable(self)
end

local function OnDisable(self)
    base.OnDisable(self)
end

local function OnAddListener(self)
    base.OnAddListener(self)
end

local function OnRemoveListener(self)
    base.OnRemoveListener(self)
end

local function SetData(self, groupA, groupB)
    self.groupA = groupA
    self.groupB = groupB
    self:Refresh()
end

local function Refresh(self)
    local plan = DataCenter.MasteryManager:GetCurPlan()
    local levelA = plan:GetGroupLevel(self.groupA)
    local levelB = plan:GetGroupLevel(self.groupB)
    local templateA = DataCenter.MasteryManager:GetTemplate(self.groupA)
    local templateB = DataCenter.MasteryManager:GetTemplate(self.groupB)
    local alight = (levelA > 0 and table.hasvalue(templateB.priors, self.groupA))
                or (levelB > 0 and table.hasvalue(templateA.priors, self.groupB))
    local icon = LoadPath.UIMastery .. "UImaster_line_" .. (alight and templateA.tempData:getValue("home") or "bg")
    self.image:LoadSprite(icon)
end

UIMasteryLine.OnCreate = OnCreate
UIMasteryLine.OnDestroy = OnDestroy
UIMasteryLine.ComponentDefine = ComponentDefine
UIMasteryLine.ComponentDestroy = ComponentDestroy
UIMasteryLine.DataDefine = DataDefine
UIMasteryLine.DataDestroy = DataDestroy
UIMasteryLine.OnEnable = OnEnable
UIMasteryLine.OnDisable = OnDisable
UIMasteryLine.OnAddListener = OnAddListener
UIMasteryLine.OnRemoveListener = OnRemoveListener

UIMasteryLine.SetData = SetData
UIMasteryLine.Refresh = Refresh

return UIMasteryLine