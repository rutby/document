---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Imaginaerum.
--- DateTime: 2022/4/22 19:02
---
local UIPuzzleMonsterListCtrl = BaseClass("UIPuzzleMonsterListCtrl", UIBaseCtrl)

function UIPuzzleMonsterListCtrl:CloseSelf()
    UIManager.Instance:DestroyWindow(UIWindowNames.UIPuzzleMonsterList)
end

function UIPuzzleMonsterListCtrl:GetMarchInfoList(puzzleType)
    local showList = {}
    local dataList = nil
    if puzzleType == PuzzleMonsterType.Activity then
        dataList = DataCenter.ActivityPuzzleDataManager:GetPuzzleMarches()
    elseif puzzleType == PuzzleMonsterType.Radar then
        dataList = DataCenter.RadarBossManager:GetPuzzleMarches()
    end
    if dataList == nil then
        return showList
    end
    for k,v in pairs(dataList) do
        local oneData = {}
        oneData.uuid = v.uuid
        oneData.monsterId = v.monsterId
        oneData.actStartTime = v.actStartTime
        oneData.actEndTime = v.actEndTime
        oneData.armyUnit = v.armyUnit
        oneData.armyHealth = v.armyHealth
        oneData.armyInitHealth =v.armyInitHealth
        oneData.startPos = v.startPos
        oneData.distance = 0
        oneData.ownerName = v.ownerName
        oneData.allianceAbbr = v.allianceAbbr
        local distance = math.ceil(SceneUtils.TileDistance(SceneUtils.IndexToTilePos(oneData.startPos,ForceChangeScene.World), SceneUtils.IndexToTilePos(LuaEntry.Player:GetMainWorldPos(),ForceChangeScene.World)))
        oneData.distance = math.max(0,distance)
        table.insert(showList,oneData)
    end
    table.sort(showList, function(a,b)
        if a.distance < b.distance then
            return true
        end
        return false
    end)
    return showList
end

return UIPuzzleMonsterListCtrl