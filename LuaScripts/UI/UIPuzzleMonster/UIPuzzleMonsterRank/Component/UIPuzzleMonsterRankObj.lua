---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Imaginaerum.
--- DateTime: 2022/4/24 12:02
---
local UIPuzzleMonsterRankItem = require "UI.UIPuzzleMonster.UIPuzzleMonsterRank.Component.UIPuzzleMonsterRankItem"
local UIPuzzleMonsterRankObj = BaseClass("UIPuzzleMonsterRankObj",UIBaseContainer)
local base = UIBaseContainer
local Localization = CS.GameEntry.Localization
local playerRank = "playerRank"
local select_obj_path = "select"
local name_txt_path = "select/nameTxt"
local score_txt_path = "select/scoreTxt"
local army_txt_path = "select/armyTxt"
local scroll_path = "ScrollView"
local empty_txt_path = "TxtEmpty"
local function OnCreate(self)
    base.OnCreate(self)
    self.select_obj = self:AddComponent(UIBaseContainer, select_obj_path)
    self.player_rank = self:AddComponent(UIPuzzleMonsterRankItem, playerRank)
    self.name_txt = self:AddComponent(UIText, name_txt_path)
    self.name_txt:SetLocalText(100184)
    self.score_txt = self:AddComponent(UIText, score_txt_path)
    self.score_txt:SetLocalText(302180)
    self.army_txt = self:AddComponent(UIText, army_txt_path)
    self.army_txt:SetLocalText(310141)
    self.ScrollView = self:AddComponent(UIScrollView, scroll_path)
    self.ScrollView:SetOnItemMoveIn(function(itemObj, index)
        self:OnItemMoveIn(itemObj, index)
    end)
    self.ScrollView:SetOnItemMoveOut(function(itemObj, index)
        self:OnItemMoveOut(itemObj, index)
    end)
    self.showDatalist ={}
    self.empty_txt = self:AddComponent(UIText, empty_txt_path)
end

local function OnDestroy(self)
    self.player_rank =nil
    self.name_txt = nil
    self.score_txt = nil
    self.army_txt = nil
    self.ScrollView = nil
    self.showDatalist =nil
    self.empty_txt = nil
    base.OnDestroy(self)
end

local function OnEnable(self)
    base.OnEnable(self)
end

local function OnDisable(self)
    base.OnDisable(self)
end

local function ClearScroll(self)
    self.ScrollView:ClearCells()
    self.ScrollView:RemoveComponents(UIPuzzleMonsterRankItem)
    self.showDatalist = {}
end

local function RefreshData(self,uuid, puzzleType)
    self:ClearScroll()
    local data = self.view.ctrl:GetBossRankData(uuid, puzzleType)
    if data.selfRankData~=nil then
        self.player_rank:SetActive(true)
        self.player_rank:SetSelfRankData(data.selfRankData)
    else
        self.player_rank:SetActive(false)
    end
    self.showDatalist = data.rankList
    if self.showDatalist~=nil and  #self.showDatalist > 0 then
        self.select_obj:SetActive(true)
        self.ScrollView:SetTotalCount(#self.showDatalist)
        self.ScrollView:RefillCells()
        self.empty_txt:SetActive(false)
    else
        self.player_rank:SetActive(false)
        self.select_obj:SetActive(false)
        self.empty_txt:SetLocalText(302187)
        self.empty_txt:SetActive(true)
    end
end

local function OnItemMoveIn(self,itemObj, index)
    itemObj.name = tostring(index)
    local cellItem = self.ScrollView:AddComponent(UIPuzzleMonsterRankItem, itemObj)
    cellItem:SetItemShow(self.showDatalist[index])
end

local function OnItemMoveOut(self, itemObj, index)
    self.ScrollView:RemoveComponent(itemObj.name, UIPuzzleMonsterRankItem)
end

UIPuzzleMonsterRankObj.OnCreate = OnCreate
UIPuzzleMonsterRankObj.OnDestroy = OnDestroy
UIPuzzleMonsterRankObj.RefreshData = RefreshData
UIPuzzleMonsterRankObj.OnEnable = OnEnable
UIPuzzleMonsterRankObj.OnDisable = OnDisable
UIPuzzleMonsterRankObj.ClearScroll =ClearScroll
UIPuzzleMonsterRankObj.OnItemMoveOut =OnItemMoveOut
UIPuzzleMonsterRankObj.OnItemMoveIn =OnItemMoveIn
return UIPuzzleMonsterRankObj