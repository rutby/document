---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by guqu.
--- DateTime: 2020/11/11 18:04
---
local UIAllianceApplyListCtrl = BaseClass("UIAllianceApplyListCtrl", UIBaseCtrl)

local function CloseSelf(self)
    UIManager:GetInstance():DestroyWindow(UIWindowNames.UIAllianceApplyList)
end

local function Close(self)
    UIManager:GetInstance():DestroyWindowByLayer(UILayer.Normal)
end

local function GetAllianceApplyList(self)
    local showList ={}
    local data = DataCenter.AllianceMemberDataManager:GetApplyMemberList()
    if data~=nil then
        table.walk(data,function (k,v)
            local oneData ={}
            oneData.uid = v.uid
            oneData.name = v.name
            oneData.power = v.power
            oneData.kill = v.armyKill
            oneData.pic = v.pic
            oneData.picVer = v.picVer
            oneData.headBg = v:GetHeadBgImg()
            table.insert(showList,oneData)
        end)
    end
    return showList
end

local function OnPlayerDetailClick(self,uid)
    UIManager:GetInstance():OpenWindow(UIWindowNames.UIOtherPlayerInfo,{ anim = true, hideTop = true},uid)
end

local function OnAcceptClick(self,uid)
    if not DataCenter.AllianceBaseDataManager:IsR4orR5() then
        UIUtil.ShowTipsId(120173)
        return
    end
    SFSNetwork.SendMessage(MsgDefines.AcceptAllianceApply,uid)
end
local function OnRefuseClick(self,uid)
    if not DataCenter.AllianceBaseDataManager:IsR4orR5() then
        UIUtil.ShowTipsId(120173)
        return
    end
    SFSNetwork.SendMessage(MsgDefines.RefuseAllianceApply,uid)
end


UIAllianceApplyListCtrl.CloseSelf = CloseSelf
UIAllianceApplyListCtrl.Close = Close
UIAllianceApplyListCtrl.OnPlayerDetailClick = OnPlayerDetailClick
UIAllianceApplyListCtrl.GetAllianceApplyList =GetAllianceApplyList
UIAllianceApplyListCtrl.OnAcceptClick =OnAcceptClick
UIAllianceApplyListCtrl.OnRefuseClick =OnRefuseClick
return UIAllianceApplyListCtrl