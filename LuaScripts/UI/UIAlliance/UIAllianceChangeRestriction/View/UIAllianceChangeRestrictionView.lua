---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Imaginaerum.
--- DateTime: 2021/6/9 18:48
---
local UIAllianceChangeRestrictionView = BaseClass("UIAllianceChangeRestrictionView",UIBaseView)
local base = UIBaseView
local Localization = CS.GameEntry.Localization

local title_path = "UICommonMiniPopUpTitle/Bg_mid/titleText"
local level_input_path = "ImgBg/levelObj/levelInputField"
local level_des_txt_path = "ImgBg/levelObj/levelDesText"
local power_input_path = "ImgBg/powerObj/powerInputField"
local power_des_txt_path = "ImgBg/powerObj/powerDesText"
local return_btn_path = "UICommonMiniPopUpTitle/panel"
local close_btn_path = "UICommonMiniPopUpTitle/Bg_mid/CloseBtn"
local use_txt_path = "ImgBg/Button/useText"
local use_btn_path ="ImgBg/Button"
local function OnCreate(self)
    base.OnCreate(self)
    local level,power = self:GetUserData()
    self.levelRestriction = tonumber(level)
    self.powerRestriction = tonumber(power)
    self.title = self:AddComponent(UITextMeshProUGUIEx,title_path)
    self.title:SetLocalText(390095) 
    self.use_txt = self:AddComponent(UIText,use_txt_path)
    self.use_txt:SetLocalText(GameDialogDefine.CONFIRM) 
    self.use_btn = self:AddComponent(UIButton, use_btn_path)
    self.use_btn:SetOnClick(function()  
SoundUtil.PlayEffect(SoundAssets.Music_Effect_Button)
        self:OnChangeRestrictionClick()
    end)
    self.power_des_txt = self:AddComponent(UIText,power_des_txt_path)
    self.level_des_txt = self:AddComponent(UIText,level_des_txt_path)
    self.power_des_txt:SetLocalText(100644) 
    self.level_des_txt:SetLocalText(100082) 
    self.level_input = self:AddComponent(UIInput,level_input_path)
    self.level_input:SetOnValueChange(function (value)
        self:levelIptOnValueChange(value)
    end)
    self.power_input = self:AddComponent(UIInput,power_input_path)
    self.power_input:SetOnValueChange(function (value)
        self:powerIptOnValueChange(value)
    end)
    self.close_btn = self:AddComponent(UIButton, close_btn_path)
    self.close_btn:SetOnClick(function()
        self.ctrl:CloseSelf()
    end)
    self.return_btn = self:AddComponent(UIButton, return_btn_path)
    self.return_btn:SetOnClick(function()
        self.ctrl:CloseSelf()
    end)
    self.levelInputValue = self.levelRestriction
    self.powerInputValue = self.powerRestriction
    self.level_input:SetText(self.levelInputValue)
    self.power_input:SetText(self.powerInputValue)
end

local function OnDestroy(self)
    self.title = nil
    self.use_txt = nil
    self.use_btn = nil
    self.input = nil
    self.close_btn = nil
    self.return_btn = nil
    self.inputValue = nil
    base.OnDestroy(self)
end

local function OnEnable(self)
    base.OnEnable(self)
end

local function OnDisable(self)
    base.OnDisable(self)
end

local function levelIptOnValueChange(self,value)
    if value~=nil and value~="" then
        local num  = tonumber(value)
        if num<1 then
            self.level_input:SetText(1)
        elseif num>25 then
            self.level_input:SetText(25)
        else
            self.levelInputValue = num
        end
    else
        self.level_input:SetText(1)
    end
end

local function powerIptOnValueChange(self,value)
    if value~=nil and value~="" then
        local num  = tonumber(value)
        if num<0 then
            self.power_input:SetText(0)
        else
            self.powerInputValue = num
        end
    else
        self.power_input:SetText(0)
    end
    
end

local function OnChangeRestrictionClick(self)
    self.ctrl:OnChangeRestrictionClick(self.levelInputValue,self.powerInputValue)
end

UIAllianceChangeRestrictionView.OnCreate = OnCreate
UIAllianceChangeRestrictionView.OnDestroy = OnDestroy
UIAllianceChangeRestrictionView.OnEnable = OnEnable
UIAllianceChangeRestrictionView.OnDisable = OnDisable
UIAllianceChangeRestrictionView.levelIptOnValueChange = levelIptOnValueChange
UIAllianceChangeRestrictionView.powerIptOnValueChange = powerIptOnValueChange
UIAllianceChangeRestrictionView.OnChangeRestrictionClick = OnChangeRestrictionClick

return UIAllianceChangeRestrictionView