---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by 1.
--- DateTime: 2021/9/15 16:38
---

local base = UIBaseView--Variable
local UIAllianceSelectRoleView = BaseClass("UIAllianceSelectRoleView", base)--Variable
local Localization = CS.GameEntry.Localization

local title_path = "ImgBg/desBg/desText"
local btn_path = "ImgBg/btns/btn"
local closeBtn_path = "CloseBtn"
local goldRewardNum_path = "ImgBg/btns/btn2/getGold"
local goldRewardTxt_path = "ImgBg/btns/btn2/getGold/getGoldTxt"

local RoleBtnType = {
    Leader = 1,
    Member = 2,
}

local function OnCreate(self)
    base.OnCreate(self)
    self:ComponentDefine()
    self:DataDefine()
    --SFSNetwork.SendMessage(MsgDefines.AlBeLeaderCheck)
    self:RefreshAll()
end

local function OnDestroy(self)
    self:ComponentDestroy()
    self:DataDestroy()
    base.OnDestroy(self)
end

local function ComponentDefine(self)
    self.titleN = self:AddComponent(UIText, title_path)
    self.titleN:SetLocalText(141103)
    self.btnsTb = {}
    for i = 1, 2 do
        local role = {}
        local temp = self:AddComponent(UIBaseContainer, btn_path .. i)
        role.titleN = temp:AddComponent(UIText, "roleName")
        role.descN = temp:AddComponent(UIText, "desc")
        role.btnN = temp:AddComponent(UIButton, "selectBtn")
        role.btnN:SetOnClick(function()
            self:OnClickRoleBtn(i)
        end)
        role.btnTxtN = temp:AddComponent(UIText, "selectBtn/selectTxt")
        role.btnTxtN:SetLocalText(110108)
        table.insert(self.btnsTb, role)
    end
    self.closeBtnN = self:AddComponent(UIButton, closeBtn_path)
    self.closeBtnN:SetOnClick(function()
        DataCenter.AllianceLeaderManager:FinishQaGuide(0, 1)
        self.ctrl:CloseSelf()
    end)
    self.closeBtnN:SetActive(false)--需求，不显示关闭按钮
    self.goldRewardNumN = self:AddComponent(UIText, goldRewardNum_path)
    local rewardNum = LuaEntry.DataConfig:TryGetNum("alliance_regulation", "k6")
    self.goldRewardNumN:SetText(rewardNum)
    self.goldRewardTxtN = self:AddComponent(UIText, goldRewardTxt_path)
    self.goldRewardTxtN:SetLocalText(143590)
end

local function ComponentDestroy(self)
    
end

local function DataDefine(self)
end

local function DataDestroy(self)
end

local function OnAddListener(self)
    base.OnAddListener(self)
    --self:AddUIListener(EventId.UpdateAlCanBeLeader, self.RefreshAll)
end

local function OnRemoveListener(self)
    base.OnRemoveListener(self)
    --self:RemoveUIListener(EventId.UpdateAlCanBeLeader, self.RefreshAll)
end

local function RefreshAll(self)
    for i, v in ipairs(self.btnsTb) do
        if i == RoleBtnType.Leader then
            v.titleN:SetLocalText(141085)
            v.descN:SetLocalText(141105)
        else
            v.titleN:SetLocalText(390079)
            v.descN:SetLocalText(141104)
        end
    end
    --local showLeaderBtn = DataCenter.AllianceLeaderManager:CheckCanBeLeader()
    --self.btnsTb[RoleBtnType.Leader].btnN:SetActive(showLeaderBtn)
end

local function OnClickRoleBtn(self, roleIndex)
    if roleIndex == RoleBtnType.Leader then
        --UIManager:GetInstance():OpenWindow(UIWindowNames.UICreateSetAlliance, { anim = true, hideTop = true}, 1)
        --UIManager:GetInstance():OpenWindow(UIWindowNames.UIAllianceQa, { anim = true })
    else
        DataCenter.AllianceLeaderManager:FinishQaGuide(0, 4)
        self.ctrl:CloseSelf()
    end
end

UIAllianceSelectRoleView.OnCreate = OnCreate
UIAllianceSelectRoleView.OnDestroy = OnDestroy
UIAllianceSelectRoleView.OnAddListener = OnAddListener
UIAllianceSelectRoleView.OnRemoveListener = OnRemoveListener
UIAllianceSelectRoleView.ComponentDefine = ComponentDefine
UIAllianceSelectRoleView.ComponentDestroy = ComponentDestroy
UIAllianceSelectRoleView.DataDefine = DataDefine
UIAllianceSelectRoleView.DataDestroy = DataDestroy

UIAllianceSelectRoleView.RefreshAll = RefreshAll
UIAllianceSelectRoleView.OnClickRoleBtn = OnClickRoleBtn

return UIAllianceSelectRoleView