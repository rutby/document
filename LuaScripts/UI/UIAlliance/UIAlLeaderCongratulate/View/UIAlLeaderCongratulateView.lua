---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by 1.
--- DateTime: 2021/9/15 16:38
---

local base = UIBaseView--Variable
local UIAllianceSelectRoleView = BaseClass("UIAllianceSelectRoleView", base)--Variable
local Localization = CS.GameEntry.Localization

local title_path = "UICommonRewardPopUp/Panel/ImgTitleBg/TextTitle"
local desc_path = "ImgBg/desc"
local headIcon_path = "ImgBg/Image/UIPlayerHead/HeadIcon"
local headFg_path = "ImgBg/Image/UIPlayerHead/Foreground"
local name_path = "ImgBg/Image/name"
local closeBtn_path = "UICommonRewardPopUp/Panel"

local function OnCreate(self)
    base.OnCreate(self)
    self:ComponentDefine()
    self:DataDefine()
    self:RefreshAll()
end

local function OnDestroy(self)
    self:ComponentDestroy()
    self:DataDestroy()
    base.OnDestroy(self)
end

local function ComponentDefine(self)
    self.titleN = self:AddComponent(UIText, title_path)
    self.titleN:SetLocalText(104201)
    self.descN = self:AddComponent(UIText, desc_path)
    self.headIconN = self:AddComponent(UIPlayerHead, headIcon_path)
    self.headFgN = self:AddComponent(UIImage, headFg_path)
    self.nameN = self:AddComponent(UIText, name_path)
    self.closeBtnN = self:AddComponent(UIButton, closeBtn_path)
    self.closeBtnN:SetOnClick(function()
        self:OnClickCloseBtn()
    end)
end

local function ComponentDestroy(self)
    self.titleN = nil
    self.descN = nil
    self.headIconN = nil
    self.headFgN = nil
    self.nameN = nil
    self.closeBtnN = nil
end

local function DataDefine(self)
end

local function DataDestroy(self)
end

local function OnAddListener(self)
    base.OnAddListener(self)
    --self:AddUIListener(EventId.UpdateAlCanBeLeader, self.RefreshAll)
end

local function OnRemoveListener(self)
    --self:RemoveUIListener(EventId.UpdateAlCanBeLeader, self.RefreshAll)
    base.OnRemoveListener(self)
end

local function RefreshAll(self)
    local allianceBase = DataCenter.AllianceBaseDataManager:GetAllianceBaseData() 
    self.descN:SetText(Localization:GetString(141107, allianceBase.allianceName))
    
    self.headIconN:SetData(LuaEntry.Player.uid, LuaEntry.Player.pic, LuaEntry.Player.picVer)
    
    local fgImg = LuaEntry.Player:GetHeadBgImg()
    if not string.IsNullOrEmpty(fgImg) then
        self.headFgN:SetActive(true)
        self.headFgN:LoadSprite(fgImg)
    else
        self.headFgN:SetActive(false)
    end
    
    self.nameN:SetText(LuaEntry.Player.name)
end


local function OnClickCloseBtn(self)
    self.ctrl:CloseSelf()
end

UIAllianceSelectRoleView.OnCreate = OnCreate
UIAllianceSelectRoleView.OnDestroy = OnDestroy
UIAllianceSelectRoleView.OnAddListener = OnAddListener
UIAllianceSelectRoleView.OnRemoveListener = OnRemoveListener
UIAllianceSelectRoleView.ComponentDefine = ComponentDefine
UIAllianceSelectRoleView.ComponentDestroy = ComponentDestroy
UIAllianceSelectRoleView.DataDefine = DataDefine
UIAllianceSelectRoleView.DataDestroy = DataDestroy

UIAllianceSelectRoleView.RefreshAll = RefreshAll
UIAllianceSelectRoleView.OnClickCloseBtn = OnClickCloseBtn

return UIAllianceSelectRoleView