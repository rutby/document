---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Imaginaerum.
--- DateTime: 2021/6/9 17:06
---
local UIAllianceInviteTipView = BaseClass("UIAllianceInviteTipView",UIBaseView)
local base = UIBaseView
local Localization = CS.GameEntry.Localization

local title_path = "UICommonMiniPopUpTitle/Bg_mid/titleText"
local closeBtn_path = "UICommonMiniPopUpTitle/Bg_mid/CloseBtn"
local placeHolder_path = "ImgBg/InputField/Placeholder"
local inviteTipIpt_path = "ImgBg/InputField"
local confirmBtn_path = "ImgBg/confirmBtn"
local confirmBtnTxt_path = "ImgBg/confirmBtn/confirmTxt"
local tip_path = "ImgBg/tip"

local function OnCreate(self)
    base.OnCreate(self)
    
    local param = self:GetUserData()
    --self.confirmCallBack = param.callback
    self.cacheTip = param.defaultTip
    self.curTip = self.cacheTip
    
    self.closeBtnN = self:AddComponent(UIButton, closeBtn_path)
    self.closeBtnN:SetOnClick(function()
        self:OnClickCloseBtn()
    end)
    self.titleN = self:AddComponent(UITextMeshProUGUIEx, title_path)
    self.titleN:SetLocalText(110021)
    self.inviteTipIptN = self:AddComponent(UITMPInput, inviteTipIpt_path)
    self.inviteTipIptN:SetOnValueChange(function(value)
        self:OnInviteTipChange(value)
    end)
    self.placeHolderN = self:AddComponent(UITextMeshProUGUIEx, placeHolder_path)
    self.placeHolderN:SetText(self.cacheTip)
    self.inviteTipIptN:SetText("")
    self.confirmBtnN = self:AddComponent(UIButton, confirmBtn_path)
    self.confirmBtnN:SetOnClick(function()
        self:OnClickConfirmBtn()
    end)
    self.confirmBtnTxtN = self:AddComponent(UITextMeshProUGUIEx, confirmBtnTxt_path)
    self.confirmBtnTxtN:SetLocalText(141056)
    self.tipN = self:AddComponent(UITextMeshProUGUIEx, tip_path)
    --self.tipN:SetLocalText(391092)
    self.tipN:SetActive(false)
end

local function OnDestroy(self)
    
    base.OnDestroy(self)
end

local function OnClickCloseBtn(self)
    self.ctrl:CloseSelf()
end

local function OnClickConfirmBtn(self)
    local share_param = {}
    share_param.post = PostType.Text_AllianceRecruitShare
    local allianceBase = DataCenter.AllianceBaseDataManager:GetAllianceBaseData()
    share_param.name = allianceBase.allianceName
    share_param.abbr = allianceBase.abbr
    share_param.recruitTip = self.curTip
    share_param.country = allianceBase.country
    share_param.memberNum = allianceBase.curMember.."/"..allianceBase.maxMember
    share_param.allianceFlag = allianceBase.icon
    share_param.needApply = allianceBase.recruitTotal
    share_param.uid = allianceBase.uid
    share_param.language = allianceBase.language
    share_param.postType = PostType.Text_AllianceRecruitShare
    UIManager:GetInstance():OpenWindow(UIWindowNames.UIPositionShare, {anim = true}, share_param)
    
    --if self.confirmCallBack then
    --    self.confirmCallBack(self.curTip)
    --end
    self.ctrl:CloseSelf()
end

local function OnInviteTipChange(self, value)
    if string.IsNullOrEmpty(value) then
        self.curTip = self.cacheTip
    else
        self.curTip = value
    end
end


UIAllianceInviteTipView.OnCreate = OnCreate
UIAllianceInviteTipView.OnDestroy = OnDestroy

UIAllianceInviteTipView.OnClickCloseBtn = OnClickCloseBtn
UIAllianceInviteTipView.OnClickConfirmBtn = OnClickConfirmBtn
UIAllianceInviteTipView.OnInviteTipChange = OnInviteTipChange

return UIAllianceInviteTipView