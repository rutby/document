---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by guqu.
--- DateTime: 2020/7/30 16:02
---
local AllianceManageButton = BaseClass("AllianceManageButton",UIBaseContainer)
local base = UIBaseContainer
local bg_path = "Image"
local img_path = "Image/icon"
local name_path = "name"
local red_pot_path ="ImgWarn"
local red_pot_txt_path = "ImgWarn/TxtNum"
local function OnCreate(self,data)

    base.OnCreate(self)
    self.itemData = data
    self.name = self:AddComponent(UITextMeshProUGUIEx,name_path)
    self.bg = self:AddComponent(UIImage,bg_path)
    self.img = self:AddComponent(UIImage,img_path)
    self.btn = self:AddComponent(UIButton,"")
    self.red_pot = self:AddComponent(UIBaseContainer,red_pot_path)
    self.red_pot_txt = self:AddComponent(UITextMeshProUGUIEx,red_pot_txt_path)
    self.btn:SetOnClick(function()  
SoundUtil.PlayEffect(SoundAssets.Music_Effect_Button) 
        self.view.ctrl:OnGotoClick(self.itemData.type)
        
    end)
    self.name:SetText(self.itemData.name)
    self.img:LoadSprite(self.itemData.pic)
    if self.itemData.type == AllianceButtonType.AllianceQuit then
        self.bg:LoadSprite("Assets/Main/Sprites/UI/UIAlliance/alliance_btn_red")
        self.name:SetColor(Color.New(132/255,26/255,13/255,1))
    else
        self.bg:LoadSprite("Assets/Main/Sprites/UI/UIAlliance/alliance_btn_yellow")
        self.name:SetColor(Color.New(147/255,91/255,19/255,1))
    end
    --if self.itemData.type ~= AllianceButtonType.AllianceQuit and self.itemData.type ~= AllianceButtonType.AllianceSetting then
    --    CS.UIGray.SetGray(self.bg.transform, true, false)
    --else
    --    CS.UIGray.SetGray(self.bg.transform, false, true)
    --end
end

local function OnDestroy(self)
    self.itemData = nil
    self.name = nil
    self.img = nil
    self.btn = nil
    base.OnDestroy(self)
end

local function OnRefreshRedPot(self,type)

    local count = self.view.ctrl:GetRedPotCount(type)

    if count>0 then
        self.red_pot:SetActive(true)
        self.red_pot_txt:SetText(count)
    else
        self.red_pot:SetActive(false)
    end
end

AllianceManageButton.OnCreate= OnCreate
AllianceManageButton.OnDestroy = OnDestroy
AllianceManageButton.OnRefreshRedPot = OnRefreshRedPot
return AllianceManageButton