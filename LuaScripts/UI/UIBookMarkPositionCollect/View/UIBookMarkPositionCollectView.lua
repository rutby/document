---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by guqu.
--- DateTime: 2020/10/26 18:16
---
local UIBookMarkPositionCollectView = BaseClass("UIBookMarkPositionCollectView",UIBaseView)
local base = UIBaseView
local Localization = CS.GameEntry.Localization

local title_path = "ImgBg/TxtTitle"
local return_btn_path = "Panel"
local close_btn_path = "ImgBg/BtnClose"
local tips_txt_path = "ImgBg/Tips"
local server_txt_path= "ImgBg/TxtServe"
local server_input_path = "ImgBg/TxtServe/InputFieldServer"
local x_input_path = "ImgBg/TxtX/InputFieldX"
local y_input_path = "ImgBg/TxtY/InputFieldY"
local btn_path = "ImgBg/BtnGo"
local btn_txt_path = "ImgBg/BtnGo/Text"
local btn_book_mark_path = "ImgBg/BtnBookMark"
local function OnCreate(self)
    base.OnCreate(self)
    self.title = self:AddComponent(UIText,title_path)
    self.title:SetLocalText(110003) 
    self.tips_txt = self:AddComponent(UIText,tips_txt_path)
    self.tips_txt:SetText("")
    self.server_txt = self:AddComponent(UIText,server_txt_path)
    self.server_txt:SetLocalText(280068) 
    self.server_input = self:AddComponent(UIInput,server_input_path)
    self.server_input:SetOnEndEdit(function (value)
        self:IptOnServerValueChange(value)
    end)
    self.x_input = self:AddComponent(UIInput,x_input_path)
    self.x_input:SetOnEndEdit(function (value)
        self:IptOnXValueChange(value)
    end)
    self.y_input = self:AddComponent(UIInput,y_input_path)
    self.y_input:SetOnEndEdit(function (value)
        self:IptOnYValueChange(value)
    end)
    self.btn = self:AddComponent(UIButton, btn_path)
    self.btn:SetOnClick(function()  
SoundUtil.PlayEffect(SoundAssets.Music_Effect_Button)
        self:OnClickJump()
    end)
    self.btn_txt = self:AddComponent(UIText,btn_txt_path)
    self.btn_txt:SetLocalText(GameDialogDefine.CONFIRM) 

    self.btn_book_mark= self:AddComponent(UIButton, btn_book_mark_path)
    self.btn_book_mark:SetOnClick(function()  
SoundUtil.PlayEffect(SoundAssets.Music_Effect_Button)
        self.ctrl:OnBookMarkClick()
    end)
    
    self.close_btn = self:AddComponent(UIButton, close_btn_path)
    self.close_btn:SetOnClick(function()  
        self.ctrl:CloseSelf()
    end)
    self.return_btn = self:AddComponent(UIButton, return_btn_path)
    self.return_btn:SetOnClick(function()  
        self.ctrl:CloseSelf()
    end)
    self.server = -1
    self.x = -1
    self.y = -1
end

local function OnDestroy(self)
    self.title = nil
    self.tips_txt = nil
    self.server_txt = nil
    self.server_input = nil
    self.x_input = nil
    self.y_input = nil
    self.btn = nil
    self.btn_txt = nil
    self.close_btn = nil
    self.return_btn = nil
    self.server = nil
    self.x = nil
    self.y = nil
    self.btn_book_mark =nil
    base.OnDestroy(self)
end

local function OnEnable(self)
    base.OnEnable(self)
    self:InitState()
end

local function OnDisable(self)
    base.OnDisable(self)
end
local function InitState(self)
    local data = self.ctrl:GetCurrentState()
    self.server = data.serverId
    self.x = data.x
    self.y = data.y
    self.server_input:SetText(self.server)
    self.y_input:SetText(self.y)
    self.x_input:SetText(self.x)
    
end
local function IptOnServerValueChange(self,value)
    self.server = tonumber(value)
end
local function IptOnXValueChange(self,value)
    self.x = tonumber(value)
end
local function IptOnYValueChange(self,value)
    self.y = tonumber(value)
end
local function OnClickJump(self)
    if self.ctrl:CheckCanGo(self.server,self.x,self.y)==false then
        self.tips_txt:SetText(Localization:GetString(CS.GameDialogDefine.OUT_UNLOCK_RANGE_REASON,
                CS.SceneManager.World.CurTileCountXMin, CS.SceneManager.World.CurTileCountYMin,
                CS.SceneManager.World.CurTileCountXMax, CS.SceneManager.World.CurTileCountYMax))
    else
        self.tips_txt:SetText("")
        self.ctrl:OnJumpClick(self.server,self.x,self.y)
    end
end

UIBookMarkPositionCollectView.OnCreate = OnCreate
UIBookMarkPositionCollectView.OnDestroy = OnDestroy
UIBookMarkPositionCollectView.InitState = InitState
UIBookMarkPositionCollectView.OnEnable = OnEnable
UIBookMarkPositionCollectView.OnDisable = OnDisable
UIBookMarkPositionCollectView.IptOnServerValueChange = IptOnServerValueChange
UIBookMarkPositionCollectView.IptOnXValueChange = IptOnXValueChange
UIBookMarkPositionCollectView.IptOnYValueChange = IptOnYValueChange
UIBookMarkPositionCollectView.OnClickJump = OnClickJump

return UIBookMarkPositionCollectView