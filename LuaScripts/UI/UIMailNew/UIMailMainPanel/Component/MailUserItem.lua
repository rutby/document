---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Still4.
--- DateTime: 2021/8/23 16:39
---
local MailUserItem = BaseClass("MailUserItem", UIBaseContainer)
local base = UIBaseContainer
local Localization = CS.GameEntry.Localization

local headIconPath = "UIPlayerHead/HeadIcon"
local nameTextPath = "nameText"
local jumpBtnPath = "jumpBtnObj"
local jumpBtnTextPath = "jumpBtnObj/jumpText"

-- 创建
local function OnCreate(self)
    base.OnCreate(self)
    self.headIcon = self:AddComponent(UIPlayerHead, headIconPath)
    self.nameText = self:AddComponent(UITextMeshProUGUIEx, nameTextPath)
    self.jumpBtn = self:AddComponent(UIButton, jumpBtnPath)
    self.jumpBtnText = self:AddComponent(UITextMeshProUGUIEx, jumpBtnTextPath)
    self.jumpBtnText:SetLocalText(GameDialogDefine.MAIl_PLAYER_INFO_CLICK) 

    self.jumpBtn:SetOnClick(function()  
SoundUtil.PlayEffect(SoundAssets.Music_Effect_Button)
        self:OnBtnClick()
    end)
end

-- 销毁
local function OnDestroy(self)
    self.headIcon = nil
    self.nameText = nil
    self.jumpBtn = nil
    self.jumpBtnText = nil
    base.OnDestroy(self)
end

-- 显示
local function OnEnable(self)
    base.OnEnable(self)
end

-- 隐藏
local function OnDisable(self)
    base.OnDisable(self)
end

local function OnBtnClick(self)
    -- 查看指挥官信息
    local userData = {}
    userData["uid"] = self.userInfo["uid"]
    local uid = userData["uid"]
    userData["headPic"] = self.userInfo["pic"]
    userData["headPicVer"] = self.userInfo["picVer"]
    UIManager:GetInstance():OpenWindow(UIWindowNames.UIOtherPlayerInfo,uid)
end

local function RefreshData(self, userInfo)
    self.userInfo = userInfo
    local uname
    if string.IsNullOrEmpty(userInfo["abbr"]) then
        uname = userInfo["name"]
    else
        uname = "[" .. userInfo["abbr"] .. "]" .. userInfo["name"]
    end
    self.nameText:SetText(uname)
    local pic = userInfo["pic"] or ""
    local picVer = userInfo["picVer"] or 0
    self.headIcon:SetData(userInfo["uid"], pic, picVer)
end

MailUserItem.OnCreate = OnCreate
MailUserItem.OnDestroy = OnDestroy
MailUserItem.OnBtnClick = OnBtnClick
MailUserItem.OnEnable = OnEnable
MailUserItem.OnDisable = OnDisable
MailUserItem.RefreshData = RefreshData

return MailUserItem