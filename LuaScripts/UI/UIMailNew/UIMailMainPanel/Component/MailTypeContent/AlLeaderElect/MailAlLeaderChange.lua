---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by 1.
--- DateTime: 2021/10/25 11:19
---


local MailAlLeaderChange = BaseClass("MailAlLeaderChange", UIBaseContainer)
local base = UIBaseContainer
local Localization = CS.GameEntry.Localization
local rapidjson = require "rapidjson"
local MailUserItem = require "UI.UIMailNew.UIMailMainPanel.Component.MailUserItem"

local title_path = "UIMailItemTitle/txtMainTitle"
local subTitle_path = "UIMailItemTitle/txtSubTitle"
local time_path = "UIMailItemTitle/txtTime"
local mailMsg_path = "txtContext"
local mailLeader_path = "objUserNode/MailUserItem"

local function OnCreate(self)
    base.OnCreate(self)

    self.titleN = self:AddComponent(UITextMeshProUGUIEx, title_path)
    self.subTitleN = self:AddComponent(UITextMeshProUGUIEx, subTitle_path)
    self.timeN = self:AddComponent(UITextMeshProUGUIEx, time_path)
    self.mailMsgN = self:AddComponent(UITextMeshProUGUIEx, mailMsg_path)-- self:AddComponent(UITextMeshProUGUIEx, mailMsg_path)
    self.mailLeaderN = self:AddComponent(MailUserItem, mailLeader_path)
end

local function OnDestroy(self)
    base.OnDestroy(self)
end

local function setData(self, mailInfo)
    self.mailInfo = mailInfo
    self:ParseContent()
    self:RefreshUI()
end

local function ParseContent(self)
    if self.mailInfo == nil then
        return;
    end

    self.leaderInfo = self.mailInfo:GetMailUserInfo()
end

local function RefreshUI(self)
    local strMainTitle = MailShowHelper.GetMainTitle(self.mailInfo)
    self.titleN:SetText(strMainTitle)
    local strSubTitle = MailShowHelper.GetMailSubTitle(self.mailInfo)
    self.subTitleN:SetText(strSubTitle)
    local strTime = MailShowHelper.GetAbstractCreateTime(self.mailInfo)
    self.timeN:SetText(strTime)
    local mailMsg = self.mailInfo:GetMailMessage()
    self.mailMsgN:SetText(mailMsg)

    if self.leaderInfo then
        self.mailLeaderN:SetActive(true)
        self.mailLeaderN:RefreshData(self.leaderInfo)
    else
        self.mailLeaderN:SetActive(false)
    end
end

MailAlLeaderChange.OnCreate = OnCreate
MailAlLeaderChange.OnDestroy = OnDestroy
MailAlLeaderChange.setData = setData
MailAlLeaderChange.ParseContent = ParseContent
MailAlLeaderChange.RefreshUI = RefreshUI

return MailAlLeaderChange                                                                                                                                                                                                                                                                                                                                                                         