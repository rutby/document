---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by mac.
--- DateTime: 1/18/22 11:53 AM
---
local ctrl = BaseClass("ctrl", UIBaseCtrl)

local function CloseSelf(self)
    UIManager:GetInstance():DestroyWindow(UIWindowNames.UIShareMail)
end

local function OnMoreHero(self)
    local scienceId = DataCenter.ArmyFormationDataManager:GetFirstFormationUnlockScienceId()
    if scienceId ~= nil then
        GoToUtil.GotoScience(CommonUtil.GetScienceBaseType(scienceId))
        self:CloseSelf()
    end
end

local function OnUpgradeHeroLevel(self, heroUuid)
    GoToUtil.GotoOpenView(UIWindowNames.UIHeroList,{anim = false,UIMainAnim = UIMainAnimType.AllHide}, heroUuid)
end

local function OnRecruitHero(self)
    UIManager:GetInstance():OpenWindow(UIWindowNames.UIHeroRecruit)
end

local function OnUpgradeHeroQuality(self)
    UIManager:GetInstance():OpenWindow(UIWindowNames.UIHeroAdvance)
end

local function OnClickPosBtn(self,pos,serverId,worldId)
    if not SceneUtils.CheckCanGotoWorld() then
        return UIUtil.ShowTipsId(120018)
    end
    if pos~=0 then
        local pointV3 = SceneUtils.TileIndexToWorld(pos,ForceChangeScene.World)
        self:CloseSelf()
        UIManager:GetInstance():DestroyWindow(UIWindowNames.UIChatNew)
        GoToUtil.GotoWorldPos(pointV3, CS.SceneManager.World.InitZoom,nil,nil,serverId,worldId)
    end
end

local function TryShareToChat(self, strContent, mailType, mailInfo)
    local share_param = {}
    share_param.msg = ""
    share_param.name = ""
    share_param.postType = PostType.Text_BattleReportContentShare
    share_param.mailType = mailType
    share_param.reportContent = strContent
    share_param.createTime = mailInfo.createTime
    UIManager:GetInstance():OpenWindow(UIWindowNames.UIPositionShare, {anim = true}, share_param)
end

ctrl.OnClickPosBtn = OnClickPosBtn
ctrl.OnMoreHero = OnMoreHero
ctrl.OnUpgradeHeroLevel = OnUpgradeHeroLevel
ctrl.OnRecruitHero = OnRecruitHero
ctrl.OnUpgradeHeroQuality = OnUpgradeHeroQuality
ctrl.TryShareToChat = TryShareToChat

ctrl.CloseSelf = CloseSelf

return ctrl