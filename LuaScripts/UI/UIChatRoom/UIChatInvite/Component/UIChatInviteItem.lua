---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Beef.
--- DateTime: 2023/4/6 15:39
---

local UIChatInviteItem = BaseClass("UIChatInviteItem", UIBaseContainer)
local base = UIBaseContainer
local Localization = CS.GameEntry.Localization
local UIGray = CS.UIGray

local this_path = ""
local head_btn_path = "UIPlayerHead"
local head_path = "UIPlayerHead/HeadIcon"
local head_fg_path = "UIPlayerHead/Foreground"
local name_path = "Name"
local power_path = "Power"
local check_path = "checkBox/Check"

local State =
{
    Unselected = 1,
    Selected = 2,
    Fixed = 3,
}

local function OnCreate(self)
    base.OnCreate(self)
    self:DataDefine()
    self:ComponentDefine()
end

local function OnDestroy(self)
    self:ComponentDestroy()
    self:DataDestroy()
    base.OnDestroy(self)
end

local function ComponentDefine(self)
    self.btn = self:AddComponent(UIButton, this_path)
    self.btn:SetOnClick(function()
        self:OnClick()
    end)
    self.player_head_btn = self:AddComponent(UIButton, head_btn_path)
    self.player_head_btn:SetOnClick(function()
        self:OnHeadClick()
    end)
    self.player_head = self:AddComponent(UIPlayerHead, head_path)
    self.player_head_fg = self:AddComponent(UIImage, head_fg_path)
    self.name_text = self:AddComponent(UIText, name_path)
    self.power_text = self:AddComponent(UIText, power_path)
    self.check_go = self:AddComponent(UIBaseContainer, check_path)
end

local function ComponentDestroy(self)
    
end

local function DataDefine(self)
    self.data = nil
    self.onClick = nil
end

local function DataDestroy(self)
    self.data = nil
    self.onClick = nil
end

local function OnEnable(self)
    base.OnEnable(self)
end

local function OnDisable(self)
    base.OnDisable(self)
end

local function OnAddListener(self)
    base.OnAddListener(self)
end

local function OnRemoveListener(self)
    base.OnRemoveListener(self)
end

local function SetData(self, data)
    self.data = data
    self.player_head:SetData(data.uid, data.pic, data.picVer)
    local headBgImg = DataCenter.DecorationDataManager:GetHeadFrame(data.headSkinId, data.headSkinET)
    if headBgImg ~= nil then
        self.player_head_fg:SetActive(true)
        self.player_head_fg:LoadSprite(headBgImg)
    else
        self.player_head_fg:SetActive(false)
    end
    if string.IsNullOrEmpty(data.abbr) then
        self.name_text:SetText(data.name)
    else
        self.name_text:SetText(string.format("[%s] %s", data.abbr, data.name))
    end
    self.power_text:SetText(string.GetFormattedSeperatorNum(data.power or 0))
end

local function SetState(self, state)
    if state == State.Unselected then
        self.check_go:SetActive(false)
    elseif state == State.Selected then
        self.check_go:SetActive(true)
        UIGray.SetGray(self.check_go.transform, false)
    elseif state == State.Fixed then
        self.check_go:SetActive(true)
        UIGray.SetGray(self.check_go.transform, true)
    end
end

local function SetOnClick(self, onClick)
    self.onClick = onClick
end

local function OnClick(self)
    if self.onClick then
        self.onClick()
    end
end

local function OnHeadClick(self)
    if self.data.uid ~= LuaEntry.Player.uid then
        UIManager:GetInstance():OpenWindow(UIWindowNames.UIOtherPlayerInfo, { anim = true}, self.data.uid)
    else
        UIManager:GetInstance():OpenWindow(UIWindowNames.UIPlayerInfo, { anim = true}, LuaEntry.Player.uid)
    end
end

UIChatInviteItem.OnCreate= OnCreate
UIChatInviteItem.OnDestroy = OnDestroy
UIChatInviteItem.ComponentDefine = ComponentDefine
UIChatInviteItem.ComponentDestroy = ComponentDestroy
UIChatInviteItem.DataDefine = DataDefine
UIChatInviteItem.DataDestroy = DataDestroy
UIChatInviteItem.OnEnable = OnEnable
UIChatInviteItem.OnDisable = OnDisable
UIChatInviteItem.OnAddListener = OnAddListener
UIChatInviteItem.OnRemoveListener = OnRemoveListener

UIChatInviteItem.State = State
UIChatInviteItem.SetData = SetData
UIChatInviteItem.SetState = SetState
UIChatInviteItem.SetOnClick = SetOnClick

UIChatInviteItem.OnClick = OnClick
UIChatInviteItem.OnHeadClick = OnHeadClick

return UIChatInviteItem