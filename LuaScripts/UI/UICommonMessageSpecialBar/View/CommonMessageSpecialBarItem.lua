---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Imaginaerum.
--- DateTime: 2022/9/19 14:22
---
local CommonMessageSpecialBarItem = BaseClass("CommonMessageSpecialBarItem", UIBaseContainer)
local base = UIBaseContainer
local Localization = CS.GameEntry.Localization
local msgTxt_path = "doTween/Text"
local canvasGroup_path = "doTween"

local TweenPosY = {
    Start = -50,
    Idle = 0,
    End = 50,
}


local function OnCreate(self)
    base.OnCreate(self)
    self.msgTxtN = self:AddComponent(UIText, msgTxt_path)
    self.canvasGroupN = self:AddComponent(UICanvasGroup, canvasGroup_path)
end

local function OnDestroy(self)
    self.msgTxtN = nil

    base.OnDestroy(self)
end

--从开始显示到准备隐藏的时间为 timeBeforeFadeOut
--隐藏动画时长不能超过上面的值，不然两个预制不够
local function FadeIn(self, tipInfo)
    self:ResetItem()

    local msg = tipInfo.msg
    local msgId = tipInfo.msgId
    --local showType = tipInfo.showType
    if msg~=nil and msg~="" then
        self.msgTxtN:SetText(msg)
    elseif msgId ~= nil then
        self.msgTxtN:SetLocalText(msgId)
    else
        self.msgTxtN:SetLocalText(100378)
    end

    self.canvasGroupN.rectTransform:GetComponent(typeof(CS.UnityEngine.CanvasGroup)):DOFade(1, 0.3)--:SetEase(CS.DG.Tweening.Ease.InOutCubic)
    self.canvasGroupN.rectTransform:DOAnchorPosY(TweenPosY.Idle, 0.3)--:SetEase(CS.DG.Tweening.Ease.InOutQuint)
    --rootRt:DOScale(Vector3.New(1.1, 1.1, 0), 0.15):OnComplete(function()
    --    rootRt:DOScale(Vector3.one, 0.1)
    --end):SetEase(CS.DG.Tweening.Ease.InOutCubic)
end

local function FadeOut(self)
    self.canvasGroupN.rectTransform:GetComponent(typeof(CS.UnityEngine.CanvasGroup)):DOFade(0, 0.4):OnComplete(function()
        --self:ResetItem()
    end):SetEase(CS.DG.Tweening.Ease.OutCubic)

    self.canvasGroupN.rectTransform:DOAnchorPosY(TweenPosY.End, 0.4):OnComplete(function()
        --self:ResetItem()
    end)--:SetEase(CS.DG.Tweening.Ease.OutCubic)
end

local function ResetItem(self)
    self.canvasGroupN:SetAlpha(0)
    self.canvasGroupN.rectTransform:Set_localPosition(0, TweenPosY.Start, 0)
end


CommonMessageSpecialBarItem.OnCreate = OnCreate
CommonMessageSpecialBarItem.OnDestroy = OnDestroy

CommonMessageSpecialBarItem.FadeIn = FadeIn
CommonMessageSpecialBarItem.FadeOut = FadeOut
CommonMessageSpecialBarItem.ResetItem = ResetItem

return CommonMessageSpecialBarItem