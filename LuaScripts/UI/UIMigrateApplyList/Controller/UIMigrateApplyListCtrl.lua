---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Imaginaerum.
--- DateTime: 2023/4/18 18:48
---
local UIMigrateApplyListCtrl = BaseClass("UIMigrateApplyListCtrl", UIBaseCtrl)
local Localization = CS.GameEntry.Localization
local function CloseSelf(self)
    UIManager:GetInstance():DestroyWindow(UIWindowNames.UIMigrateApplyList)
end

local function Close(self)
    UIManager:GetInstance():DestroyWindowByLayer(UILayer.Normal)
end

local function GetApplyList(self)
    local showList ={}
    local data = DataCenter.MigrateDataManager:GetApplyList()
    if data~=nil then
        showList = table.values(data)
    end
    table.sort(showList,function(a,b)
        return a.specialApply>b.specialApply
    end)
    return showList
end

local function OnPlayerDetailClick(self,uid)
    UIManager:GetInstance():OpenWindow(UIWindowNames.UIOtherPlayerInfo,{ anim = true, hideTop = true},uid)
end

local function OnAcceptClick(self,uid,specialApply)
    if specialApply ==1 then
        local useNum,maxNum = DataCenter.MigrateDataManager:GetSpecialNum()
        if useNum>=maxNum then
            UIUtil.ShowTipsId(250388)
            return
        end
    end
    local playerId = uid
    UIUtil.ShowMessage(Localization:GetString("250391"), 1, GameDialogDefine.CONFIRM, GameDialogDefine.CANCEL, function()
        SFSNetwork.SendMessage(MsgDefines.MigrateApprove,playerId,ApproveMigrateState.AGREE)
    end)
    
end
local function OnRefuseClick(self,uid)
    SFSNetwork.SendMessage(MsgDefines.MigrateApprove,uid,ApproveMigrateState.REFUSE)
end


UIMigrateApplyListCtrl.CloseSelf = CloseSelf
UIMigrateApplyListCtrl.Close = Close
UIMigrateApplyListCtrl.OnPlayerDetailClick = OnPlayerDetailClick
UIMigrateApplyListCtrl.GetApplyList =GetApplyList
UIMigrateApplyListCtrl.OnAcceptClick =OnAcceptClick
UIMigrateApplyListCtrl.OnRefuseClick =OnRefuseClick
return UIMigrateApplyListCtrl