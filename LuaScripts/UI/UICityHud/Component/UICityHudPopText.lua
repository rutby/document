---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Beef.
--- DateTime: 2023/11/29 15:25
---

local base = require "UI.UICityHud.Component.UICityHudBase"
local UICityHudPopText = BaseClass("UICityHudPopText", base)

local icon_path = "Root/Icon"
local text_path = "Root/Text"

local MoveY = 50

local function ComponentDefine(self)
    base.ComponentDefine(self)
    self.icon_image = self:AddComponent(UIImage, icon_path)
    self.text = self:AddComponent(UITextMeshProUGUIEx, text_path)
end

local function DataDefine(self)
    base.DataDefine(self)
    self.tween = nil
    self.lodMax = 2
end

function UICityHudPopText:OnDestroy()

end

local function DataDestroy(self)
    base.DataDestroy(self)
    if self.tween then
        self.tween:Kill()
        self.tween = nil
    end
end

local function SetParam(self, param)
    base.SetParam(self, param)

    if param.icon then
        self.icon_image:LoadSprite(param.icon)
        self.icon_image:SetActive(true)
    else
        self.icon_image:SetActive(false)
    end

    if param.text then
        self.text:SetText(param.text)
        self.text:SetActive(true)
    else
        self.text:SetActive(false)
    end

    if self.tween then
        self.tween:Kill()
    end
    local offset = param.offset or Vector3.zero
    self.root_go.transform.localPosition = offset
    self.tween = self.root_go.transform:DOLocalMoveY(offset.y + MoveY, param.duration):OnComplete(function()
        DataCenter.CityHudManager:Destroy(param.uuid, param.type)
    end)
end

UICityHudPopText.ComponentDefine = ComponentDefine
UICityHudPopText.DataDefine = DataDefine
UICityHudPopText.DataDestroy = DataDestroy
UICityHudPopText.SetParam = SetParam

return UICityHudPopText