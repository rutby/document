---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Beef.
--- DateTime: 2023/11/29 15:34
---

local base = require "UI.UICityHud.Component.UICityHudBase"
local UICityHudResidentSlider = BaseClass("UICityHudResidentSlider", base)

local slider_path = "Root/Slider"
local icon_path = "Root/Slider/Icon"
local fill_path = "Root/Slider/FillArea/Fill"

local function ComponentDefine(self)
    base.ComponentDefine(self)
    self.slider = self:AddComponent(UISlider, slider_path)
    self.icon_image = self:AddComponent(UIImage, icon_path)
    self.fill_image = self:AddComponent(UIImage, fill_path)
end

local function DataDefine(self)
    base.DataDefine(self)
    self.lodMax = 2
end

function UICityHudResidentSlider:OnDestroy()

end

local function SetParam(self, param)
    base.SetParam(self, param)
    self.type = param.para1
    self.root_go.transform.localPosition = param.offset or Vector3.zero
    local icon = ""
    local fill = ""
    if self.param.para1 == FurniturePara1Type.Stamina then
        icon = string.format(LoadPath.UIVita, "survivor_icon_healthy06")
        fill = string.format(LoadPath.UIMain, "com_jindudi_hong")
    elseif self.param.para1 == FurniturePara1Type.Mood then
        icon = string.format(LoadPath.UIMain, "icon_feeling")
        fill = string.format(LoadPath.UIMain, "com_jindudi_lv")
    end
    self.icon_image:LoadSprite(icon)
    self.fill_image:LoadSprite(fill)
    self:TimerAction()
end

local function TimerAction(self)
    if not self.active then
        return
    end
    local residentData = DataCenter.VitaManager:GetResidentData(self.param.uuid)
    local cur = 0
    local max = 0
    if self.type == FurniturePara1Type.Stamina then
        cur = residentData:GetCurStamina()
        max = residentData:GetMaxStamina()
    elseif self.type == FurniturePara1Type.Mood then
        cur = residentData:GetCurMood()
        max = residentData:GetMaxMood()
    end
    self.slider:SetValue(cur / max)
end

UICityHudResidentSlider.ComponentDefine = ComponentDefine
UICityHudResidentSlider.DataDefine = DataDefine
UICityHudResidentSlider.SetParam = SetParam
UICityHudResidentSlider.TimerAction = TimerAction

return UICityHudResidentSlider