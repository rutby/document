---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Beef.
--- DateTime: 2024/1/23 16:36
---

local base = require "UI.UICityHud.Component.UICityHudBase"
local UICityHudSpeak = BaseClass("UICityHudSpeak", base)

local bg1_path = "Root/Bg1"
local bg2_path = "Root/Bg2"
local content_path = "Root/Content"

local function ComponentDefine(self)
    base.ComponentDefine(self)
    self.bg1_go = self:AddComponent(UIBaseContainer, bg1_path)
    self.bg2_go = self:AddComponent(UIBaseContainer, bg2_path)
    self.content_text = self:AddComponent(UITextMeshProUGUIEx, content_path)
end

local function DataDefine(self)
    base.DataDefine(self)
    self.lodMax = 3
end

local function SetParam(self, param)
    base.SetParam(self, param)
    self.root_go.transform.localPosition = param.offset or Vector3.zero
    if param.bgType == 2 then
        self.bg1_go:SetActive(false)
        self.bg2_go:SetActive(true)
    else
        self.bg1_go:SetActive(true)
        self.bg2_go:SetActive(false)
    end
  
    self.content_text:SetText(param.text)
    TimerManager:GetInstance():DelayInvoke(function()
        if self.active then
            DataCenter.CityHudManager:Destroy(param.uuid, CityHudType.Speak)
        end
    end, param.duration)
    self:PlayDub(param.dubId)
end

function UICityHudSpeak:PlayDub(name)
    if name ~= nil then
        SoundUtil.StopDubSound()
        SoundUtil.PlayDub(name)
    end
end

UICityHudSpeak.ComponentDefine = ComponentDefine
UICityHudSpeak.DataDefine = DataDefine
UICityHudSpeak.SetParam = SetParam

return UICityHudSpeak