---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Beef.
--- DateTime: 2023/2/27 17:42
---

local UICommonStarTip = BaseClass("UICommonStarTip", UIBaseView)
local base = UIBaseView

local this_path = ""
local root_path = ""
local desc_path = "Root/Desc"
local left_path = "Root/Left"
local right_path = "Root/Right"

local DURATION = 2

local function OnCreate(self)
    base.OnCreate(self)
    self:DataDefine()
    self:ComponentDefine()
end

local function OnDestroy(self)
    self:ComponentDestroy()
    self:DataDestroy()
    base.OnDestroy(self)
end

local function OnEnable(self)
    base.OnEnable(self)
    self.active = true
    self:ReInit()
end

local function OnDisable(self)
    self.active = false
    base.OnDisable(self)
end

local function ComponentDefine(self)
    self.anim = self:AddComponent(UIAnimator, this_path)
    self.root_go = self:AddComponent(UIBaseComponent, root_path)
    self.desc_text = self:AddComponent(UIText, desc_path)
    self.left_text = self:AddComponent(UIText, left_path)
    self.right_text = self:AddComponent(UIText, right_path)
end

local function ComponentDestroy(self)
    self.anim = nil
    self.root_go = nil
    self.desc_text = nil
    self.left_text = nil
    self.right_text = nil
end

local function DataDefine(self)
    self.active = false
    self.timer = nil
end

local function DataDestroy(self)
    self.active = nil
    if self.timer then
        self.timer:Stop()
        self.timer = nil
    end
end

local function OnAddListener(self)
    base.OnAddListener(self)
end

local function OnRemoveListener(self)
    base.OnRemoveListener(self)
end

local function ReInit(self)
    local descText, leftText, rightText = self:GetUserData()
    self:SetData(descText, leftText, rightText)
end

local function SetData(self, descText, leftText, rightText)
    if self.timer then
        self.timer:Stop()
    end
    self.anim:Play("CommonPopup_movein", 0, 0)
    self.desc_text:SetText(descText)
    self.left_text:SetText(leftText)
    self.right_text:SetText(rightText)
    CS.UnityEngine.UI.LayoutRebuilder.ForceRebuildLayoutImmediate(self.desc_text.rectTransform)
    CS.UnityEngine.UI.LayoutRebuilder.ForceRebuildLayoutImmediate(self.left_text.rectTransform)
    CS.UnityEngine.UI.LayoutRebuilder.ForceRebuildLayoutImmediate(self.right_text.rectTransform)
    CS.UnityEngine.UI.LayoutRebuilder.ForceRebuildLayoutImmediate(self.root_go.rectTransform)
    self.timer = TimerManager:GetInstance():DelayInvoke(function()
        if self.active then
            self.ctrl:CloseSelf()
            self.timer = nil
        end
    end, DURATION)
end

UICommonStarTip.OnCreate = OnCreate
UICommonStarTip.OnDestroy = OnDestroy
UICommonStarTip.OnEnable = OnEnable
UICommonStarTip.OnDisable = OnDisable
UICommonStarTip.ComponentDefine = ComponentDefine
UICommonStarTip.ComponentDestroy = ComponentDestroy
UICommonStarTip.DataDefine = DataDefine
UICommonStarTip.DataDestroy = DataDestroy
UICommonStarTip.OnAddListener = OnAddListener
UICommonStarTip.OnRemoveListener = OnRemoveListener

UICommonStarTip.ReInit = ReInit
UICommonStarTip.SetData = SetData

return UICommonStarTip