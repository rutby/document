---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by 1.
--- DateTime: 2022/2/8 14:36
---
local UIChampionBattleMainViewCtrl = BaseClass("UIChampionBattleMainViewCtrl", UIBaseCtrl)

local function CloseSelf(self)
    UIManager:GetInstance():DestroyWindow(UIWindowNames.UIChampionBattleMain)
end

local function Close(self)
    UIManager:GetInstance():DestroyWindowByLayer(UILayer.Normal)
end

local function ShowPlayerInfo(self, userUid)
    if string.IsNullOrEmpty(userUid) then
        return ""
    end
    if userUid == LuaEntry.Player.uid then
        UIManager:GetInstance():OpenWindow(UIWindowNames.UIPlayerInfo, userUid)
    else
        UIManager:GetInstance():OpenWindow(UIWindowNames.UIOtherPlayerInfo, userUid)
    end
end

local function GetNameStr(self, abbr, name)
    local result = ""
    if not string.IsNullOrEmpty(abbr) then
        result = "["..abbr.."]"
    end
    result = result..name
    return result
end

local function SetHeadImg(self, userHead, guluFrame, userUid, pic, picvec, isGuluFrame, headSkinId, headSkinET)
    userHead:SetData(userUid, pic, picvec)
    local headBgImg = DataCenter.DecorationDataManager:GetHeadFrame(headSkinId, headSkinET, isGuluFrame == 1)
    guluFrame:SetActive(headBgImg ~= nil)
    if headBgImg ~= nil then
        guluFrame:LoadSprite(headBgImg)
    end

end

local function GetHeroInfo(self, index)
    local data = DataCenter.ActChampionBattleManager:GetFormationData(index)
    if data == nil or data.heroes == nil or table.count(data.heroes) == 0 then
        return nil
    end
    local heroUid = data.heroes[1].heroUuid
    local heroData = DataCenter.HeroDataManager:GetHeroByUuid(heroUid)
    if heroData ~= nil then
        local heroConfig = heroData:GetConfig()
        if heroConfig ~= nil then
            local quality = heroData.quality
            local camp = heroData:GetCamp()
            local rarity = heroConfig.rarity
            local heroHead = DataCenter.ActChampionBattleManager:GetFormationHeroPic(index)
            local qualityIcon = HeroUtils.GetRarityIconPath(rarity)
            --local star = HeroUtils.GetStarNumByQuality(quality)
            local campIcon = HeroUtils.GetCampIconPath(camp)
            local rankIcon = ""
            local rankId = heroData:GetCurMilitaryRankId()
            if rankId > 1 then
                rankIcon = HeroUtils.GetMilitaryRankIcon(rankId)
            end
            return heroHead, heroData.level, quality, rankIcon, campIcon, qualityIcon, rarity,heroData
        end
    end
    return nil
    --local iconStr, lv, star, rankIcon, campIcon = self.view.ctrl:GetHeroInfo(i)

end


UIChampionBattleMainViewCtrl.CloseSelf = CloseSelf
UIChampionBattleMainViewCtrl.Close = Close
UIChampionBattleMainViewCtrl.SetHeadImg = SetHeadImg
UIChampionBattleMainViewCtrl.GetHeroInfo = GetHeroInfo
UIChampionBattleMainViewCtrl.ShowPlayerInfo = ShowPlayerInfo
UIChampionBattleMainViewCtrl.GetNameStr = GetNameStr
return UIChampionBattleMainViewCtrl