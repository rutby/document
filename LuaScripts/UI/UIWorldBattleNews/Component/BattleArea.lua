---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Imaginaerum.
--- DateTime: 2022/3/28 16:24
---
local BattleAbbr = require "UI.UIWorldBattleNews.Component.BattleAbbr"
local BattleArea = BaseClass("BattleArea",UIBaseContainer)
local base = UIBaseContainer
local Localization = CS.GameEntry.Localization
local time_txt_path = "imgBg/timeLabel"
local alliance_des_path= "desText"
local alliance_btn_path = "desText/btn_alliance"
local left_abbr_path = "allianceContent/abbrA"
local right_abbr_path = "allianceContent/abbrB"
local empty_path = "emptyText"
local function OnCreate(self)
    base.OnCreate(self)
    self.time_txt= self:AddComponent(UIText,time_txt_path)
    self.alliance_des = self:AddComponent(UIText,alliance_des_path)
    self.alliance_des:SetText(Localization:GetString("302145"))
    self.alliance_btn = self:AddComponent(UIButton, alliance_btn_path)
    self.alliance_btn:SetOnClick(function()
        self:OnDetailClick()
    end)
    self.empty = self:AddComponent(UIText,empty_path)
    self.empty:SetText(Localization:GetString("302156"))
    self.left_abbr = self:AddComponent(BattleAbbr,left_abbr_path)
    self.right_abbr = self:AddComponent(BattleAbbr,right_abbr_path)
    self.model = {}
    
end

local function SetData(self, data)
    self.time_txt:SetText(UITimeManager:GetInstance():TimeStampToTimeForServerMinute(data.time*1000))
    self.pointId = data.pointId
    if #data.allianceAbbrList>0 then
        self.empty:SetActive(false)
        self.alliance_btn:SetActive(#data.allianceAbbrList>2)
        if #data.allianceAbbrList>0 then
            local A = data.allianceAbbrList[1]
            self.left_abbr:SetActive(true)
            self.left_abbr:SetText(A)
            if #data.allianceAbbrList>1 then
                local B = data.allianceAbbrList[2]
                self.right_abbr:SetActive(true)
                self.right_abbr:SetText(B)
            else
                self.right_abbr:SetActive(false)
            end
        else
            self.left_abbr:SetActive(false)
            self.right_abbr:SetActive(false)
        end
    else
        self.empty:SetActive(true)
    end
end

local function OnDetailClick(self)
    local x = self.alliance_btn.transform.position.x
    local y = self.alliance_btn.transform.position.y
    UIManager:GetInstance():OpenWindow(UIWindowNames.UIWorldNewsAbbrDetail,self.pointId,x,y)
end
BattleArea.OnCreate = OnCreate
BattleArea.SetData = SetData
BattleArea.OnDetailClick = OnDetailClick
return BattleArea