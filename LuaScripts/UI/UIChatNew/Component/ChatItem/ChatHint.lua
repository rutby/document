---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by mac.
--- DateTime: 6/28/21 4:05 PM
---
local IChatItem = require("UI.UIChatNew.Component.ChatItem.IChatItem")
local ChatHint = BaseClass("ChatHint", IChatItem)
local base = IChatItem
local Localization = CS.GameEntry.Localization

local _cp_text = "Image/Label";
local _cp_imgBg = "Image";

function ChatHint:ComponentDefine()
    self._text = self:AddComponent(UIText, _cp_text)
    self._imgBg = self:AddComponent(UIImage, _cp_imgBg)
end

function ChatHint:OnCreate()
    base.OnCreate(self)
    self:ComponentDefine()
end

function ChatHint:UpdateItem( _chatdata )
    if (_chatdata == nil) then
        return
    end

    local _message = _chatdata:getMessageWithExtra(false)
    self._text:SetText(_message)
    -- 设置背板高度,在语言部分高度+6
    local textHeight = self._text:GetHeight()
    -- emoji控件有点问题,暂时没有细查 preferredWidth 不会随着换行而减小
    local preferredWidth = self._text:GetWidth()
    local sizeDeltaX = self._text.rectTransform.sizeDelta.x
    local setX = preferredWidth  > sizeDeltaX and sizeDeltaX or preferredWidth
    local textWidth = setX+25
    self._imgBg.rectTransform:Set_sizeDelta(textWidth, textHeight)   
    local selfWidth = self.rectTransform.sizeDelta.x
    self.rectTransform:Set_sizeDelta(selfWidth, textHeight+5)
end

return ChatHint