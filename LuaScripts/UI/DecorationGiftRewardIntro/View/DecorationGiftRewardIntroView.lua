---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by 1.
--- DateTime: 2023/2/7 16:17
---

local DecorationGiftRewardIntroView = BaseClass("DecorationGiftRewardIntroView", UIBaseView)
local base = UIBaseView
local Localization = CS.GameEntry.Localization
local UIGray = CS.UIGray
local close_btn_path = "UICommonMiniPopUpTitle/Bg_mid/CloseBtn"
local panel_btn_path = "UICommonMiniPopUpTitle/panel"

local title_text_path = "UICommonMiniPopUpTitle/Bg_mid/titleText"
local DetectEventRewardCell = require "UI.UIRadarCenter.UIDetectEvent.Component.DetectEventRewardCell"
local reward_item_path = "DetectEventRewardCell"

local reward_text_path = "Reward_Text"

local reward_btn_path = "Get_Reward_Btn"
local reward_btn_text_path = "Get_Reward_Btn/Get_Reward_Btn_Text"

local function OnCreate(self)
    base.OnCreate(self)
    self:ComponentDefine()
    self:DataDefine()
    self:ReInit()
end

-- 销毁
local function OnDestroy(self)
    self:ComponentDestroy()
    self:DataDestroy()
    base.OnDestroy(self)
end

local function ComponentDefine(self)
    self.close_btn = self:AddComponent(UIButton, close_btn_path)
    self.panel_btn = self:AddComponent(UIButton, panel_btn_path)
    self.close_btn:SetOnClick(function()
        self.ctrl:CloseSelf()
    end)
    self.panel_btn:SetOnClick(function()
        self.ctrl:CloseSelf()
    end)

    self.title_text = self:AddComponent(UITextMeshProUGUIEx, title_text_path)
    self.title_text:SetLocalText(320752)
    self.reward_item = self:AddComponent(DetectEventRewardCell, reward_item_path)
    self.reward_btn = self:AddComponent(UIButton, reward_btn_path)
    self.reward_btn:SetOnClick(function()
        SoundUtil.PlayEffect(SoundAssets.Music_Effect_Button)
        self:OnRewardClick()
    end)
    self.reward_btn_text = self:AddComponent(UIText, reward_btn_text_path)
    self.reward_btn_text:SetLocalText(170004)
    self.reward_text = self:AddComponent(UIText, reward_text_path)
    self.reward_text:SetLocalText(320753)
end

local function ComponentDestroy(self)

end

local function DataDefine(self)
    
end

local function DataDestroy(self)

end

local function OnAddListener(self)
    base.OnAddListener(self)
end

local function OnRemoveListener(self)
    base.OnRemoveListener(self)
end

local function ReInit(self)
    local giftData = DataCenter.DecorationGiftPackageManager:GetData()
    if giftData and table.count(giftData.reward) > 0 then
        local rewardParam = giftData.reward[1]
        local param = DetectEventRewardCell.Param.New()
        param.rewardType = rewardParam.rewardType
        param.itemId = rewardParam.itemId
        param.count = rewardParam.count
        self.reward_item:ReInit(param)

        local canGet = giftData.rewardState == DecorationActivityRewardState.DecorationActivityRewardState_Can_Receive
        UIGray.SetGray(self.reward_btn.transform, not canGet, canGet)

    end
end

local function OnRewardClick(self)
    
end

DecorationGiftRewardIntroView.OnCreate = OnCreate
DecorationGiftRewardIntroView.OnDestroy = OnDestroy
DecorationGiftRewardIntroView.ComponentDefine = ComponentDefine
DecorationGiftRewardIntroView.ComponentDestroy = ComponentDestroy
DecorationGiftRewardIntroView.DataDefine = DataDefine
DecorationGiftRewardIntroView.DataDestroy = DataDestroy
DecorationGiftRewardIntroView.OnAddListener = OnAddListener
DecorationGiftRewardIntroView.OnRemoveListener = OnRemoveListener
DecorationGiftRewardIntroView.ReInit = ReInit
DecorationGiftRewardIntroView.OnRewardClick = OnRewardClick

return DecorationGiftRewardIntroView