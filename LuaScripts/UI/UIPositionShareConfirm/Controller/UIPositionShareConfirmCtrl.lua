---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Still4.
--- DateTime: 2021/7/8 11:11
---
local ShareDecode = require "Chat.Other.ShareDecode"
local UIPositionShareConfirmCtrl = BaseClass("UIPositionShareConfirmCtrl", UIBaseCtrl)
local function CloseSelf(self)
    UIManager:GetInstance():DestroyWindow(UIWindowNames.UIPositionShareConfirm)
end

local function Close(self)
    UIManager:GetInstance():DestroyWindowByLayer(UILayer.Normal)
end

local function getPreviewText(self, chat_data)
    return ShareDecode.Decode(chat_data, chat_data.param, true)
end

local function Confirm(self, chat_data)
    if chat_data.post == PostType.Text_Formation_Share then
        local serverTime = UITimeManager:GetInstance():GetServerSeconds()
        Setting:SetPrivateInt("FormationShareTime",serverTime)
    end
    --发到指定频道 
    if chat_data.post == PostType.Text_Formation_Fight_Share then
        if chat_data.param~=nil and chat_data.param.para ~= nil then
            local uid = chat_data.param.para.mailUid
            SFSNetwork.SendMessage(MsgDefines.UserShareMail, uid)
            EventManager:GetInstance():Broadcast(ChatEventEnum.CHAT_SHARE_COMMAND, chat_data)
        end
    else
        EventManager:GetInstance():Broadcast(ChatEventEnum.CHAT_SHARE_COMMAND, chat_data)
    end
    -- 关闭确认面板
    self:CloseSelf()
    -- 关闭选择面板
    UIManager:GetInstance():DestroyWindow(UIWindowNames.UIPositionShare)
end

UIPositionShareConfirmCtrl.CloseSelf = CloseSelf
UIPositionShareConfirmCtrl.Close = Close
UIPositionShareConfirmCtrl.getPreviewText = getPreviewText
UIPositionShareConfirmCtrl.Confirm = Confirm

return UIPositionShareConfirmCtrl