---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by 1.
--- DateTime: 2022/11/15 15:58
---

local UIHeroLackTipsCell = require "UI.UIHeroLackTips.Component.UIHeroLackTipsCell"
local UIHeroLackTipsView = BaseClass("UIHeroLackTipsView",UIBaseView)
local base = UIBaseView
local title_path = "ImgBg/UICommonMidPopUpTitle/bg_mid/titleText"
local return_btn_path = "panel"
local close_btn_path = "ImgBg/UICommonMidPopUpTitle/bg_mid/CloseBtn"
local scroll_path = "ImgBg/ScrollView"
--local item_slider_path = "ImgBg/SliderGo/Common_bg1/Slider"
--local item_icon_path = "ImgBg/SliderGo/Common_bg1/ItemIcon"
--local item_num_path = "ImgBg/SliderGo/Common_bg1/ItemNum"

--创建

local function OnCreate(self)
    base.OnCreate(self)
    self:ComponentDefine()
    self:DataDefine()
    self:ReInit()
end

-- 销毁
local function OnDestroy(self)
    self:ComponentDestroy()
    self:DataDestroy()
    base.OnDestroy(self)
end

local function ComponentDefine(self)
    self.title = self:AddComponent(UIText,title_path)
    self.title:SetLocalText(320551)
    self.return_btn = self:AddComponent(UIButton, return_btn_path)
    self.return_btn:SetOnClick(function()
        self.ctrl:CloseSelf()
    end)
    self.close_btn = self:AddComponent(UIButton, close_btn_path)
    self.close_btn:SetOnClick(function()
        self.ctrl:CloseSelf()
    end)
    self.ScrollView = self:AddComponent(UIScrollView, scroll_path)
    self.ScrollView:SetOnItemMoveIn(function(itemObj, index)
        self:OnItemMoveIn(itemObj, index)
    end)
    self.ScrollView:SetOnItemMoveOut(function(itemObj, index)
        self:OnItemMoveOut(itemObj, index)
    end)
    --self.item_slider = self:AddComponent(UISlider, item_slider_path)
    --self.item_icon = self:AddComponent(UIImage, item_icon_path)
    --self.item_num = self:AddComponent(UIText, item_num_path)

    self.showDatalist ={}
end

local function ComponentDestroy(self)
    self:ClearScroll()
end

local function OnAddListener(self)
    base.OnAddListener(self)
    --self:AddUIListener(EventId.RefreshItems, self.RefreshItem)
end

local function OnRemoveListener(self)
    base.OnRemoveListener(self)
    --self:RemoveUIListener(EventId.RefreshItems, self.RefreshItem)
end

local function DataDefine(self)

end

local function DataDestroy(self)

end

local function OnEnable(self)
    base.OnEnable(self)
end

local function OnDisable(self)
    base.OnDisable(self)
end

local function ReInit(self)
    self:RefreshList()
    --self:RefreshItem()
end

local function RefreshList(self)
    self:ClearScroll()
    self.data = self.ctrl:GetPanelData(self:GetUserData())
    self.showDatalist = self.data.configList
    --self.item_icon:LoadSprite(self.data.debrisIcon)
    self.ScrollView:SetTotalCount(#self.showDatalist)
    self.ScrollView:RefillCells()
end

local function ClearScroll(self)
    self.ScrollView:ClearCells()
    self.ScrollView:RemoveComponents(UIHeroLackTipsCell)
    self.showDatalist = {}
end

local function OnItemMoveIn(self,itemObj, index)
    itemObj.name = tostring(index)
    local cellItem = self.ScrollView:AddComponent(UIHeroLackTipsCell, itemObj)
    cellItem:ReInit(self.showDatalist[index])
end

local function OnItemMoveOut(self, itemObj, index)
    self.ScrollView:RemoveComponent(itemObj.name, UIHeroLackTipsCell)
end

--local function RefreshItem(self)
--    local itemNum = DataCenter.ItemData:GetItemCount(self.data.debrisId)
--    local need = self.data.needDebrisNum
--    local percent = itemNum / need
--    percent = Mathf.Clamp(percent, 0, 1)
--    self.item_slider:SetValue(percent)
--    self.item_num:SetLocalText(150033, itemNum, need)
--end

UIHeroLackTipsView.OnCreate= OnCreate
UIHeroLackTipsView.OnDestroy = OnDestroy
UIHeroLackTipsView.OnEnable = OnEnable
UIHeroLackTipsView.OnDisable = OnDisable
UIHeroLackTipsView.ComponentDefine = ComponentDefine
UIHeroLackTipsView.ComponentDestroy = ComponentDestroy
UIHeroLackTipsView.DataDefine = DataDefine
UIHeroLackTipsView.DataDestroy = DataDestroy
UIHeroLackTipsView.ReInit = ReInit
UIHeroLackTipsView.RefreshList = RefreshList
UIHeroLackTipsView.ClearScroll = ClearScroll
UIHeroLackTipsView.OnItemMoveOut = OnItemMoveOut
UIHeroLackTipsView.OnItemMoveIn = OnItemMoveIn
--UIHeroLackTipsView.RefreshItem = RefreshItem
UIHeroLackTipsView.OnAddListener = OnAddListener
UIHeroLackTipsView.OnRemoveListener = OnRemoveListener

return UIHeroLackTipsView