---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Beef.
--- DateTime: 2022/3/9 19:19
---

local UIArmyUnlockView = BaseClass("UIArmyUnlockView", UIBaseView)
local base = UIBaseView
local Localization = CS.GameEntry.Localization

local title_path = "Root/UICommonRewardPopUp/Panel/ImgTitleBg/TextTitle"
local next_path = "Root/UICommonRewardPopUp/Panel"

local army_img_path = "Root/GameObject/UITrainSoldierCell/Icon"
local army_lv_path = "Root/GameObject/UITrainSoldierCell/UISoldier_img_levelbg/LevelText"
local army_name_path = "Root/GameObject/ImgTitleBg/name_text"

local function OnCreate(self)
    base.OnCreate(self)
    self:DataDefine()
    self:ComponentDefine()
    self:ReInit()
end

local function OnDestroy(self)
    self:ComponentDestroy()
    self:DataDestroy()
    base.OnDestroy(self)
end

local function ComponentDefine(self)
    self.title_text = self:AddComponent(UITextMeshProUGUIEx, title_path)
    self.title_text:SetLocalText(130056)
    self.next_btn = self:AddComponent(UIButton, next_path)
    self.next_btn:SetOnClick(function()
        self.ctrl:CloseSelf()
    end)
    self.army_img = self:AddComponent(UIImage, army_img_path)
    self.army_lv = self:AddComponent(UITextMeshProUGUIEx, army_lv_path)
    self.army_name = self:AddComponent(UITextMeshProUGUIEx, army_name_path)
end

local function ComponentDestroy(self)
end

local function DataDefine(self)
    self.param = {}
end

local function DataDestroy(self)
    self.param = {}
end

local function OnEnable(self)
    base.OnEnable(self)
end

local function OnDisable(self)
    base.OnDisable(self)
end

local function ReInit(self)
    self.param = self:GetUserData()
    DataCenter.ArmyManager:SaveArmyUnlock(self.param.buildId, "")
    self:Show()
end

local function Show(self)
    local armyTemplate = DataCenter.ArmyTemplateManager:GetArmyTemplate(self.param.armyId)
    if armyTemplate ~= nil then
        self.army_img:LoadSprite(string.format(LoadPath.SoldierIcons, armyTemplate.icon))
        self.army_name:SetLocalText(armyTemplate.name)
        self.army_lv:SetText(RomeNum[armyTemplate.show_level])
    end
end

UIArmyUnlockView.OnCreate= OnCreate
UIArmyUnlockView.OnDestroy = OnDestroy
UIArmyUnlockView.ComponentDefine = ComponentDefine
UIArmyUnlockView.ComponentDestroy = ComponentDestroy
UIArmyUnlockView.DataDefine = DataDefine
UIArmyUnlockView.DataDestroy = DataDestroy
UIArmyUnlockView.OnEnable = OnEnable
UIArmyUnlockView.OnDisable = OnDisable
UIArmyUnlockView.ReInit = ReInit
UIArmyUnlockView.Show = Show

return UIArmyUnlockView