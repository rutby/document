---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by guqu.
--- DateTime: 2020/10/28 16:42
---
local RewardItem = BaseClass("RewardItem", UIBaseContainer)
local base = UIBaseContainer

local item_quality_path = "IconNode/UIGiftItem/clickBtn/ImgQuality"
local item_icon_path = "IconNode/UIGiftItem/clickBtn/ItemIcon"
local imgExtra_path = "IconNode/UIGiftItem/clickBtn/ImgExtra"
local txt_count_path = "IconNode/UIGiftItem/clickBtn/NumText"
local name_text_path = "TxtName"
local flag_text_path = "IconNode/UIGiftItem/clickBtn/FlagGo/FlagText"
local btn_path = "IconNode/UIGiftItem/clickBtn"
local num_txt_path = "TxtNum"
-- 创建
local function OnCreate(self)
    base.OnCreate(self)
    self.item_quality = self:AddComponent(UIImage, item_quality_path)
    self.item_icon = self:AddComponent(UIImage, item_icon_path)
    self.imgExtra = self:AddComponent(UIImage,imgExtra_path)
    self.name_text = self:AddComponent(UITextMeshProUGUIEx, name_text_path)
    self.flag_text = self:AddComponent(UITextMeshProUGUIEx, flag_text_path)
    self.num_txt = self:AddComponent(UITextMeshProUGUIEx,txt_count_path)
    self.num_txet = self:AddComponent(UITextMeshProUGUIEx,num_txt_path)
    self.btn = self:AddComponent(UIButton, btn_path)
    self.btn:SetOnClick(function()
        SoundUtil.PlayEffect(SoundAssets.Music_Effect_Button)
        self:OnBtnClick()
    end)
end

-- 销毁
local function OnDestroy(self)
    self.item_quality = nil
    self.item_icon = nil
    self.imgExtra = nil
    self.name_text = nil
    self.flag_text = nil
    self.param = nil
    base.OnDestroy(self)
end

-- 显示
local function OnEnable(self)
    base.OnEnable(self)
end

-- 隐藏
local function OnDisable(self)
    base.OnDisable(self)
end

-- 全部刷新
local function RefreshData(self,data)
    self.param = data
    self.name_text:SetText(self.param.name)
    self.item_quality:LoadSprite(self.param.itemColor)
    self.flag_text:SetText(self.param.itemFlag)
    local getNum = tonumber(self.param.count)
    --if self.view.activityType == EnumActivity.AllianceCompete.EventType then
    --    local effectNum = LuaEntry.Effect:GetGameEffect(EffectDefine.EFFECT_ONE_MORE_TIMES)
    --    if effectNum and effectNum > 0 then
    --        getNum = getNum * 2
    --    end
    --end
    self.num_txet:SetText(string.GetFormattedSeperatorNum(getNum))
    self.num_txt:SetText(string.GetFormattedSeperatorNum(getNum))
    self.item_icon:LoadSprite(self.param.iconName)
end

local function OnBtnClick(self)
    if self.param.itemId ~= nil then
        local param = {}
        param["itemId"] = self.param.itemId
        param["alignObject"] = self.item_icon
        UIManager:GetInstance():OpenWindow(UIWindowNames.UIItemTips,{anim = true}, param)
    elseif self.param.heroEventPoint then
        local param = {}
        param["itemName"] = 321081
        param["itemDesc"] = 321082
        param["alignObject"] = self.item_icon
        UIManager:GetInstance():OpenWindow(UIWindowNames.UIItemTips,{anim = true}, param)
    end
end

RewardItem.OnCreate = OnCreate
RewardItem.OnDestroy = OnDestroy
RewardItem.OnEnable = OnEnable
RewardItem.OnDisable = OnDisable
RewardItem.RefreshData = RefreshData
RewardItem.OnBtnClick = OnBtnClick

return RewardItem