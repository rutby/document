---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by 1.
--- DateTime: 2022/12/21 12:06
---ActivityRewardSciencePanel.lua

local ActivityRewardSciencePanel = BaseClass("ActivityRewardSciencePanel", UIBaseContainer)
local base = UIBaseContainer
local Localization = CS.GameEntry.Localization

local scienceBg_path = "ScienceBg/Item_Bg"
local scienceIcon_path = "ScienceBg/ScienceIcon"
local scienceDesc_path = "ScienceBg/ScienceName"
local jumpBtn_path = "ScienceBg/jumpBtn"
local jumpBtnTxt_path = "ScienceBg/jumpBtn/jumpBtnTxt"

-- 创建
local function OnCreate(self)
    base.OnCreate(self)
    self:ComponentDefine()
    self:DataDefine()
end

-- 销毁
local function OnDestroy(self)
    self:ComponentDestroy()
    self:DataDestroy()
    base.OnDestroy(self)
end

--控件的定义
local function ComponentDefine(self)
    self.scienceBgN = self:AddComponent(UIImage, scienceBg_path)
    self.scienceIconN = self:AddComponent(UIImage, scienceIcon_path)
    self.scienceDescN = self:AddComponent(UITextMeshProUGUIEx, scienceDesc_path)
    self.jumpBtnN = self:AddComponent(UIButton, jumpBtn_path)
    self.jumpBtnN:SetOnClick(function()
        self:OnClickJumpBtn()
    end)
    self.jumpBtnTxtN = self:AddComponent(UITextMeshProUGUI, jumpBtnTxt_path)
    self.jumpBtnTxtN:SetLocalText(110003)
end

--控件的销毁
local function ComponentDestroy(self)
    self.scienceBgN = nil
    self.scienceIconN = nil
    self.scienceDescN = nil
    self.jumpBtnN = nil
    self.jumpBtnTxtN = nil
end

--变量的定义
local function DataDefine(self)
    self.rewardScienceInfo = nil
end

--变量的销毁
local function DataDestroy(self)
    self.rewardScienceInfo = nil
end

local function OnAddListener(self)
    base.OnAddListener(self)
    --self:AddUIListener(EventId.OnOneActivityOverviewRedChange, self.RefreshAll)
end

local function OnRemoveListener(self)
    --self:RemoveUIListener(EventId.OnOneActivityOverviewRedChange, self.RefreshAll)
    base.OnRemoveListener(self)
end
--OnOneActivityOverviewRedChange

local function ShowPanel(self, rewardScience)
    self.rewardScienceInfo = rewardScience
    
    self:RefreshAll()
end


local function RefreshAll(self)
    local scienceId = self.rewardScienceInfo.scienceId
    local dialogId = self.rewardScienceInfo.dialogId
    
    local scienceTemplate = DataCenter.ScienceManager:GetScienceTemplate(scienceId)
    self.scienceIconN:LoadSprite(string.format(LoadPath.ScienceIcons,scienceTemplate.icon))
    
    self.scienceDescN:SetLocalText(dialogId)
end

local function OnClickJumpBtn(self)
    local scienceId = self.rewardScienceInfo.scienceId
    self.view.ctrl:CloseSelf()
    GoToUtil.GotoScience(scienceId ,nil, nil, true)
end


ActivityRewardSciencePanel.OnCreate = OnCreate
ActivityRewardSciencePanel.OnDestroy = OnDestroy
ActivityRewardSciencePanel.ComponentDefine = ComponentDefine
ActivityRewardSciencePanel.ComponentDestroy = ComponentDestroy
ActivityRewardSciencePanel.DataDefine = DataDefine
ActivityRewardSciencePanel.DataDestroy = DataDestroy
ActivityRewardSciencePanel.OnAddListener = OnAddListener
ActivityRewardSciencePanel.OnRemoveListener = OnRemoveListener

ActivityRewardSciencePanel.ShowPanel = ShowPanel
ActivityRewardSciencePanel.RefreshAll = RefreshAll
ActivityRewardSciencePanel.OnClickJumpBtn = OnClickJumpBtn

return ActivityRewardSciencePanel