---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Imaginaerum.
--- DateTime: 2023/1/13 17:39
---
local DesertForceItem = require "UI.UISeason.UIDesertForceList.Component.DesertForceItem"
local UIDesertForceListView = BaseClass("UIDesertForceListView",UIBaseView)
local base = UIBaseView
local Localization = CS.GameEntry.Localization
local txt_title_path ="UICommonMidPopUpTitle/bg_mid/titleText"
local close_btn_path = "UICommonMidPopUpTitle/bg_mid/CloseBtn"
local return_btn_path = "UICommonMidPopUpTitle/panel"
local scrollList_view_path = "ScrollViewList"
local des_txt_path = "des_txt"

--创建
function UIDesertForceListView:OnCreate()
    base.OnCreate(self)
    self:ComponentDefine()
    self:DataDefine()
    self:ReInit()
end

-- 销毁
function UIDesertForceListView:OnDestroy()
    self:SetAllCellsDestroy()
    self:ComponentDestroy()
    self:DataDestroy()
    base.OnDestroy(self)
end

function UIDesertForceListView:ComponentDefine()
    self.txt_title = self:AddComponent(UIText, txt_title_path)
    self.close_btn = self:AddComponent(UIButton, close_btn_path)
    self.return_btn = self:AddComponent(UIButton, return_btn_path)
    self.txt_1 = self:AddComponent(UIText, "Txt_1")
    self.txt_1:SetLocalText(129251)
    self.txt_2 = self:AddComponent(UIText, "Txt_2")
    self.txt_2:SetLocalText(110453)
    self.scrollList_view = self:AddComponent(UIScrollView, scrollList_view_path)
    self.scrollList_view:SetOnItemMoveIn(function(itemObj, index)
        self:OnCellMoveInList(itemObj, index)
    end)
    self.scrollList_view:SetOnItemMoveOut(function(itemObj, index)
        self:OnCellMoveOutList(itemObj, index)
    end)

    self.close_btn:SetOnClick(function()
        self.ctrl:CloseSelf()
    end)
    self.return_btn:SetOnClick(function()
        self.ctrl:CloseSelf()
    end)

    self.des_txt = self:AddComponent(UIText,des_txt_path)
end

function UIDesertForceListView:ComponentDestroy()
    self.txt_title = nil
    self.close_btn = nil
    self.return_btn = nil
end

function UIDesertForceListView:DataDefine()
end

function UIDesertForceListView:DataDestroy()
    self.list = nil
end

function UIDesertForceListView:OnEnable()
    base.OnEnable(self)
    self:ShowCells()
end

function UIDesertForceListView:OnDisable()
    base.OnDisable(self)
end

function UIDesertForceListView:ReInit()
    self.txt_title:SetLocalText(110475)
    self.des_txt:SetLocalText(110454)
end

-- 表现销毁
function UIDesertForceListView:SetAllCellsDestroy()
    self:ClearScroll()
end

function UIDesertForceListView:OnAddListener()
    base.OnAddListener(self)
    --self:AddUIListener(EventId.ServerListRefresh, self.ShowCells)
end

function UIDesertForceListView:OnRemoveListener()
    base.OnRemoveListener(self)
    --self:RemoveUIListener(EventId.ServerListRefresh, self.ShowCells)
end

function UIDesertForceListView:ShowCells()
    self:ClearScroll()
    self.list = self.ctrl:GetDesertForceList()
    if #self.list>0 then
        self.scrollList_view:SetTotalCount(#self.list)
        self.scrollList_view:RefillCells()
    end
end


--}}}
--{{{List
function UIDesertForceListView:OnCellMoveInList(itemObj, index)
    local tempType = self.list[index]
    itemObj.name = NameCount
    NameCount = NameCount + 1
    local cellItem = self.scrollList_view:AddComponent(DesertForceItem, itemObj)
    cellItem:ReInit(tempType)
    cellItem:SetActive(true)
end

function UIDesertForceListView:OnCellMoveOutList(itemObj, index)
    self.scrollList_view:RemoveComponent(itemObj.name, DesertForceItem)
end
--}}}
function UIDesertForceListView:ClearScroll()
    self.scrollList_view:ClearCells()
    self.scrollList_view:RemoveComponents(DesertForceItem)
    self.list = {}
end

return UIDesertForceListView