---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by 24224.
--- DateTime: 2022/11/29 21:49
---
local AlMemberSelectCell = BaseClass("AlMemberSelectCell",UIBaseContainer)
local base = UIBaseContainer
local Localization = CS.GameEntry.Localization

local name_path = "NameTxt"
local select_obj_path = "checkBox/Image"
local btn_path = "Button"
local icon_path ="UIPlayerHead/HeadIcon"
local headFg_path = "UIPlayerHead/Foreground"
local function OnCreate(self)
    base.OnCreate(self)
    self.name_txt = self:AddComponent(UIText,name_path)
    self.power_txt = self:AddComponent(UIText,"power")
    self.select_obj = self:AddComponent(UIBaseContainer,select_obj_path)
    self.btn = self:AddComponent(UIButton, btn_path)
    self.btn:SetOnClick(function()
        SoundUtil.PlayEffect(SoundAssets.Music_Effect_Button)
        self:OnClick()
    end)
    self.icon = self:AddComponent(UIPlayerHead, icon_path)
    self.headFg = self:AddComponent(UIImage, headFg_path)
    self.isLock = false
    self.isInSelect = false
end

-- 销毁
local function OnDestroy(self)
    self.name_txt = nil
    self.select_obj = nil
    self.btn = nil
    base.OnDestroy(self)
end

-- 显示
local function OnEnable(self)
    base.OnEnable(self)
end

-- 隐藏
local function OnDisable(self)
    base.OnDisable(self)
end


local function SetSelect(self,select)
    self.select_obj:SetActive(select)
end

local function SetItemShow(self,data)
    self.isLock = false
    self.isInSelect = false
    self.uid = data.uid
    self.name_txt:SetText(data.name)
    self.power_txt:SetText(string.GetFormattedSeperatorNum(data.power))
    self.isLock = self.view:GetIsInMenu(self.uid)
    self.isInSelect = self.view:IsInSelectList(self.uid)
    self:SetSelect(self.isLock ==true or self.isInSelect == true)
    local userId = data.uid
    local userPic = data.pic
    local userPicVer = data.picVer
    self.icon:SetData(userId, userPic, userPicVer,true)
    if data.headBg~=nil then
        self.headFg:SetActive(true)
        self.headFg:LoadSprite(data.headBg)
    else
        self.headFg:SetActive(false)
    end
end
local function OnClick(self)
    if self.isLock ==false then
        if self.isInSelect == false and self.view:IsEmpty() then
            return
        end
        local isSelect = (self.isInSelect == false)
        self.view:SetSelectState(self.uid,isSelect)
		self.isInSelect = isSelect
        self:SetSelect(self.isLock ==true or self.isInSelect == true)
    end
end

AlMemberSelectCell.OnCreate = OnCreate
AlMemberSelectCell.OnClick = OnClick
AlMemberSelectCell.OnDestroy = OnDestroy
AlMemberSelectCell.OnEnable = OnEnable
AlMemberSelectCell.OnDisable = OnDisable
AlMemberSelectCell.SetItemShow = SetItemShow
AlMemberSelectCell.SetSelect = SetSelect

return AlMemberSelectCell