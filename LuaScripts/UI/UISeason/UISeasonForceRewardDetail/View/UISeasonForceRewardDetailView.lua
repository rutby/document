---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Imaginaerum.
--- DateTime: 2023/1/16 10:57
---
local SeasonForceRewardItem = require "UI.UISeason.UISeasonForceRewardDetail.Component.SeasonForceRewardItem"
local UISeasonForceRewardDetailView = BaseClass("UISeasonForceRewardDetailView",UIBaseView)
local base = UIBaseView
local Localization = CS.GameEntry.Localization
local txt_title_path ="UICommonMidPopUpTitle/bg_mid/titleText"
local close_btn_path = "UICommonMidPopUpTitle/bg_mid/CloseBtn"
local return_btn_path = "UICommonMidPopUpTitle/panel"
local scrollList_view_path = "ScrollView"
local des_txt_path = "Image/des_txt"
local empty_txt_path ="emptyTxt"
--创建
function UISeasonForceRewardDetailView:OnCreate()
    base.OnCreate(self)
    self:ComponentDefine()
    self:DataDefine()
    self:ReInit()
end

-- 销毁
function UISeasonForceRewardDetailView:OnDestroy()
    self:SetAllCellsDestroy()
    self:ComponentDestroy()
    self:DataDestroy()
    base.OnDestroy(self)
end

function UISeasonForceRewardDetailView:ComponentDefine()
    self.txt_title = self:AddComponent(UIText, txt_title_path)
    self.empty_txt = self:AddComponent(UIText, empty_txt_path)
    self.close_btn = self:AddComponent(UIButton, close_btn_path)
    self.return_btn = self:AddComponent(UIButton, return_btn_path)
    self.scrollList_view = self:AddComponent(UIScrollView, scrollList_view_path)
    self.scrollList_view:SetOnItemMoveIn(function(itemObj, index)
        self:OnCellMoveInList(itemObj, index)
    end)
    self.scrollList_view:SetOnItemMoveOut(function(itemObj, index)
        self:OnCellMoveOutList(itemObj, index)
    end)

    self.close_btn:SetOnClick(function()
        self.ctrl:CloseSelf()
    end)
    self.return_btn:SetOnClick(function()
        self.ctrl:CloseSelf()
    end)

    self.des_txt = self:AddComponent(UIText,des_txt_path)
end

function UISeasonForceRewardDetailView:ComponentDestroy()
    self.txt_title = nil
    self.close_btn = nil
    self.return_btn = nil
end

function UISeasonForceRewardDetailView:DataDefine()
end

function UISeasonForceRewardDetailView:DataDestroy()
    self.list = nil
end

function UISeasonForceRewardDetailView:OnEnable()
    base.OnEnable(self)
    self:ShowCells()
end

function UISeasonForceRewardDetailView:OnDisable()
    base.OnDisable(self)
end

function UISeasonForceRewardDetailView:ReInit()
    self.txt_title:SetLocalText(110475)
    self.des_txt:SetLocalText(110459)
    self.empty_txt:SetLocalText(110478)
end

-- 表现销毁
function UISeasonForceRewardDetailView:SetAllCellsDestroy()
    self:ClearScroll()
end

function UISeasonForceRewardDetailView:OnAddListener()
    base.OnAddListener(self)
    --self:AddUIListener(EventId.ServerListRefresh, self.ShowCells)
end

function UISeasonForceRewardDetailView:OnRemoveListener()
    base.OnRemoveListener(self)
    --self:RemoveUIListener(EventId.ServerListRefresh, self.ShowCells)
end

function UISeasonForceRewardDetailView:ShowCells()
    self:ClearScroll()
    self.list = self.ctrl:GetDesertForceRewardList()
    if #self.list>0 then
        self.scrollList_view:SetTotalCount(#self.list)
        self.scrollList_view:RefillCells()
        self.empty_txt:SetActive(false)
    else
        self.empty_txt:SetActive(true)
    end
end


--}}}
--{{{List
function UISeasonForceRewardDetailView:OnCellMoveInList(itemObj, index)
    local tempType = self.list[index]
    itemObj.name = NameCount
    NameCount = NameCount + 1
    local cellItem = self.scrollList_view:AddComponent(SeasonForceRewardItem, itemObj)
    cellItem:ReInit(tempType)
    cellItem:SetActive(true)
end

function UISeasonForceRewardDetailView:OnCellMoveOutList(itemObj, index)
    self.scrollList_view:RemoveComponent(itemObj.name, SeasonForceRewardItem)
end
--}}}
function UISeasonForceRewardDetailView:ClearScroll()
    self.scrollList_view:ClearCells()
    self.scrollList_view:RemoveComponents(SeasonForceRewardItem)
    self.list = {}
end

return UISeasonForceRewardDetailView