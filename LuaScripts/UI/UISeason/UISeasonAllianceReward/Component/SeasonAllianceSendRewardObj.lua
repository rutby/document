---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by 24224.
--- DateTime: 2022/12/9 15:09
---
local SeasonAllianceRewardItem = require "UI.UISeason.UISeasonAllianceReward.Component.SeasonAllianceRewardItem"
local SeasonAllianceSendRewardObj = BaseClass("SeasonAllianceSendRewardObj", UIBaseContainer)
local base = UIBaseContainer
local Localization = CS.GameEntry.Localization

-- 创建
function SeasonAllianceSendRewardObj:OnCreate()
    base.OnCreate(self)
    self.Text_title = self:AddComponent(UIText,"Text_title")
    self.Text_title:SetText(Localization:GetString("110300"))
    self.itemCell = self:AddComponent(UIBaseContainer,"ScrollView/Viewport/Content")
    self.itemDataList = {}
    self.itemCellList = {}
end

-- 销毁
function SeasonAllianceSendRewardObj:OnDestroy()
    self:ClearItemCell()
    base.OnDestroy(self)
end

-- 显示
function SeasonAllianceSendRewardObj:OnEnable()
    base.OnEnable(self)
end

-- 隐藏
function SeasonAllianceSendRewardObj:OnDisable()
    base.OnDisable(self)
end

function SeasonAllianceSendRewardObj:RefreshList()
    self:ClearItemCell()
    local rewardList = self.view.ctrl:GetRewardList()
    if #rewardList >1 then
        for i = 1, #rewardList do
            self.itemTab[i] = self:GameObjectInstantiateAsync(UIAssets.SeasonAllianceRewardItem, function(request)
                if request.isError then
                    return
                end
                local go = request.gameObject;
                go.transform:SetParent(self.itemCell.transform)
                go.transform:Set_localScale(ResetScale.x, ResetScale.y, ResetScale.z)
                local nameStr = tostring(NameCount)
                go.name = nameStr
                NameCount = NameCount + 1
                go.gameObject:SetActive(true)
                local cell = self.itemCell:AddComponent(SeasonAllianceRewardItem,go.name)
                cell:InitData(rewardList[i],i)
                self.itemCellList[i] = cell
            end)
        end
    end
end
function SeasonAllianceSendRewardObj:ClearItemCell()
    self.itemCell:RemoveComponents(SeasonAllianceRewardItem)
    if self.itemTab and next(self.itemTab) then
        for k,v in pairs(self.itemTab) do
            if v ~= nil then
                self:GameObjectDestroy(v)
            end
        end
    end
    self.itemTab ={}
    self.itemCellList = {}
end

return SeasonAllianceSendRewardObj