---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by 24224.
--- DateTime: 2022/12/5 18:02
---
local SeasonGroundSelectItem = require "UI.UISeason.UISeasonGroundManage.Component.SeasonGroundSelectItem"
local SeasonGroundSelect = BaseClass("SeasonGroundSelect", UIBaseContainer)
local base = UIBaseContainer
local Localization = CS.GameEntry.Localization

-- 创建
function SeasonGroundSelect:OnCreate()
    base.OnCreate(self)
    self._close_btn = self:AddComponent(UIButton,"Bg")
    self._close_btn:SetOnClick(function()
        SoundUtil.PlayEffect(SoundAssets.Music_Effect_Button)
        self.view:SetSelectActive(false)
    end)
    self._all_btn = self:AddComponent(UIButton,"Image/allBtn")
    self._all_btn:SetOnClick(function()
        SoundUtil.PlayEffect(SoundAssets.Music_Effect_Button)
        self:OnAllClick()
    end)
    self._all_btn_txt = self:AddComponent(UIText,"Image/allBtn/allBtnTxt")
    self._all_btn_txt:SetText(Localization:GetString("110282"))
    self._revert_btn = self:AddComponent(UIButton,"Image/revertBtn")
    self._revert_btn:SetOnClick(function()
        SoundUtil.PlayEffect(SoundAssets.Music_Effect_Button)
        self:OnRevertClick()
    end)
    self._revert_btn_txt = self:AddComponent(UIText,"Image/revertBtn/revertBtnTxt")
    self._revert_btn_txt:SetText(Localization:GetString("110284"))
    self.ScrollView = self:AddComponent(UIScrollView,"Image/ScrollView")
    self.ScrollView:SetOnItemMoveIn(function(itemObj, index)
        self:OnItemMoveIn(itemObj, index)
    end)
    self.ScrollView:SetOnItemMoveOut(function(itemObj, index)
        self:OnItemMoveOut(itemObj, index)
    end)
    self.showDatalist ={}
    self.isCreateFinish = false
end

-- 销毁
function SeasonGroundSelect:OnDestroy()
    base.OnDestroy(self)
end

-- 显示
function SeasonGroundSelect:OnEnable()
    base.OnEnable(self)
end

-- 隐藏
function SeasonGroundSelect:OnDisable()
    base.OnDisable(self)
end


function SeasonGroundSelect:RefreshData()
    if self.isCreateFinish ==false then
        self:ClearScroll()
        self.showDatalist = self.view.ctrl:GetSortShowList()
        if self.showDatalist~=nil and  #self.showDatalist > 0 then
            self.isCreateFinish = true
            self.ScrollView:SetTotalCount(#self.showDatalist)
            self.ScrollView:RefillCells()
        end
    end
end
function SeasonGroundSelect:Reset()
    self.isCreateFinish = false
end
function SeasonGroundSelect:ClearScroll()
    self.ScrollView:ClearCells()
    self.ScrollView:RemoveComponents(SeasonGroundSelectItem)
    self.showDatalist = {}
    self.curList = {}
end

function SeasonGroundSelect:OnItemMoveIn(itemObj, index)
    itemObj.name = tostring(index)
    local cellItem = self.ScrollView:AddComponent(SeasonGroundSelectItem, itemObj)
    cellItem:SetItemShow(self.showDatalist[index])
    self.curList[index] = cellItem
end

function SeasonGroundSelect:OnItemMoveOut(itemObj, index)
    self.ScrollView:RemoveComponent(itemObj.name, SeasonGroundSelectItem)
    self.curList[index] = nil
end

function SeasonGroundSelect:RefreshCurList()
    for k,v in pairs(self.curList) do
        v:OnRefreshSelect()
    end
end

function SeasonGroundSelect:OnAllClick()
    self.view.ctrl:SelectAll()
    self:RefreshCurList()
    self.view:OnSelectRefresh()
end

function SeasonGroundSelect:OnRevertClick()
    self.view.ctrl:RevertAll()
    self:RefreshCurList()
    self.view:OnSelectRefresh()
end

return SeasonGroundSelect