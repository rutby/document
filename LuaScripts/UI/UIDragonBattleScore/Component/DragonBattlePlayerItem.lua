---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Imaginaerum.
--- DateTime: 2023/6/15 12:14
---
local DragonBattlePlayerItem = BaseClass("DragonBattlePlayerItem",UIBaseContainer)
local base = UIBaseContainer

local Localization = CS.GameEntry.Localization
local function OnCreate(self)
    base.OnCreate(self)
    self._name_txt = self:AddComponent(UIText,"firstNameTxt")
    self.num_txt = self:AddComponent(UIText,"numTxt")
    self.rank_img = self:AddComponent(UIImage, "img")
    self.player_img =self:AddComponent(UIPlayerHead,"playerFlag/UIPlayerHead/HeadIcon")
    self.playerHeadFg = self:AddComponent(UIImage, "playerFlag/UIPlayerHead/Foreground")

    self.score_txt = self:AddComponent(UIText,"score")

    self.btn = self:AddComponent(UIButton, "Button")
    self.btn:SetOnClick(function()
        SoundUtil.PlayEffect(SoundAssets.Music_Effect_Button)
        self:OnClick()
    end)
end

local function SetItemShow(self, data,index)
    self.data = data
    self.index= index
    if self.index == 1 then
        self.rank_img:LoadSprite("Assets/Main/Sprites/UI/UIAlliance/rank/UIalliance_rankingbg01.png")
    elseif self.index == 2 then
        self.rank_img:LoadSprite("Assets/Main/Sprites/UI/UIAlliance/rank/UIalliance_rankingbg02.png")
    elseif self.index == 3 then
        self.rank_img:LoadSprite("Assets/Main/Sprites/UI/UIAlliance/rank/UIalliance_rankingbg03.png")
    end
    if self.index>3 then
        self.num_txt:SetText(self.index)
        self.rank_img:SetActive(false)
    else
        self.num_txt:SetText("")
        self.rank_img:SetActive(true)
    end

    self._name_txt:SetText(self.data.name)

    self.player_img:SetData(self.data.uid, self.data.pic, self.data.picVer)

    if self.data.headBg then
        self.playerHeadFg:SetActive(true)
        self.playerHeadFg:LoadSprite(self.data.headBg)
    else
        self.playerHeadFg:SetActive(false)
    end

    self.score_txt:SetText(self.data.score)
    
end

local function OnClick(self)
    --if self.data.uid~= LuaEntry.Player.uid then
    --    UIManager:GetInstance():OpenWindow(UIWindowNames.UIOtherPlayerInfo,{ anim = true},self.data.uid)
    --else
    --    UIManager:GetInstance():OpenWindow(UIWindowNames.UIPlayerInfo,{ anim = true},LuaEntry.Player.uid)
    --end
end
local function OnDestroy(self)
    self._name_txt= nil
    self.second_txt = nil
    self.power_txt = nil
    self.num_txt = nil

    self.first_flag = nil
    self.second_flag = nil
    self.third_flag = nil

    self.player_flag = nil

    self.player_img =nil

    self.btn = nil
    base.OnDestroy(self)
end
DragonBattlePlayerItem.OnCreate = OnCreate
DragonBattlePlayerItem.SetItemShow = SetItemShow
DragonBattlePlayerItem.OnClick = OnClick
DragonBattlePlayerItem.OnDestroy =OnDestroy
return DragonBattlePlayerItem