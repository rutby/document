---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by 1.
--- DateTime: 2021/9/15 17:23
---MoveCityInvitePanel

local MoveCityInvitePanel = BaseClass("MoveCityInvitePanel", UIBaseContainer)
local base = UIBaseContainer
local Localization = CS.GameEntry.Localization
local AllianceFlagItem = require "UI.UIAlliance.UIAllianceFlag.Component.AllianceFlagItem"

local inviteDesc_path = "inviteDesc"
local inviteBtn_path = "inviteBtn"
local inviteBtnTxt_path = "inviteBtn/inviteBtnTxt"
local allianceFlag_path = "allianceFlag"

local function OnCreate(self)
    base.OnCreate(self)

    self.inviteDescN = self:AddComponent(UIText, inviteDesc_path)
    self.inviteBtnN = self:AddComponent(UIButton, inviteBtn_path)
    self.inviteBtnN:SetOnClick(function()
        self:OnClickConfirmBtn()
    end)
    self.inviteBtnTxtN = self:AddComponent(UIText, inviteBtnTxt_path)
    self.inviteBtnTxtN:SetLocalText(390198)
    self.allianceFlagN = self:AddComponent(AllianceFlagItem, allianceFlag_path)
end

local function OnDestroy(self)
    self.inviteDescN = nil
    self.inviteBtnN = nil
    self.inviteBtnTxtN = nil
    base.OnDestroy(self)
end

local function ShowPanel(self, isShow, param)
    if not isShow then
        self:SetActive(false)
        return
    end
    
    self:SetActive(true)
    
    local allianceBase = DataCenter.AllianceBaseDataManager:GetAllianceBaseData()
    if allianceBase and allianceBase.icon then
        self.allianceFlagN:SetData(allianceBase.icon)
    end

    local alPoints = DataCenter.AllianceBaseDataManager:GetAlMovePoints()
    if alPoints and alPoints.leaderPoint then
        local mainPos = SceneUtils.IndexToTilePos(LuaEntry.Player:GetMainWorldPos(), ForceChangeScene.World)
        self.inviteDescN:SetText(Localization:GetString("391078") .. " ( " .. mainPos.x .. "," .. mainPos.y .. " ) ")
    else
        self.inviteDescN:SetLocalText(391078)
    end
end

local function OnClickConfirmBtn(self)
    SFSNetwork.SendMessage(MsgDefines.InviteMoveCity)
    self.view.ctrl:CloseSelf()
end


MoveCityInvitePanel.OnCreate = OnCreate
MoveCityInvitePanel.OnDestroy = OnDestroy

MoveCityInvitePanel.ShowPanel = ShowPanel
MoveCityInvitePanel.OnClickConfirmBtn = OnClickConfirmBtn

return MoveCityInvitePanel