---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by 1.
--- DateTime: 2023/3/21 17:32
---


local UIPresidentAppointCell = BaseClass("UIPresidentAppointCell",UIBaseContainer)
local base = UIBaseContainer

local player_name_path = "NameLayoutGo/NameTxt"
local power_path = "power"
local player_icon_path="head/UIPlayerHead/HeadIcon"
local playerHeadFg_path = "head/UIPlayerHead/Foreground"

local check_box_path = "checkBox"
local check_box_select_path = "checkBox/select"

local function OnCreate(self)
    base.OnCreate(self)
    self.player_name = self:AddComponent(UIText,player_name_path)
    --self.abbr = self:AddComponent(UIText,abbr_path)
    self.power_txt = self:AddComponent(UIText, power_path)
    self.player_img =self:AddComponent(UIPlayerHead,player_icon_path)
    self.playerHeadFg = self:AddComponent(UIImage, playerHeadFg_path)

    self.check_box = self:AddComponent(UIButton, check_box_path)
    self.check_box:SetOnClick(function()
        SoundUtil.PlayEffect(SoundAssets.Music_Effect_Button)
        self:OnClick()
    end)

    self.check_box_select = self:AddComponent(UIBaseContainer, check_box_select_path)
end

local function SetData(self, data, curSelect)
    self.data = data
    self.curSelect = curSelect
    self.power_txt:SetText(string.GetFormattedSeperatorNum(math.floor(data.power)))

    self.player_name:SetText(data.name)
    self.player_img:SetData(data.uid, data.pic, data.picVer)
    local headBgImg = DataCenter.DecorationDataManager:GetHeadFrame(data.headSkinId, data.headSkinET)
    if headBgImg ~= nil  then
        self.playerHeadFg:SetActive(true)
        self.playerHeadFg:LoadSprite(headBgImg)
    else
        self.playerHeadFg:SetActive(false)
    end
    self:RefreshSelect()
end

local function OnClick(self)
    --self.view:SelectPlayer(self.data)
    if self.curSelect == self.data.uid then
        EventManager:GetInstance():Broadcast(EventId.SearchSelectUser, nil)
    else
        EventManager:GetInstance():Broadcast(EventId.SearchSelectUser, self.data.uid)
    end
end

local function OnAddListener(self)
    base.OnAddListener(self)
    self:AddUIListener(EventId.SearchSelectUser, self.OnSelect)
end

local function OnRemoveListener(self)
    self:RemoveUIListener(EventId.SearchSelectUser, self.OnSelect)
    base.OnRemoveListener(self)
end

local function OnSelect(self, para)
    self.curSelect = para
    self:RefreshSelect()
end

local function RefreshSelect(self)
    self.check_box_select:SetActive(self.data and self.data.uid == self.curSelect)
end

local function OnDestroy(self)
    base.OnDestroy(self)
end

UIPresidentAppointCell.OnCreate = OnCreate
UIPresidentAppointCell.SetData = SetData
UIPresidentAppointCell.OnClick = OnClick
UIPresidentAppointCell.OnDestroy = OnDestroy
UIPresidentAppointCell.OnAddListener = OnAddListener
UIPresidentAppointCell.OnRemoveListener = OnRemoveListener
UIPresidentAppointCell.OnSelect = OnSelect
UIPresidentAppointCell.RefreshSelect = RefreshSelect

return UIPresidentAppointCell