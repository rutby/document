---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by jinpeng.
--- DateTime: 2023/6/19 12:26
---
local DispatchAssistMessage = BaseClass("DispatchAssistMessage", SFSBaseMessage)
local base = SFSBaseMessage
local Localization = CS.GameEntry.Localization

function DispatchAssistMessage:OnCreate(uuid)
    base.OnCreate(self)
    self.sfsObj:PutLong("uuid", uuid)
end

function DispatchAssistMessage:HandleMessage(message)
    base.HandleMessage(self, message)
    local errCode =  message["errorCode"]
    if errCode ~= nil then
        UIUtil.ShowTipsId(errCode)
        if errCode == "E100174" then--E100174	目标今天接受的援助次数太多了，明天再来试试吧。
            DataCenter.ActDispatchTaskDataManager:GetAllAllianceTasksFromServer()
        end
    else
        if message["reward"] then
            DataCenter.RewardManager:ShowCommonReward(message)
            for k,v in pairs(message["reward"]) do
                DataCenter.RewardManager:AddOneReward(v)
            end
        end
        DataCenter.ActDispatchTaskDataManager:UpdateTodayNum(message)
        --援助者不显示假行军,不然名字等都是错误的
        --if message["endPointId"] then
        --    DataCenter.ActDispatchTaskFakeMarchManager:AddMarchIndex(message.endPointId, message.startPointId, true)
        --end
        -- 盟友的任务需要删除
        if message["uuid"] then
            DataCenter.ActDispatchTaskDataManager:DeleteAllianceTasks({message["uuid"]})
        end
    end
end

return DispatchAssistMessage