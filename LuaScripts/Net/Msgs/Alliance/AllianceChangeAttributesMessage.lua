---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by guqu.
--- DateTime: 2020/11/11 16:33
---
local AllianceChangeAttributesMessage = BaseClass("AllianceChangeAttributesMessage", SFSBaseMessage)
local base = SFSBaseMessage
local function OnCreate(self,name,abbr,recruitTotal,intro,language,castleRestrictionN,powerRestrictionN, announce, _, icon, country, recommend)
    base.OnCreate(self)
    if name~=nil and name~="" then
        self.sfsObj:PutUtfString("name",name)
    end
    if abbr~=nil and abbr~="" then
        self.sfsObj:PutUtfString("abbr",abbr)
    end
    if intro~=nil and intro~="" then
        self.sfsObj:PutUtfString("intro",intro)
    end
    if not string.IsNullOrEmpty(icon) then
        self.sfsObj:PutUtfString("icon",icon) 
    end
    if language~=nil and language~="" then
        self.sfsObj:PutUtfString("language",tostring(language))
    end
    if recruitTotal~=nil and recruitTotal~=-1 then
        self.sfsObj:PutInt("recruitTotal",recruitTotal)
    end
    if recommend then
        self.sfsObj:PutInt("recommendFunc", recommend)
    end
    if castleRestrictionN~=nil then
        self.sfsObj:PutUtfString("castleRestrictionN",castleRestrictionN)
    end
    if powerRestrictionN~=nil then
        self.sfsObj:PutUtfString("powerRestrictionN",powerRestrictionN)
    end
    if announce and announce ~= "" then
        self.sfsObj:PutUtfString("announce", announce)
    end
    if country and country ~= "" then
        self.sfsObj:PutUtfString("country", country)
    end
end

local function HandleMessage(self, t)
    base.HandleMessage(self, t)
    local errCode =  t["errorCode"]
    if errCode ~= nil then
        UIUtil.ShowTipsId(errCode) 
    else
        if t["gold"]~=nil then
            LuaEntry.Player.gold = t["gold"]
            EventManager:GetInstance():Broadcast(EventId.UpdateGold)
        end
        
        if t["clientReq"]~=nil then
            local message = t["clientReq"]
            DataCenter.AllianceBaseDataManager:UpdateAllianceSetting(message)
            if message["name"]~=nil then
                UIUtil.ShowTipsId(390117) 
                EventManager:GetInstance():Broadcast(EventId.AllianceNameChange,message["name"])
            elseif message["abbr"]~=nil then
                UIUtil.ShowTipsId(390103) 
                EventManager:GetInstance():Broadcast(EventId.AllianceAbbrChange,message["abbr"])
            elseif message["icon"] then
                EventManager:GetInstance():Broadcast(EventId.AllianceFlagChanged, message["icon"])
                UIUtil.ShowTipsId(280146)
            elseif message["country"] then
                EventManager:GetInstance():Broadcast(EventId.AllianceCountryChanged, message["country"])
            elseif message["recommendFunc"] then
                EventManager:GetInstance():Broadcast(EventId.OnAllianceRecommendChange, message["recommendFunc"])
            else
                UIUtil.ShowTipsId(280146) 
            end
        end
    end
end

AllianceChangeAttributesMessage.OnCreate = OnCreate
AllianceChangeAttributesMessage.HandleMessage = HandleMessage

return AllianceChangeAttributesMessage