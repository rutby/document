---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Imaginaerum.
--- DateTime: 2021/7/19 21:39
---
local PushAlJoinMessage = BaseClass("PushAlJoinMessage", SFSBaseMessage)
local base = SFSBaseMessage
local function OnCreate(self)
    base.OnCreate(self)
end

local function HandleMessage(self, t)
    base.HandleMessage(self, t)
    if t["alliance"]~=nil then		
        DataCenter.AllianceBaseDataManager:UpdateAllianceBaseData(t)
        DataCenter.AllianceMemberDataManager:TryInitMemberList(true)
		SFSNetwork.SendMessage(MsgDefines.GetAllianceRedPacket)
        EventManager:GetInstance():Broadcast(EventId.AllianceApplySuccess)
		-- 更新联盟信息之后再更新
		if t["lastUpdateTime"] then
			LuaEntry.Player:SetLastUpdateTime(t["lastUpdateTime"])
		end
    end
end

PushAlJoinMessage.OnCreate = OnCreate
PushAlJoinMessage.HandleMessage = HandleMessage

return PushAlJoinMessage