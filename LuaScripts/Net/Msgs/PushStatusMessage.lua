---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Imaginaerum.
--- DateTime: 2021/10/19 22:15
---
local PushStatusMessage = BaseClass("PushStatusMessage", SFSBaseMessage)
local base = SFSBaseMessage
local function OnCreate(self)
    base.OnCreate(self)
end

local function HandleMessage(self, t)
    base.HandleMessage(self, t)
    if t["oldStatus"]~=nil then
        local statusId = t["oldStatus"]
        LuaEntry.Effect:RemoveStatus(statusId)
    end
    if t["effectState"]~=nil then
        local stateDict = t["effectState"]
        table.walk(stateDict,function(k,v)
            if k~="startTime" then
                local key = tonumber(k)
                local value = tonumber(v)
                LuaEntry.Effect:AddStatus(key,value)
                DataCenter.MasteryManager:OnStatusUpdate(key, value)
            end
        end)
    end
    if t["status"]~=nil then
        LuaEntry.Effect:UpdateStatus(t)
    end
    EventManager:GetInstance():Broadcast(EventId.MSG_ITME_STATUS_TIME_CHANGE,100)
end

PushStatusMessage.OnCreate = OnCreate
PushStatusMessage.HandleMessage = HandleMessage

return PushStatusMessage