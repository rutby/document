---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by 1.
--- DateTime: 2023/4/25 15:46
---

local PrepareFillArmyMessage = BaseClass("PrepareFillArmyMessage", SFSBaseMessage)
local base = SFSBaseMessage

local function OnCreate(self, armyList)
    base.OnCreate(self)
    local arr = SFSArray.New()
    for k, v in pairs(armyList) do
        local obj = SFSObject.New()
        obj:PutUtfString("armyId", tostring(k))
        obj:PutLong("count", v)
        arr:AddSFSObject(obj)
    end
    self.sfsObj:PutSFSArray("soldiers", arr)
end

local function HandleMessage(self, t)
    base.HandleMessage(self, t)
    if t["errorCode"] ~= nil then
        if t["errorCode"] ~= SeverErrorCode then
            UIUtil.ShowTips(Localization:GetString(t["errorCode"]))
        end
        return
    end
    for _, v in pairs(t["soldiers"]) do
        DataCenter.ArmyManager:UpdateOneArmy(v)
    end
    EventManager:GetInstance():Broadcast(EventId.TrainArmyData)
end

PrepareFillArmyMessage.OnCreate = OnCreate
PrepareFillArmyMessage.HandleMessage = HandleMessage

return PrepareFillArmyMessage